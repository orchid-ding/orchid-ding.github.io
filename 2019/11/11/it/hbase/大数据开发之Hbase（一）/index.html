<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="天行健、君子以自强不息；地势坤，君子以厚德载物。">
    <meta name="keyword"  content="兰草">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        大数据开发之Hbase（一） - kfly的博客 | kfly&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1598291_q3el2wqimj.css" type="text/css">
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 君子谦谦，温和有礼，有才而不骄，得志而不傲，居于谷而不卑。 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>kfly</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont iconhome"></i>
                    <span>主页</span>
                </a>
            </li>
 	   <li >
                <a href="/spec/">
                    <i class="iconfont iconzhuanti"></i>
                    <span>专题</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>简历</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#大数据开发之HBase"><span class="toc-text">大数据开发之HBase</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-HBase是什么"><span class="toc-text">1. HBase是什么</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-HBase的概念"><span class="toc-text">1.1 HBase的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-HBase的特点"><span class="toc-text">1.2 HBase的特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-HBase集群安装部署"><span class="toc-text">2. HBase集群安装部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-HBase表的数据模型"><span class="toc-text">3. HBase表的数据模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-rowkey行键"><span class="toc-text">3.1 rowkey行键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Column-Family列族"><span class="toc-text">3.2 Column Family列族</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Column列"><span class="toc-text">3.3 Column列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-cell单元格"><span class="toc-text">3.4 cell单元格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-Timestamp时间戳"><span class="toc-text">3.5 Timestamp时间戳</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-HBase整体架构"><span class="toc-text">4. HBase整体架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-Client客户端"><span class="toc-text">4.1 Client客户端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-ZooKeeper集群"><span class="toc-text">4.2 ZooKeeper集群</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-HMaster"><span class="toc-text">4.3 HMaster</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-HRegionServer"><span class="toc-text">4.4 HRegionServer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-Region"><span class="toc-text">4.5 Region</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-HBase-shell-命令基本操作"><span class="toc-text">5. HBase shell 命令基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-进入HBase客户端命令操作界面"><span class="toc-text">5.1 进入HBase客户端命令操作界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-help-帮助命令"><span class="toc-text">5.2 help 帮助命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-list-查看有哪些表"><span class="toc-text">5.3 list 查看有哪些表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-create-创建表"><span class="toc-text">5.4 create 创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-put-插入数据操作"><span class="toc-text">5.5 put 插入数据操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-查询数据操作"><span class="toc-text">5.6 查询数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-1-通过rowkey进行查询"><span class="toc-text">5.6.1 通过rowkey进行查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-2-查看rowkey下某个列族的信息"><span class="toc-text">5.6.2 查看rowkey下某个列族的信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-3-查看rowkey指定列族指定字段的值"><span class="toc-text">5.6.3 查看rowkey指定列族指定字段的值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-4-查看rowkey指定多个列族的信息"><span class="toc-text">5.6.4 查看rowkey指定多个列族的信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-5-指定rowkey与列值过滤器查询"><span class="toc-text">5.6.5 指定rowkey与列值过滤器查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-6-指定rowkey与列值模糊查询"><span class="toc-text">5.6.6 指定rowkey与列值模糊查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#map端聚合"><span class="toc-text">map端聚合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-8-列族查询"><span class="toc-text">5.6.8 列族查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-9-多列族查询"><span class="toc-text">5.6.9 多列族查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-10-指定列族与某个列名查询"><span class="toc-text">5.6.10 指定列族与某个列名查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-11-指定多个列族与按照数据值模糊查询"><span class="toc-text">5.6.11 指定多个列族与按照数据值模糊查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-12-指定rowkey的范围查询"><span class="toc-text">5.6.12 指定rowkey的范围查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-13-指定rowkey模糊查询"><span class="toc-text">5.6.13 指定rowkey模糊查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-14-指定数据版本的范围查询"><span class="toc-text">5.6.14 指定数据版本的范围查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-更新数据操作"><span class="toc-text">5.7 更新数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7-1-更新数据值"><span class="toc-text">5.7.1 更新数据值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7-2-更新版本号"><span class="toc-text">5.7.2 更新版本号</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8-删除数据以及删除表操作"><span class="toc-text">5.8 删除数据以及删除表操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-1-指定rowkey以及列名进行删除"><span class="toc-text">5.8.1 指定rowkey以及列名进行删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-2-指定rowkey，列名以及版本号进行删除"><span class="toc-text">5.8.2 指定rowkey，列名以及版本号进行删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-3-删除一个列族"><span class="toc-text">5.8.3 删除一个列族</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-4-清空表数据"><span class="toc-text">5.8.4 清空表数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-5-删除表"><span class="toc-text">5.8.5 删除表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-9-统计一张表有多少行数据"><span class="toc-text">5.9 统计一张表有多少行数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-HBase的高级shell管理命令"><span class="toc-text">6. HBase的高级shell管理命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-status"><span class="toc-text">6.1 status</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-whoami"><span class="toc-text">6.2 whoami</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-list"><span class="toc-text">6.3 list</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-count"><span class="toc-text">6.4 count</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-describe"><span class="toc-text">6.5 describe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-exists"><span class="toc-text">6.6 exists</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-is-enabled、is-disabled"><span class="toc-text">6.7 is_enabled、is_disabled</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-alter"><span class="toc-text">6.8 alter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-9-disable-enable"><span class="toc-text">6.9 disable/enable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-10-drop"><span class="toc-text">6.10 drop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-11-truncate"><span class="toc-text">6.11 truncate</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-HBase的JavaAPI操作（重点）"><span class="toc-text">7. HBase的JavaAPI操作（重点）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-创建maven工程"><span class="toc-text">7.1 创建maven工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-创建myuser表"><span class="toc-text">7.2 创建myuser表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-向表中添加数据"><span class="toc-text">7.3 向表中添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-查询数据"><span class="toc-text">7.4 查询数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-1-Get查询"><span class="toc-text">7.4.1 Get查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-2-Scan查询"><span class="toc-text">7.4.2 Scan查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-HBase过滤器查询"><span class="toc-text">7.5 HBase过滤器查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-5-1-过滤器"><span class="toc-text">7.5.1 过滤器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-5-2-比较过滤器使用"><span class="toc-text">7.5.2 比较过滤器使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1、rowKey过滤器RowFilter"><span class="toc-text">1、rowKey过滤器RowFilter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2、列族过滤器FamilyFilter"><span class="toc-text">2、列族过滤器FamilyFilter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3、列过滤器QualifierFilter"><span class="toc-text">3、列过滤器QualifierFilter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4、列值过滤器ValueFilter"><span class="toc-text">4、列值过滤器ValueFilter</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-5-3-专用过滤器使用"><span class="toc-text">7.5.3 专用过滤器使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1、单列值过滤器-SingleColumnValueFilter"><span class="toc-text">1、单列值过滤器 SingleColumnValueFilter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2、列值排除过滤器SingleColumnValueExcludeFilter"><span class="toc-text">2、列值排除过滤器SingleColumnValueExcludeFilter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3、rowkey前缀过滤器PrefixFilter"><span class="toc-text">3、rowkey前缀过滤器PrefixFilter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4、分页过滤器PageFilter（15分钟）"><span class="toc-text">4、分页过滤器PageFilter（15分钟）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、多过滤器综合查询FilterList"><span class="toc-text">3、多过滤器综合查询FilterList</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-HBase的删除操作"><span class="toc-text">7.6 HBase的删除操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、根据rowkey删除数据"><span class="toc-text">1、根据rowkey删除数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、删除表操作"><span class="toc-text">2、删除表操作</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五、拓展点、未来计划、行业趋势"><span class="toc-text">五、拓展点、未来计划、行业趋势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Hbase在实际场景中的应用"><span class="toc-text">8. Hbase在实际场景中的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#8-1-交通方面"><span class="toc-text">8.1 交通方面</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-2-金融方面"><span class="toc-text">8.2 金融方面</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-3-电商方面"><span class="toc-text">8.3 电商方面</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-4-电信方面"><span class="toc-text">8.4 电信方面</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 君子谦谦，温和有礼，有才而不骄，得志而不傲，居于谷而不卑。 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        大数据开发之Hbase（一）
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-11-11 16:36:53</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#hbase" title="hbase">hbase</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#hadoop" title="hadoop">hadoop</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="大数据开发之HBase"><a href="#大数据开发之HBase" class="headerlink" title="大数据开发之HBase"></a>大数据开发之HBase</h1><h2 id="1-HBase是什么"><a href="#1-HBase是什么" class="headerlink" title="1. HBase是什么"></a>1. HBase是什么</h2><ul>
<li><a href="http://developer.51cto.com/art/201904/595698.htm" target="_blank" rel="noopener">漫画学习HBase—-最易懂的Hbase架构原理解析</a></li>
</ul>
<h3 id="1-1-HBase的概念"><a href="#1-1-HBase的概念" class="headerlink" title="1.1 HBase的概念"></a>1.1 HBase的概念</h3><ul>
<li>HBase基于Google的BigTable论文，是建立的==HDFS==之上，提供<strong>高可靠性</strong>、<strong>高性能</strong>、<strong>列存储</strong>、<strong>可伸缩</strong>、<strong>实时读写</strong>的分布式数据库系统。</li>
<li>在需要==实时读写随机访问==超大规模数据集时，可以使用HBase。</li>
</ul>
<h3 id="1-2-HBase的特点"><a href="#1-2-HBase的特点" class="headerlink" title="1.2 HBase的特点"></a>1.2 HBase的特点</h3><p>···</p>
<h2 id="2-HBase集群安装部署"><a href="#2-HBase集群安装部署" class="headerlink" title="2. HBase集群安装部署"></a>2. HBase集群安装部署</h2><p>​    <a href="https://kfly.top/2019/11/26/hadoop/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">点击跳转</a></p>
<h2 id="3-HBase表的数据模型"><a href="#3-HBase表的数据模型" class="headerlink" title="3. HBase表的数据模型"></a>3. HBase表的数据模型</h2><p><img src="assets/HBase-data-model.png.png" alt=""></p>
<h3 id="3-1-rowkey行键"><a href="#3-1-rowkey行键" class="headerlink" title="3.1 rowkey行键"></a>3.1 rowkey行键</h3><ul>
<li>table的主键，table中的记录按照rowkey 的字典序进行排序</li>
<li>Row key行键可以是任意字符串(最大长度是 64KB，实际应用中长度一般为 10-100bytes)</li>
</ul>
<h3 id="3-2-Column-Family列族"><a href="#3-2-Column-Family列族" class="headerlink" title="3.2 Column Family列族"></a>3.2 Column Family列族</h3><ul>
<li>列族或列簇</li>
<li>HBase表中的每个列，都归属与某个列族</li>
<li>列族是表的schema的一部分(而列不是)，即建表时至少指定一个列族</li>
<li>比如创建一张表，名为<code>user</code>，有两个列族，分别是<code>info</code>和<code>data</code>，建表语句<code>create &#39;user&#39;, &#39;info&#39;, &#39;data&#39;</code></li>
</ul>
<h3 id="3-3-Column列"><a href="#3-3-Column列" class="headerlink" title="3.3 Column列"></a>3.3 Column列</h3><ul>
<li>列肯定是表的某一列族下的一个列，用<code>列族名:列名</code>表示，如<code>info</code>列族下的<code>name</code>列，表示为<code>info:name</code></li>
<li>属于某一个ColumnFamily,类似于我们mysql当中创建的具体的列</li>
</ul>
<h3 id="3-4-cell单元格"><a href="#3-4-cell单元格" class="headerlink" title="3.4 cell单元格"></a>3.4 cell单元格</h3><ul>
<li><p>指定row key行键、列族、列，可以确定的一个cell单元格</p>
</li>
<li><p>cell中的数据是没有类型的，全部是以字节数组进行存储</p>
</li>
</ul>
<p><img src="assets/Image201911072218.png" alt=""></p>
<h3 id="3-5-Timestamp时间戳"><a href="#3-5-Timestamp时间戳" class="headerlink" title="3.5 Timestamp时间戳"></a>3.5 Timestamp时间戳</h3><ul>
<li>可以对表中的Cell多次赋值，每次赋值操作时的时间戳timestamp，可看成Cell值的版本号version number</li>
<li>即一个Cell可以有多个版本的值</li>
</ul>
<h2 id="4-HBase整体架构"><a href="#4-HBase整体架构" class="headerlink" title="4. HBase整体架构"></a>4. HBase整体架构</h2><p><img src="assets/HBase-Hmaster-Hregionserver.png" alt=""></p>
<h3 id="4-1-Client客户端"><a href="#4-1-Client客户端" class="headerlink" title="4.1 Client客户端"></a>4.1 Client客户端</h3><ul>
<li>Client是操作HBase集群的入口<ul>
<li>对于管理类的操作，如表的增、删、改操纵，Client通过RPC与HMaster通信完成</li>
<li>对于表数据的读写操作，Client通过RPC与RegionServer交互，读写数据</li>
</ul>
</li>
<li>Client类型：<ul>
<li>HBase shell</li>
<li>Java编程接口</li>
<li>Thrift、Avro、Rest等等</li>
</ul>
</li>
</ul>
<h3 id="4-2-ZooKeeper集群"><a href="#4-2-ZooKeeper集群" class="headerlink" title="4.2 ZooKeeper集群"></a>4.2 ZooKeeper集群</h3><ul>
<li><p>作用</p>
<ul>
<li><p>实现了HMaster的高可用，多HMaster间进行主备选举</p>
</li>
<li><p>保存了HBase的元数据信息meta表，提供了HBase表中region的寻址入口的线索数据</p>
</li>
<li><p>对HMaster和HRegionServer实现了监控</p>
</li>
</ul>
</li>
</ul>
<h3 id="4-3-HMaster"><a href="#4-3-HMaster" class="headerlink" title="4.3 HMaster"></a>4.3 HMaster</h3><ul>
<li>HBase集群也是主从架构，HMaster是主的角色，是老大</li>
<li>主要负责Table表和Region的相关管理工作：</li>
<li>关于Table<ul>
<li>管理Client对Table的增删改的操作</li>
<li>关于Region<ul>
<li>在Region分裂后，负责新Region分配到指定的HRegionServer上</li>
<li>管理HRegionServer间的负载均衡，迁移region分布</li>
<li>当HRegionServer宕机后，负责其上的region的迁移</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="4-4-HRegionServer"><a href="#4-4-HRegionServer" class="headerlink" title="4.4 HRegionServer"></a>4.4 HRegionServer</h3><ul>
<li>HBase集群中从的角色，是小弟</li>
<li>作用</li>
</ul>
<ul>
<li>响应客户端的读写数据请求<ul>
<li>负责管理一系列的Region</li>
<li>切分在运行过程中变大的region</li>
</ul>
</li>
</ul>
<h3 id="4-5-Region"><a href="#4-5-Region" class="headerlink" title="4.5 Region"></a>4.5 Region</h3><ul>
<li>HBase集群中分布式存储的最小单元</li>
<li>一个Region对应一个Table表的部分数据</li>
</ul>
<blockquote>
<p>HBase使用，主要有两种形式：①命令；②Java编程</p>
</blockquote>
<h2 id="5-HBase-shell-命令基本操作"><a href="#5-HBase-shell-命令基本操作" class="headerlink" title="5. HBase shell 命令基本操作"></a>5. HBase shell 命令基本操作</h2><h3 id="5-1-进入HBase客户端命令操作界面"><a href="#5-1-进入HBase客户端命令操作界面" class="headerlink" title="5.1 进入HBase客户端命令操作界面"></a>5.1 进入HBase客户端命令操作界面</h3><ul>
<li>node01执行以下命令，进入HBase的shell客户端</li>
</ul>
<pre><code class="shell">cd /kfly/install/hbase-1.2.0-cdh5.14.2/
bin/HBase shell

</code></pre>
<h3 id="5-2-help-帮助命令"><a href="#5-2-help-帮助命令" class="headerlink" title="5.2 help 帮助命令"></a>5.2 help 帮助命令</h3><pre><code class="shell">HBase(main):001:0&gt; help

</code></pre>
<h3 id="5-3-list-查看有哪些表"><a href="#5-3-list-查看有哪些表" class="headerlink" title="5.3 list 查看有哪些表"></a>5.3 list 查看有哪些表</h3><ul>
<li>查看当前数据库中有哪些表</li>
</ul>
<pre><code class="shell">HBase(main):002:0&gt; list

</code></pre>
<h3 id="5-4-create-创建表"><a href="#5-4-create-创建表" class="headerlink" title="5.4 create 创建表"></a>5.4 create 创建表</h3><ul>
<li>创建user表，包含info、data两个列族</li>
<li>使用create命令</li>
</ul>
<pre><code>HBase(main):010:0&gt; create &#39;user&#39;, &#39;info&#39;, &#39;data&#39;

或者

HBase(main):010:0&gt; create &#39;user&#39;, {NAME =&gt; &#39;info&#39;, VERSIONS =&gt; &#39;3&#39;}，{NAME =&gt; &#39;data&#39;}

</code></pre><h3 id="5-5-put-插入数据操作"><a href="#5-5-put-插入数据操作" class="headerlink" title="5.5 put 插入数据操作"></a>5.5 put 插入数据操作</h3><ul>
<li>向表中插入数据</li>
<li>使用put命令</li>
</ul>
<pre><code>向user表中插入信息，row key为rk0001，列族info中添加名为name的列，值为zhangsan
HBase(main):011:0&gt; put &#39;user&#39;, &#39;rk0001&#39;, &#39;info:name&#39;, &#39;zhangsan&#39;

向user表中插入信息，row key为rk0001，列族info中添加名为gender的列，值为female
HBase(main):012:0&gt; put &#39;user&#39;, &#39;rk0001&#39;, &#39;info:gender&#39;, &#39;female&#39;

向user表中插入信息，row key为rk0001，列族info中添加名为age的列，值为20
HBase(main):013:0&gt; put &#39;user&#39;, &#39;rk0001&#39;, &#39;info:age&#39;, 20

向user表中插入信息，row key为rk0001，列族data中添加名为pic的列，值为picture
HBase(main):014:0&gt; put &#39;user&#39;, &#39;rk0001&#39;, &#39;data:pic&#39;, &#39;picture&#39;

</code></pre><h3 id="5-6-查询数据操作"><a href="#5-6-查询数据操作" class="headerlink" title="5.6 查询数据操作"></a>5.6 查询数据操作</h3><h4 id="5-6-1-通过rowkey进行查询"><a href="#5-6-1-通过rowkey进行查询" class="headerlink" title="5.6.1 通过rowkey进行查询"></a>5.6.1 通过rowkey进行查询</h4><ul>
<li>获取user表中row key为rk0001的所有信息（即所有cell的数据）</li>
<li>使用get命令</li>
</ul>
<pre><code>HBase(main):015:0&gt; get &#39;user&#39;, &#39;rk0001&#39;

</code></pre><h4 id="5-6-2-查看rowkey下某个列族的信息"><a href="#5-6-2-查看rowkey下某个列族的信息" class="headerlink" title="5.6.2 查看rowkey下某个列族的信息"></a>5.6.2 查看rowkey下某个列族的信息</h4><ul>
<li>获取user表中row key为rk0001，info列族的所有信息</li>
</ul>
<pre><code>HBase(main):016:0&gt; get &#39;user&#39;, &#39;rk0001&#39;, &#39;info&#39;

</code></pre><h4 id="5-6-3-查看rowkey指定列族指定字段的值"><a href="#5-6-3-查看rowkey指定列族指定字段的值" class="headerlink" title="5.6.3 查看rowkey指定列族指定字段的值"></a>5.6.3 查看rowkey指定列族指定字段的值</h4><ul>
<li>获取user表中row key为rk0001，info列族的name、age列的信息</li>
</ul>
<pre><code class="shell">HBase(main):017:0&gt; get &#39;user&#39;, &#39;rk0001&#39;, &#39;info:name&#39;, &#39;info:age&#39;

</code></pre>
<p><img src="assets/Image201911080715.png" alt=""></p>
<h4 id="5-6-4-查看rowkey指定多个列族的信息"><a href="#5-6-4-查看rowkey指定多个列族的信息" class="headerlink" title="5.6.4 查看rowkey指定多个列族的信息"></a>5.6.4 查看rowkey指定多个列族的信息</h4><ul>
<li>获取user表中row key为rk0001，info、data列族的信息</li>
</ul>
<pre><code class="shell">HBase(main):018:0&gt; get &#39;user&#39;, &#39;rk0001&#39;, &#39;info&#39;, &#39;data&#39;

或者你也可以这样写
HBase(main):019:0&gt; get &#39;user&#39;, &#39;rk0001&#39;, {COLUMN =&gt; [&#39;info&#39;, &#39;data&#39;]}

或者你也可以这样写，也行
HBase(main):020:0&gt; get &#39;user&#39;, &#39;rk0001&#39;, {COLUMN =&gt; [&#39;info:name&#39;, &#39;data:pic&#39;]}

</code></pre>
<h4 id="5-6-5-指定rowkey与列值过滤器查询"><a href="#5-6-5-指定rowkey与列值过滤器查询" class="headerlink" title="5.6.5 指定rowkey与列值过滤器查询"></a>5.6.5 指定rowkey与列值过滤器查询</h4><ul>
<li>获取user表中row key为rk0001，cell的值为zhangsan的信息</li>
</ul>
<pre><code class="shell">HBase(main):030:0&gt; get &#39;user&#39;, &#39;rk0001&#39;, {FILTER =&gt; &quot;ValueFilter(=, &#39;binary:zhangsan&#39;)&quot;}

</code></pre>
<h4 id="5-6-6-指定rowkey与列值模糊查询"><a href="#5-6-6-指定rowkey与列值模糊查询" class="headerlink" title="5.6.6 指定rowkey与列值模糊查询"></a>5.6.6 指定rowkey与列值模糊查询</h4><ul>
<li>获取user表中row key为rk0001，列标示符中含有a的信息</li>
</ul>
<pre><code class="shell">HBase(main):031:0&gt; get &#39;user&#39;, &#39;rk0001&#39;, {FILTER =&gt; &quot;(QualifierFilter(=,&#39;substring:a&#39;))&quot;}

继续插入一批数据

HBase(main):032:0&gt; put &#39;user&#39;, &#39;rk0002&#39;, &#39;info:name&#39;, &#39;fanbingbing&#39;
HBase(main):033:0&gt; put &#39;user&#39;, &#39;rk0002&#39;, &#39;info:gender&#39;, &#39;female&#39;
HBase(main):034:0&gt; put &#39;user&#39;, &#39;rk0002&#39;, &#39;info:nationality&#39;, &#39;中国&#39;
HBase(main):035:0&gt; get &#39;user&#39;, &#39;rk0002&#39;, {FILTER =&gt; &quot;ValueFilter(=, &#39;binary:中国&#39;)&quot;}

</code></pre>
<h4 id="map端聚合"><a href="#map端聚合" class="headerlink" title="map端聚合"></a>map端聚合</h4><ul>
<li>查询user表中的所有信息</li>
<li>使用scan命令</li>
</ul>
<pre><code>HBase(main):032:0&gt;  scan &#39;user&#39;

</code></pre><h4 id="5-6-8-列族查询"><a href="#5-6-8-列族查询" class="headerlink" title="5.6.8 列族查询"></a>5.6.8 列族查询</h4><ul>
<li>查询user表中列族为info的信息</li>
</ul>
<pre><code>scan &#39;user&#39;, {COLUMNS =&gt; &#39;info&#39;}

scan &#39;user&#39;, {COLUMNS =&gt; &#39;info&#39;, RAW =&gt; true, VERSIONS =&gt; 5}

scan &#39;user&#39;, {COLUMNS =&gt; &#39;info&#39;, RAW =&gt; true, VERSIONS =&gt; 3}

</code></pre><h4 id="5-6-9-多列族查询"><a href="#5-6-9-多列族查询" class="headerlink" title="5.6.9 多列族查询"></a>5.6.9 多列族查询</h4><ul>
<li>查询user表中列族为info和data的信息</li>
</ul>
<pre><code>scan &#39;user&#39;, {COLUMNS =&gt; [&#39;info&#39;, &#39;data&#39;]}

</code></pre><h4 id="5-6-10-指定列族与某个列名查询"><a href="#5-6-10-指定列族与某个列名查询" class="headerlink" title="5.6.10 指定列族与某个列名查询"></a>5.6.10 指定列族与某个列名查询</h4><ul>
<li>查询user表中列族为info、列标示符为name的信息</li>
</ul>
<pre><code>scan &#39;user&#39;, {COLUMNS =&gt; &#39;info:name&#39;}

</code></pre><ul>
<li>查询info:name列、data:pic列的数据</li>
</ul>
<pre><code>scan &#39;user&#39;, {COLUMNS =&gt; [&#39;info:name&#39;, &#39;data:pic&#39;]}

</code></pre><ul>
<li>查询user表中列族为info、列标示符为name的信息,并且版本最新的5个</li>
</ul>
<pre><code>scan &#39;user&#39;, {COLUMNS =&gt; &#39;info:name&#39;, VERSIONS =&gt; 5}

</code></pre><h4 id="5-6-11-指定多个列族与按照数据值模糊查询"><a href="#5-6-11-指定多个列族与按照数据值模糊查询" class="headerlink" title="5.6.11 指定多个列族与按照数据值模糊查询"></a>5.6.11 指定多个列族与按照数据值模糊查询</h4><ul>
<li>查询user表中列族为info和data且列标示符中含有a字符的信息</li>
</ul>
<pre><code>scan &#39;user&#39;, {COLUMNS =&gt; [&#39;info&#39;, &#39;data&#39;], FILTER =&gt; &quot;(QualifierFilter(=,&#39;substring:a&#39;))&quot;}

</code></pre><h4 id="5-6-12-指定rowkey的范围查询"><a href="#5-6-12-指定rowkey的范围查询" class="headerlink" title="5.6.12 指定rowkey的范围查询"></a>5.6.12 指定rowkey的范围查询</h4><ul>
<li>查询user表中列族为info，rk范围是[rk0001, rk0003)的数据</li>
</ul>
<pre><code>scan &#39;user&#39;, {COLUMNS =&gt; &#39;info&#39;, STARTROW =&gt; &#39;rk0001&#39;, ENDROW =&gt; &#39;rk0003&#39;}

</code></pre><h4 id="5-6-13-指定rowkey模糊查询"><a href="#5-6-13-指定rowkey模糊查询" class="headerlink" title="5.6.13 指定rowkey模糊查询"></a>5.6.13 指定rowkey模糊查询</h4><ul>
<li>查询user表中row key以rk字符开头的数据</li>
</ul>
<pre><code>scan &#39;user&#39;,{FILTER=&gt;&quot;PrefixFilter(&#39;rk&#39;)&quot;}

</code></pre><h4 id="5-6-14-指定数据版本的范围查询"><a href="#5-6-14-指定数据版本的范围查询" class="headerlink" title="5.6.14 指定数据版本的范围查询"></a>5.6.14 指定数据版本的范围查询</h4><ul>
<li>查询user表中指定范围的数据（前闭后开）</li>
</ul>
<pre><code>scan &#39;user&#39;, {TIMERANGE =&gt; [1392368783980, 1392380169184]}

</code></pre><h3 id="5-7-更新数据操作"><a href="#5-7-更新数据操作" class="headerlink" title="5.7 更新数据操作"></a>5.7 更新数据操作</h3><h4 id="5-7-1-更新数据值"><a href="#5-7-1-更新数据值" class="headerlink" title="5.7.1 更新数据值"></a>5.7.1 更新数据值</h4><ul>
<li>更新操作同插入操作一模一样，只不过有数据就更新，没数据就添加</li>
<li>使用put命令</li>
</ul>
<h4 id="5-7-2-更新版本号"><a href="#5-7-2-更新版本号" class="headerlink" title="5.7.2 更新版本号"></a>5.7.2 更新版本号</h4><ul>
<li>将user表的f1列族版本数改为5</li>
</ul>
<pre><code>HBase(main):050:0&gt; alter &#39;user&#39;, NAME =&gt; &#39;info&#39;, VERSIONS =&gt; 5

</code></pre><h3 id="5-8-删除数据以及删除表操作"><a href="#5-8-删除数据以及删除表操作" class="headerlink" title="5.8 删除数据以及删除表操作"></a>5.8 删除数据以及删除表操作</h3><h4 id="5-8-1-指定rowkey以及列名进行删除"><a href="#5-8-1-指定rowkey以及列名进行删除" class="headerlink" title="5.8.1 指定rowkey以及列名进行删除"></a>5.8.1 指定rowkey以及列名进行删除</h4><ul>
<li>删除user表row key为rk0001，列标示符为info:name的数据</li>
</ul>
<pre><code>HBase(main):045:0&gt; delete &#39;user&#39;, &#39;rk0001&#39;, &#39;info:name&#39;

</code></pre><h4 id="5-8-2-指定rowkey，列名以及版本号进行删除"><a href="#5-8-2-指定rowkey，列名以及版本号进行删除" class="headerlink" title="5.8.2 指定rowkey，列名以及版本号进行删除"></a>5.8.2 指定rowkey，列名以及版本号进行删除</h4><ul>
<li>删除user表row key为rk0001，列标示符为info:name，timestamp为1392383705316的数据</li>
</ul>
<pre><code>delete &#39;user&#39;, &#39;rk0001&#39;, &#39;info:name&#39;, 1392383705316

</code></pre><h4 id="5-8-3-删除一个列族"><a href="#5-8-3-删除一个列族" class="headerlink" title="5.8.3 删除一个列族"></a>5.8.3 删除一个列族</h4><ul>
<li>删除一个列族：</li>
</ul>
<pre><code>alter &#39;user&#39;, NAME =&gt; &#39;info&#39;, METHOD =&gt; &#39;delete&#39; 

或 alter &#39;user&#39;, &#39;delete&#39; =&gt; &#39;info&#39;

</code></pre><h4 id="5-8-4-清空表数据"><a href="#5-8-4-清空表数据" class="headerlink" title="5.8.4 清空表数据"></a>5.8.4 清空表数据</h4><pre><code>HBase(main):017:0&gt; truncate &#39;user&#39;

</code></pre><h4 id="5-8-5-删除表"><a href="#5-8-5-删除表" class="headerlink" title="5.8.5 删除表"></a>5.8.5 删除表</h4><ul>
<li>首先需要先让该表为disable状态，使用命令：</li>
</ul>
<pre><code>HBase(main):049:0&gt; disable &#39;user&#39;

</code></pre><ul>
<li>然后使用drop命令删除这个表</li>
</ul>
<pre><code> HBase(main):050:0&gt; drop &#39;user&#39;

</code></pre><blockquote>
<p>(注意：如果直接drop表，会报错：Drop the named table. Table must first be disabled)</p>
</blockquote>
<h3 id="5-9-统计一张表有多少行数据"><a href="#5-9-统计一张表有多少行数据" class="headerlink" title="5.9 统计一张表有多少行数据"></a>5.9 统计一张表有多少行数据</h3><pre><code>HBase(main):053:0&gt; count &#39;user&#39;

</code></pre><h2 id="6-HBase的高级shell管理命令"><a href="#6-HBase的高级shell管理命令" class="headerlink" title="6. HBase的高级shell管理命令"></a>6. HBase的高级shell管理命令</h2><h3 id="6-1-status"><a href="#6-1-status" class="headerlink" title="6.1 status"></a>6.1 status</h3><ul>
<li>例如：显示服务器状态</li>
</ul>
<pre><code>HBase(main):058:0&gt; status &#39;node01&#39;

</code></pre><h3 id="6-2-whoami"><a href="#6-2-whoami" class="headerlink" title="6.2 whoami"></a>6.2 whoami</h3><ul>
<li>显示HBase当前用户，例如：</li>
</ul>
<pre><code>HBase&gt; whoami

</code></pre><h3 id="6-3-list"><a href="#6-3-list" class="headerlink" title="6.3 list"></a>6.3 list</h3><ul>
<li>显示当前所有的表</li>
</ul>
<pre><code>HBase &gt;  list

</code></pre><h3 id="6-4-count"><a href="#6-4-count" class="headerlink" title="6.4 count"></a>6.4 count</h3><ul>
<li>统计指定表的记录数，例如：</li>
</ul>
<pre><code>HBase&gt; count &#39;user&#39; 

</code></pre><h3 id="6-5-describe"><a href="#6-5-describe" class="headerlink" title="6.5 describe"></a>6.5 describe</h3><ul>
<li>展示表结构信息</li>
</ul>
<pre><code>HBase&gt; describe &#39;user&#39;

</code></pre><h3 id="6-6-exists"><a href="#6-6-exists" class="headerlink" title="6.6 exists"></a>6.6 exists</h3><ul>
<li>检查表是否存在，适用于表量特别多的情况</li>
</ul>
<pre><code>HBase&gt; exists &#39;user&#39;

</code></pre><h3 id="6-7-is-enabled、is-disabled"><a href="#6-7-is-enabled、is-disabled" class="headerlink" title="6.7 is_enabled、is_disabled"></a>6.7 is_enabled、is_disabled</h3><ul>
<li>检查表是否启用或禁用</li>
</ul>
<pre><code>HBase&gt; is_enabled &#39;user&#39;
HBase&gt; is_disabled &#39;user&#39;

</code></pre><h3 id="6-8-alter"><a href="#6-8-alter" class="headerlink" title="6.8 alter"></a>6.8 alter</h3><ul>
<li><p>该命令可以改变表和列族的模式，例如：</p>
</li>
<li><p><strong>为当前表增加列族：</strong></p>
</li>
</ul>
<pre><code>HBase&gt; alter &#39;user&#39;, NAME =&gt; &#39;CF2&#39;, VERSIONS =&gt; 2

</code></pre><ul>
<li><strong>为当前表删除列族：</strong></li>
</ul>
<pre><code>HBase(main):002:0&gt;  alter &#39;user&#39;, &#39;delete&#39; =&gt; &#39;CF2&#39;

</code></pre><h3 id="6-9-disable-enable"><a href="#6-9-disable-enable" class="headerlink" title="6.9 disable/enable"></a>6.9 disable/enable</h3><ul>
<li>禁用一张表/启用一张表</li>
</ul>
<pre><code>HBase&gt; disable &#39;user&#39;
HBase&gt; enable &#39;user&#39;

</code></pre><h3 id="6-10-drop"><a href="#6-10-drop" class="headerlink" title="6.10 drop"></a>6.10 drop</h3><ul>
<li>删除一张表，记得在删除表之前必须先禁用</li>
</ul>
<h3 id="6-11-truncate"><a href="#6-11-truncate" class="headerlink" title="6.11 truncate"></a>6.11 truncate</h3><ul>
<li>禁用表-删除表-创建表</li>
</ul>
<h2 id="7-HBase的JavaAPI操作（重点）"><a href="#7-HBase的JavaAPI操作（重点）" class="headerlink" title="7. HBase的JavaAPI操作（重点）"></a>7. HBase的JavaAPI操作（重点）</h2><ul>
<li>HBase是一个分布式的NoSql数据库，在实际工作当中，我们一般都可以通过JavaAPI来进行各种数据的操作，包括创建表，以及数据的增删改查等等</li>
</ul>
<h3 id="7-1-创建maven工程"><a href="#7-1-创建maven工程" class="headerlink" title="7.1 创建maven工程"></a>7.1 创建maven工程</h3><ul>
<li>讲如下内容作为maven工程中pom.xml的repositories的内容</li>
<li>自动导包（需要从cloudera仓库下载，耗时较长，<strong>耐心等待</strong>）</li>
</ul>
<pre><code class="xml">    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;cloudera&lt;/id&gt;
            &lt;url&gt;https://repository.cloudera.com/artifactory/cloudera-repos/&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;
            &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;
            &lt;version&gt;2.6.0-mr1-cdh5.14.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.HBase&lt;/groupId&gt;
            &lt;artifactId&gt;hbase-client&lt;/artifactId&gt;
            &lt;version&gt;1.2.0-cdh5.14.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.HBase&lt;/groupId&gt;
            &lt;artifactId&gt;hbase-server&lt;/artifactId&gt;
            &lt;version&gt;1.2.0-cdh5.14.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.testng&lt;/groupId&gt;
            &lt;artifactId&gt;testng&lt;/artifactId&gt;
            &lt;version&gt;6.14.3&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.0&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.8&lt;/source&gt;
                    &lt;target&gt;1.8&lt;/target&gt;
                    &lt;encoding&gt;UTF-8&lt;/encoding&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.2&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;filters&gt;
                                &lt;filter&gt;
                                    &lt;artifact&gt;*:*&lt;/artifact&gt;
                                    &lt;excludes&gt;
                                        &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;
                                        &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;
                                        &lt;exclude&gt;META-INF/*/RSA&lt;/exclude&gt;
                                    &lt;/excludes&gt;
                                &lt;/filter&gt;
                            &lt;/filters&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

</code></pre>
<h3 id="7-2-创建myuser表"><a href="#7-2-创建myuser表" class="headerlink" title="7.2 创建myuser表"></a>7.2 创建myuser表</h3><ul>
<li>创建myuser表，此表有两个列族f1和f2</li>
</ul>
<pre><code class="java">    //操作数据库  第一步：获取连接  第二步：获取客户端对象   第三步：操作数据库  第四步：关闭
    /**
     * 创建一张表  myuser  两个列族  f1   f2
     */
    @Test
    public void createTable() throws IOException {
        Configuration configuration = HBaseConfiguration.create();
        //连接HBase集群不需要指定HBase主节点的ip地址和端口号
        configuration.set(&quot;HBase.zookeeper.quorum&quot;,&quot;node01:2181,node02:2181,node03:2181&quot;);
        //创建连接对象
        Connection connection = ConnectionFactory.createConnection(configuration);
        //获取连接对象，创建一张表
        //获取管理员对象，来对手数据库进行DDL的操作
        Admin admin = connection.getAdmin();
        //指定我们的表名
        TableName myuser = TableName.valueOf(&quot;myuser&quot;);
        HTableDescriptor hTableDescriptor = new HTableDescriptor(myuser);
        //指定两个列族
        HColumnDescriptor f1 = new HColumnDescriptor(&quot;f1&quot;);
        HColumnDescriptor f2 = new HColumnDescriptor(&quot;f2&quot;);
        hTableDescriptor.addFamily(f1);
        hTableDescriptor.addFamily(f2);
        admin.createTable(hTableDescriptor);
        admin.close();
        connection.close();

    }

</code></pre>
<h3 id="7-3-向表中添加数据"><a href="#7-3-向表中添加数据" class="headerlink" title="7.3 向表中添加数据"></a>7.3 向表中添加数据</h3><pre><code class="java">     private Connection connection ;
    private final String TABLE_NAME = &quot;myuser&quot;;
    private Table table ;

    @BeforeTest
    public void initTable () throws IOException {
        Configuration configuration = HBaseConfiguration.create();
        configuration.set(&quot;HBase.zookeeper.quorum&quot;,&quot;node01:2181,node02:2181&quot;);
        connection= ConnectionFactory.createConnection(configuration);
        table = connection.getTable(TableName.valueOf(TABLE_NAME));
    }

    @AfterTest
    public void close() throws IOException {
        table.close();
        connection.close();
    }


    /**
     *  向myuser表当中添加数据
     */
    @Test
    public void addData() throws IOException {
        //获取表
        Table table = connection.getTable(TableName.valueOf(TABLE_NAME));
        Put put = new Put(&quot;0001&quot;.getBytes());//创建put对象，并指定rowkey值
        put.addColumn(&quot;f1&quot;.getBytes(),&quot;name&quot;.getBytes(),&quot;zhangsan&quot;.getBytes());
        put.addColumn(&quot;f1&quot;.getBytes(),&quot;age&quot;.getBytes(), Bytes.toBytes(18));
        put.addColumn(&quot;f1&quot;.getBytes(),&quot;id&quot;.getBytes(), Bytes.toBytes(25));
        put.addColumn(&quot;f1&quot;.getBytes(),&quot;address&quot;.getBytes(), Bytes.toBytes(&quot;地球人&quot;));
        table.put(put);
        table.close();
    } 

</code></pre>
<h3 id="7-4-查询数据"><a href="#7-4-查询数据" class="headerlink" title="7.4 查询数据"></a>7.4 查询数据</h3><ul>
<li>初始化一批数据到HBase表当中，用于查询</li>
</ul>
<pre><code class="java">     @Test
    public void insertBatchData() throws IOException {

        //获取连接
        Configuration configuration = HBaseConfiguration.create();
        configuration.set(&quot;HBase.zookeeper.quorum&quot;, &quot;node01:2181,node02:2181&quot;);
        Connection connection = ConnectionFactory.createConnection(configuration);
        //获取表
        Table myuser = connection.getTable(TableName.valueOf(&quot;myuser&quot;));
        //创建put对象，并指定rowkey
        Put put = new Put(&quot;0002&quot;.getBytes());
        put.addColumn(&quot;f1&quot;.getBytes(),&quot;id&quot;.getBytes(),Bytes.toBytes(1));
        put.addColumn(&quot;f1&quot;.getBytes(),&quot;name&quot;.getBytes(),Bytes.toBytes(&quot;曹操&quot;));
        put.addColumn(&quot;f1&quot;.getBytes(),&quot;age&quot;.getBytes(),Bytes.toBytes(30));
        put.addColumn(&quot;f2&quot;.getBytes(),&quot;sex&quot;.getBytes(),Bytes.toBytes(&quot;1&quot;));
        put.addColumn(&quot;f2&quot;.getBytes(),&quot;address&quot;.getBytes(),Bytes.toBytes(&quot;沛国谯县&quot;));
        put.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes(),Bytes.toBytes(&quot;16888888888&quot;));
        put.addColumn(&quot;f2&quot;.getBytes(),&quot;say&quot;.getBytes(),Bytes.toBytes(&quot;helloworld&quot;));

        Put put2 = new Put(&quot;0003&quot;.getBytes());
        put2.addColumn(&quot;f1&quot;.getBytes(),&quot;id&quot;.getBytes(),Bytes.toBytes(2));
        put2.addColumn(&quot;f1&quot;.getBytes(),&quot;name&quot;.getBytes(),Bytes.toBytes(&quot;刘备&quot;));
        put2.addColumn(&quot;f1&quot;.getBytes(),&quot;age&quot;.getBytes(),Bytes.toBytes(32));
        put2.addColumn(&quot;f2&quot;.getBytes(),&quot;sex&quot;.getBytes(),Bytes.toBytes(&quot;1&quot;));
        put2.addColumn(&quot;f2&quot;.getBytes(),&quot;address&quot;.getBytes(),Bytes.toBytes(&quot;幽州涿郡涿县&quot;));
        put2.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes(),Bytes.toBytes(&quot;17888888888&quot;));
        put2.addColumn(&quot;f2&quot;.getBytes(),&quot;say&quot;.getBytes(),Bytes.toBytes(&quot;talk is cheap , show me the code&quot;));

        Put put3 = new Put(&quot;0004&quot;.getBytes());
        put3.addColumn(&quot;f1&quot;.getBytes(),&quot;id&quot;.getBytes(),Bytes.toBytes(3));
        put3.addColumn(&quot;f1&quot;.getBytes(),&quot;name&quot;.getBytes(),Bytes.toBytes(&quot;孙权&quot;));
        put3.addColumn(&quot;f1&quot;.getBytes(),&quot;age&quot;.getBytes(),Bytes.toBytes(35));
        put3.addColumn(&quot;f2&quot;.getBytes(),&quot;sex&quot;.getBytes(),Bytes.toBytes(&quot;1&quot;));
        put3.addColumn(&quot;f2&quot;.getBytes(),&quot;address&quot;.getBytes(),Bytes.toBytes(&quot;下邳&quot;));
        put3.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes(),Bytes.toBytes(&quot;12888888888&quot;));
        put3.addColumn(&quot;f2&quot;.getBytes(),&quot;say&quot;.getBytes(),Bytes.toBytes(&quot;what are you 弄啥嘞！&quot;));

        Put put4 = new Put(&quot;0005&quot;.getBytes());
        put4.addColumn(&quot;f1&quot;.getBytes(),&quot;id&quot;.getBytes(),Bytes.toBytes(4));
        put4.addColumn(&quot;f1&quot;.getBytes(),&quot;name&quot;.getBytes(),Bytes.toBytes(&quot;诸葛亮&quot;));
        put4.addColumn(&quot;f1&quot;.getBytes(),&quot;age&quot;.getBytes(),Bytes.toBytes(28));
        put4.addColumn(&quot;f2&quot;.getBytes(),&quot;sex&quot;.getBytes(),Bytes.toBytes(&quot;1&quot;));
        put4.addColumn(&quot;f2&quot;.getBytes(),&quot;address&quot;.getBytes(),Bytes.toBytes(&quot;四川隆中&quot;));
        put4.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes(),Bytes.toBytes(&quot;14888888888&quot;));
        put4.addColumn(&quot;f2&quot;.getBytes(),&quot;say&quot;.getBytes(),Bytes.toBytes(&quot;出师表你背了嘛&quot;));

        Put put5 = new Put(&quot;0006&quot;.getBytes());
        put5.addColumn(&quot;f1&quot;.getBytes(),&quot;id&quot;.getBytes(),Bytes.toBytes(5));
        put5.addColumn(&quot;f1&quot;.getBytes(),&quot;name&quot;.getBytes(),Bytes.toBytes(&quot;司马懿&quot;));
        put5.addColumn(&quot;f1&quot;.getBytes(),&quot;age&quot;.getBytes(),Bytes.toBytes(27));
        put5.addColumn(&quot;f2&quot;.getBytes(),&quot;sex&quot;.getBytes(),Bytes.toBytes(&quot;1&quot;));
        put5.addColumn(&quot;f2&quot;.getBytes(),&quot;address&quot;.getBytes(),Bytes.toBytes(&quot;哪里人有待考究&quot;));
        put5.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes(),Bytes.toBytes(&quot;15888888888&quot;));
        put5.addColumn(&quot;f2&quot;.getBytes(),&quot;say&quot;.getBytes(),Bytes.toBytes(&quot;跟诸葛亮死掐&quot;));


        Put put6 = new Put(&quot;0007&quot;.getBytes());
        put6.addColumn(&quot;f1&quot;.getBytes(),&quot;id&quot;.getBytes(),Bytes.toBytes(5));
        put6.addColumn(&quot;f1&quot;.getBytes(),&quot;name&quot;.getBytes(),Bytes.toBytes(&quot;xiaobubu—吕布&quot;));
        put6.addColumn(&quot;f1&quot;.getBytes(),&quot;age&quot;.getBytes(),Bytes.toBytes(28));
        put6.addColumn(&quot;f2&quot;.getBytes(),&quot;sex&quot;.getBytes(),Bytes.toBytes(&quot;1&quot;));
        put6.addColumn(&quot;f2&quot;.getBytes(),&quot;address&quot;.getBytes(),Bytes.toBytes(&quot;内蒙人&quot;));
        put6.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes(),Bytes.toBytes(&quot;15788888888&quot;));
        put6.addColumn(&quot;f2&quot;.getBytes(),&quot;say&quot;.getBytes(),Bytes.toBytes(&quot;貂蝉去哪了&quot;));

        List&lt;Put&gt; listPut = new ArrayList&lt;Put&gt;();
        listPut.add(put);
        listPut.add(put2);
        listPut.add(put3);
        listPut.add(put4);
        listPut.add(put5);
        listPut.add(put6);

        myuser.put(listPut);
        myuser.close();
        connection.close();
    }

</code></pre>
<h4 id="7-4-1-Get查询"><a href="#7-4-1-Get查询" class="headerlink" title="7.4.1 Get查询"></a>7.4.1 Get查询</h4><ul>
<li>按照rowkey进行查询，获取所有列的所有值</li>
<li>查询主键rowkey为0003的人</li>
</ul>
<pre><code class="java">     /**
     * 查询rowkey为0003的人
     */
    @Test
    public void getData() throws IOException {
        Table table = connection.getTable(TableName.valueOf(TABLE_NAME));
        //通过get对象，指定rowkey
        Get get = new Get(Bytes.toBytes(&quot;0003&quot;));

        get.addFamily(&quot;f1&quot;.getBytes());//限制只查询f1列族下面所有列的值
        //查询f2  列族 phone  这个字段
        get.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes());
        //通过get查询，返回一个result对象，所有的字段的数据都是封装在result里面了
        Result result = table.get(get);
        List&lt;Cell&gt; cells = result.listCells();  //获取一条数据所有的cell，所有数据值都是在cell里面 的
        for (Cell cell : cells) {
            byte[] family_name = CellUtil.cloneFamily(cell);//获取列族名
            byte[] column_name = CellUtil.cloneQualifier(cell);//获取列名
            byte[] rowkey = CellUtil.cloneRow(cell);//获取rowkey
            byte[] cell_value = CellUtil.cloneValue(cell);//获取cell值
            //需要判断字段的数据类型，使用对应的转换的方法，才能够获取到值
            if(&quot;age&quot;.equals(Bytes.toString(column_name))  || &quot;id&quot;.equals(Bytes.toString(column_name))){
                System.out.println(Bytes.toString(family_name));
                System.out.println(Bytes.toString(column_name));
                System.out.println(Bytes.toString(rowkey));
                System.out.println(Bytes.toInt(cell_value));
            }else{
                System.out.println(Bytes.toString(family_name));
                System.out.println(Bytes.toString(column_name));
                System.out.println(Bytes.toString(rowkey));
                System.out.println(Bytes.toString(cell_value));
            }
        }
        table.close();
    }
</code></pre>
<h4 id="7-4-2-Scan查询"><a href="#7-4-2-Scan查询" class="headerlink" title="7.4.2 Scan查询"></a>7.4.2 Scan查询</h4><pre><code class="java">    /**
     * 不知道rowkey的具体值，我想查询rowkey范围值是0003  到0006
     * select * from myuser  where age &gt; 30  and id &lt; 8  and name like &#39;zhangsan&#39;
     *
     */
    @Test
    public void scanData() throws IOException {
        //获取table
        Table table = connection.getTable(TableName.valueOf(TABLE_NAME));
        Scan scan = new Scan();//没有指定startRow以及stopRow  全表扫描
        //只扫描f1列族
        scan.addFamily(&quot;f1&quot;.getBytes());
        //扫描 f2列族 phone  这个字段
        scan.addColumn(&quot;f2&quot;.getBytes(),&quot;phone&quot;.getBytes());
        scan.setStartRow(&quot;0003&quot;.getBytes());
        scan.setStopRow(&quot;0007&quot;.getBytes());
        //通过getScanner查询获取到了表里面所有的数据，是多条数据
        ResultScanner scanner = table.getScanner(scan);
        //遍历ResultScanner 得到每一条数据，每一条数据都是封装在result对象里面了
        for (Result result : scanner) {
            List&lt;Cell&gt; cells = result.listCells();
            for (Cell cell : cells) {
                byte[] family_name = CellUtil.cloneFamily(cell);
                byte[] qualifier_name = CellUtil.cloneQualifier(cell);
                byte[] rowkey = CellUtil.cloneRow(cell);
                byte[] value = CellUtil.cloneValue(cell);
                //判断id和age字段，这两个字段是整形值
                if(&quot;age&quot;.equals(Bytes.toString(qualifier_name))  || &quot;id&quot;.equals(Bytes.toString(qualifier_name))){
                    System.out.println(&quot;数据的rowkey为&quot; +  Bytes.toString(rowkey)   +&quot;======数据的列族为&quot; +  Bytes.toString(family_name)+&quot;======数据的列名为&quot; +  Bytes.toString(qualifier_name) + &quot;==========数据的值为&quot; +Bytes.toInt(value));
                }else{
                    System.out.println(&quot;数据的rowkey为&quot; +  Bytes.toString(rowkey)   +&quot;======数据的列族为&quot; +  Bytes.toString(family_name)+&quot;======数据的列名为&quot; +  Bytes.toString(qualifier_name) + &quot;==========数据的值为&quot; +Bytes.toString(value));
                }
            }
        }
        table.close();
    }
</code></pre>
<h3 id="7-5-HBase过滤器查询"><a href="#7-5-HBase过滤器查询" class="headerlink" title="7.5 HBase过滤器查询"></a>7.5 HBase过滤器查询</h3><h4 id="7-5-1-过滤器"><a href="#7-5-1-过滤器" class="headerlink" title="7.5.1 过滤器"></a>7.5.1 过滤器</h4><ul>
<li><p>过滤器的作用是在服务端判断数据是否满足条件，然后只将满足条件的数据返回给客户端</p>
</li>
<li><p>过滤器的类型很多，但是可以分为两大类</p>
<ul>
<li>==比较过滤器==</li>
<li>==专用过滤器==</li>
</ul>
</li>
<li><p>HBase过滤器的<strong>比较运算符</strong>：</p>
</li>
</ul>
<pre><code>LESS  &lt;
LESS_OR_EQUAL &lt;=
EQUAL =
NOT_EQUAL &lt;&gt;
GREATER_OR_EQUAL &gt;=
GREATER &gt;
NO_OP 排除所有
</code></pre><ul>
<li>Hbase过滤器的<strong>比较器</strong>（指定比较机制）：</li>
</ul>
<pre><code>BinaryComparator  按字节索引顺序比较指定字节数组，采用Bytes.compareTo(byte[])
BinaryPrefixComparator 跟前面相同，只是比较左端的数据是否相同
NullComparator 判断给定的是否为空
BitComparator 按位比较
RegexStringComparator 提供一个正则的比较器，仅支持 EQUAL 和非EQUAL
SubstringComparator 判断提供的子串是否出现在中。
</code></pre><h4 id="7-5-2-比较过滤器使用"><a href="#7-5-2-比较过滤器使用" class="headerlink" title="7.5.2 比较过滤器使用"></a>7.5.2 比较过滤器使用</h4><h5 id="1、rowKey过滤器RowFilter"><a href="#1、rowKey过滤器RowFilter" class="headerlink" title="1、rowKey过滤器RowFilter"></a>1、rowKey过滤器RowFilter</h5><ul>
<li>通过RowFilter过滤比rowKey  0003小的所有值出来</li>
</ul>
<pre><code class="java">    /**
     * 查询所有的rowkey比0003小的所有的数据
     */
    @Test
    public void rowFilter() throws IOException {
        Table table = connection.getTable(TableName.valueOf(TABLE_NAME));
        Scan scan = new Scan();
        //获取我们比较对象
        BinaryComparator binaryComparator = new BinaryComparator(&quot;0003&quot;.getBytes());
        /***
         * rowFilter需要加上两个参数
         * 第一个参数就是我们的比较规则
         * 第二个参数就是我们的比较对象
         */
        RowFilter rowFilter = new RowFilter(CompareFilter.CompareOp.GREATER, binaryComparator);
        //为我们的scan对象设置过滤器
        scan.setFilter(rowFilter);
        ResultScanner scanner = table.getScanner(scan);
        for (Result result : scanner) {
            List&lt;Cell&gt; cells = result.listCells();
            for (Cell cell : cells) {
                byte[] family_name = CellUtil.cloneFamily(cell);
                byte[] qualifier_name = CellUtil.cloneQualifier(cell);
                byte[] rowkey = CellUtil.cloneRow(cell);
                byte[] value = CellUtil.cloneValue(cell);
                //判断id和age字段，这两个字段是整形值
                if(&quot;age&quot;.equals(Bytes.toString(qualifier_name))  || &quot;id&quot;.equals(Bytes.toString(qualifier_name))){
                    System.out.println(&quot;数据的rowkey为&quot; +  Bytes.toString(rowkey)   +&quot;======数据的列族为&quot; +  Bytes.toString(family_name)+&quot;======数据的列名为&quot; +  Bytes.toString(qualifier_name) + &quot;==========数据的值为&quot; +Bytes.toInt(value));
                }else{
                    System.out.println(&quot;数据的rowkey为&quot; +  Bytes.toString(rowkey)   +&quot;======数据的列族为&quot; +  Bytes.toString(family_name)+&quot;======数据的列名为&quot; +  Bytes.toString(qualifier_name) + &quot;==========数据的值为&quot; +Bytes.toString(value));
                }
            }
        }
    }
</code></pre>
<h5 id="2、列族过滤器FamilyFilter"><a href="#2、列族过滤器FamilyFilter" class="headerlink" title="2、列族过滤器FamilyFilter"></a>2、列族过滤器FamilyFilter</h5><ul>
<li>查询列族名包含f2的所有列族下面的数据</li>
</ul>
<pre><code class="JAVA">    /**
     * 通过familyFilter来实现列族的过滤
     * 需要过滤，列族名包含f2
     * f1  f2   hello   world
     */
    @Test
    public void familyFilter() throws IOException {
        Table table = connection.getTable(TableName.valueOf(TABLE_NAME));
        Scan scan = new Scan();
        SubstringComparator substringComparator = new SubstringComparator(&quot;f2&quot;);
        //通过familyfilter来设置列族的过滤器
        FamilyFilter familyFilter = new FamilyFilter(CompareFilter.CompareOp.EQUAL, substringComparator);
        scan.setFilter(familyFilter);
        ResultScanner scanner = table.getScanner(scan);
        for (Result result : scanner) {
            List&lt;Cell&gt; cells = result.listCells();
            for (Cell cell : cells) {
                byte[] family_name = CellUtil.cloneFamily(cell);
                byte[] qualifier_name = CellUtil.cloneQualifier(cell);
                byte[] rowkey = CellUtil.cloneRow(cell);
                byte[] value = CellUtil.cloneValue(cell);
                //判断id和age字段，这两个字段是整形值
                if(&quot;age&quot;.equals(Bytes.toString(qualifier_name))  || &quot;id&quot;.equals(Bytes.toString(qualifier_name))){
                    System.out.println(&quot;数据的rowkey为&quot; +  Bytes.toString(rowkey)   +&quot;======数据的列族为&quot; +  Bytes.toString(family_name)+&quot;======数据的列名为&quot; +  Bytes.toString(qualifier_name) + &quot;==========数据的值为&quot; +Bytes.toInt(value));
                }else{
                    System.out.println(&quot;数据的rowkey为&quot; +  Bytes.toString(rowkey)   +&quot;======数据的列族为&quot; +  Bytes.toString(family_name)+&quot;======数据的列名为&quot; +  Bytes.toString(qualifier_name) + &quot;==========数据的值为&quot; +Bytes.toString(value));
                }
            }
        }
    }
</code></pre>
<h5 id="3、列过滤器QualifierFilter"><a href="#3、列过滤器QualifierFilter" class="headerlink" title="3、列过滤器QualifierFilter"></a>3、列过滤器QualifierFilter</h5><ul>
<li>只查询name列的值</li>
</ul>
<pre><code class="java">/**
     * 列名过滤器 只查询包含name列的值
     */
    @Test
    public void  qualifierFilter() throws IOException {
        Scan scan = new Scan();
        SubstringComparator substringComparator = new SubstringComparator(&quot;name&quot;);
        //定义列名过滤器，只查询列名包含name的列
        QualifierFilter qualifierFilter = new QualifierFilter(CompareFilter.CompareOp.EQUAL, substringComparator);
        scan.setFilter(qualifierFilter);
        ResultScanner scanner = table.getScanner(scan);
        printlReult(scanner);
    }
</code></pre>
<h5 id="4、列值过滤器ValueFilter"><a href="#4、列值过滤器ValueFilter" class="headerlink" title="4、列值过滤器ValueFilter"></a>4、列值过滤器ValueFilter</h5><ul>
<li>查询所有列当中包含8的数据</li>
</ul>
<pre><code class="java">    /**
     * 查询哪些字段值  包含数字8
     */
    @Test
    public void contains8() throws IOException {
        Scan scan = new Scan();
        SubstringComparator substringComparator = new SubstringComparator(&quot;8&quot;);
        //列值过滤器，过滤列值当中包含数字8的所有的列
        ValueFilter valueFilter = new ValueFilter(CompareFilter.CompareOp.EQUAL, substringComparator);
        scan.setFilter(valueFilter);
        ResultScanner scanner = table.getScanner(scan);
        printlReult(scanner);
    }
</code></pre>
<h4 id="7-5-3-专用过滤器使用"><a href="#7-5-3-专用过滤器使用" class="headerlink" title="7.5.3 专用过滤器使用"></a>7.5.3 专用过滤器使用</h4><h5 id="1、单列值过滤器-SingleColumnValueFilter"><a href="#1、单列值过滤器-SingleColumnValueFilter" class="headerlink" title="1、单列值过滤器 SingleColumnValueFilter"></a>1、单列值过滤器 SingleColumnValueFilter</h5><ul>
<li><p>SingleColumnValueFilter会返回满足条件的整列值的所有字段</p>
</li>
<li><p>查询名字为刘备的数据</p>
</li>
</ul>
<pre><code class="java">    /**
     * select  *  from  myuser where name  = &#39;刘备&#39;
     * 会返回我们符合条件数据的所有的字段
     *
     * SingleColumnValueExcludeFilter  列值排除过滤器
     *  select  *  from  myuser where name  ！= &#39;刘备&#39;
     */
    @Test
    public void singleColumnValueFilter() throws IOException {
        //查询 f1  列族 name  列  值为刘备的数据
        Scan scan = new Scan();
        //单列值过滤器，过滤  f1 列族  name  列  值为刘备的数据
        SingleColumnValueFilter singleColumnValueFilter = new SingleColumnValueFilter(&quot;f1&quot;.getBytes(), &quot;name&quot;.getBytes(), CompareFilter.CompareOp.EQUAL, &quot;刘备&quot;.getBytes());
        scan.setFilter(singleColumnValueFilter);
        ResultScanner scanner = table.getScanner(scan);
        printlReult(scanner);
    }
</code></pre>
<h5 id="2、列值排除过滤器SingleColumnValueExcludeFilter"><a href="#2、列值排除过滤器SingleColumnValueExcludeFilter" class="headerlink" title="2、列值排除过滤器SingleColumnValueExcludeFilter"></a>2、列值排除过滤器SingleColumnValueExcludeFilter</h5><ul>
<li>与SingleColumnValueFilter相反，会排除掉指定的列，其他的列全部返回</li>
</ul>
<h5 id="3、rowkey前缀过滤器PrefixFilter"><a href="#3、rowkey前缀过滤器PrefixFilter" class="headerlink" title="3、rowkey前缀过滤器PrefixFilter"></a>3、rowkey前缀过滤器PrefixFilter</h5><ul>
<li>查询以00开头的所有前缀的rowkey</li>
</ul>
<pre><code class="java">    /**
     * 查询rowkey前缀以  00开头的所有的数据
     */
    @Test
    public  void  prefixFilter() throws IOException {
        Scan scan = new Scan();
        //过滤rowkey以  00开头的数据
        PrefixFilter prefixFilter = new PrefixFilter(&quot;00&quot;.getBytes());
        scan.setFilter(prefixFilter);
        ResultScanner scanner = table.getScanner(scan);
        printlReult(scanner);
    }
</code></pre>
<h5 id="4、分页过滤器PageFilter（15分钟）"><a href="#4、分页过滤器PageFilter（15分钟）" class="headerlink" title="4、分页过滤器PageFilter（15分钟）"></a>4、分页过滤器PageFilter（15分钟）</h5><ul>
<li>通过pageFilter实现分页过滤器</li>
</ul>
<pre><code class="java">    /**
     * HBase当中的分页
     */
    @Test
    public void hbasePageFilter() throws IOException {
        int pageNum= 3;
        int pageSize = 2;
        Scan scan = new Scan();
        if(pageNum == 1 ){
            //获取第一页的数据
            scan.setMaxResultSize(pageSize);
            scan.setStartRow(&quot;&quot;.getBytes());
            //使用分页过滤器来实现数据的分页
            PageFilter filter = new PageFilter(pageSize);
            scan.setFilter(filter);
            ResultScanner scanner = table.getScanner(scan);
            printlReult(scanner);
        }else{
            String  startRow = &quot;&quot;;
            //扫描数据的调试 扫描五条数据
            int scanDatas = (pageNum - 1) * pageSize + 1;
            scan.setMaxResultSize(scanDatas);//设置一步往前扫描多少条数据
            PageFilter filter = new PageFilter(scanDatas);
            scan.setFilter(filter);
            ResultScanner scanner = table.getScanner(scan);
            for (Result result : scanner) {
                byte[] row = result.getRow();//获取rowkey
                //最后一次startRow的值就是0005
                startRow= Bytes.toString(row);//循环遍历我们多有获取到的数据的rowkey
                //最后一条数据的rowkey就是我们需要的起始的rowkey
            }
            //获取第三页的数据
            scan.setStartRow(startRow.getBytes());
            scan.setMaxResultSize(pageSize);//设置我们扫描多少条数据
            PageFilter filter1 = new PageFilter(pageSize);
            scan.setFilter(filter1);
            ResultScanner scanner1 = table.getScanner(scan);
            printlReult(scanner1);
        }
    }
</code></pre>
<h4 id="3、多过滤器综合查询FilterList"><a href="#3、多过滤器综合查询FilterList" class="headerlink" title="3、多过滤器综合查询FilterList"></a>3、多过滤器综合查询FilterList</h4><ul>
<li>需求：使用SingleColumnValueFilter查询f1列族，name为刘备的数据，并且同时满足rowkey的前缀以00开头的数据（PrefixFilter）</li>
</ul>
<pre><code class="java">    /**
     * 查询  f1 列族  name  为刘备数据值
     * 并且rowkey 前缀以  00开头数据
     */
    @Test
    public  void filterList() throws IOException {
        Scan scan = new Scan();
        SingleColumnValueFilter singleColumnValueFilter = new SingleColumnValueFilter(&quot;f1&quot;.getBytes(), &quot;name&quot;.getBytes(), CompareFilter.CompareOp.EQUAL, &quot;刘备&quot;.getBytes());
        PrefixFilter prefixFilter = new PrefixFilter(&quot;00&quot;.getBytes());
        FilterList filterList = new FilterList();
        filterList.addFilter(singleColumnValueFilter);
        filterList.addFilter(prefixFilter);
        scan.setFilter(filterList);
        ResultScanner scanner = table.getScanner(scan);
        printlReult(scanner);
    }
</code></pre>
<h3 id="7-6-HBase的删除操作"><a href="#7-6-HBase的删除操作" class="headerlink" title="7.6 HBase的删除操作"></a>7.6 HBase的删除操作</h3><h4 id="1、根据rowkey删除数据"><a href="#1、根据rowkey删除数据" class="headerlink" title="1、根据rowkey删除数据"></a>1、根据rowkey删除数据</h4><ul>
<li>删除rowkey为003的数据</li>
</ul>
<pre><code class="java">    /**
     * 删除数据
     */
    @Test
    public  void  deleteData() throws IOException {
        Delete delete = new Delete(&quot;0003&quot;.getBytes());
        table.delete(delete);
    }
</code></pre>
<h4 id="2、删除表操作"><a href="#2、删除表操作" class="headerlink" title="2、删除表操作"></a>2、删除表操作</h4><pre><code class="java">     /**
     * 删除表
     */
    @Test
    public void deleteTable() throws IOException {
        //获取管理员对象，用于表的删除
        Admin admin = connection.getAdmin();
        //删除一张表之前，需要先禁用表
        admin.disableTable(TableName.valueOf(TABLE_NAME));
        admin.deleteTable(TableName.valueOf(TABLE_NAME));
    }
</code></pre>
<h1 id="五、拓展点、未来计划、行业趋势"><a href="#五、拓展点、未来计划、行业趋势" class="headerlink" title="五、拓展点、未来计划、行业趋势"></a>五、拓展点、未来计划、行业趋势</h1><h3 id="8-Hbase在实际场景中的应用"><a href="#8-Hbase在实际场景中的应用" class="headerlink" title="8. Hbase在实际场景中的应用"></a>8. Hbase在实际场景中的应用</h3><h5 id="8-1-交通方面"><a href="#8-1-交通方面" class="headerlink" title="8.1 交通方面"></a>8.1 交通方面</h5><ul>
<li>船舶GPS信息，全长江的船舶GPS信息，每天有1千万左右的数据存储。</li>
</ul>
<h5 id="8-2-金融方面"><a href="#8-2-金融方面" class="headerlink" title="8.2 金融方面"></a>8.2 金融方面</h5><ul>
<li>消费信息、贷款信息、信用卡还款信息等</li>
</ul>
<h5 id="8-3-电商方面"><a href="#8-3-电商方面" class="headerlink" title="8.3 电商方面"></a>8.3 电商方面</h5><ul>
<li>电商网站的交易信息、物流信息、游览信息等</li>
</ul>
<h5 id="8-4-电信方面"><a href="#8-4-电信方面" class="headerlink" title="8.4 电信方面"></a>8.4 电信方面</h5><ul>
<li>通话信息、语音详单等</li>
</ul>
<p>==<strong>总结：海量明细数据的存储，并且后期需要有很好的查询性能</strong>==</p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a href="https://blog.sev7e0.site/">大数据施工现场</a></span>
        <span>/</span>
        
        <span><a href="https://wangchujiang.com/linux-command/">linux命令行工具</a></span>
        <span>/</span>
        
        <span><a href="https://github.com/orchid-ding">github</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/js/gitment.js"></script>
<script>
    var gitment = new Gitment({
        id: '大数据开发之Hbase（一）',
        owner: 'orchid-ding',
        repo: 'kfly-blog-comment',
        oauth: {
            client_id: '0770cdab79393197b6f5',
            client_secret: '376fb6c7bcd5047718b356712f596b89e490360c',
        },
    })
    gitment.render('comment-container')
</script>




</html>
