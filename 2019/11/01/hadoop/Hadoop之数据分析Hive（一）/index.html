<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="天行健、君子以自强不息；地势坤，君子以厚德载物。">
    <meta name="keyword"  content="兰草">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        Hadoop之数据分析Hive（一） - Kaffir Lily的博客 | Kaffir Lily&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 君子谦谦，温和有礼，有才而不骄，得志而不傲，居于谷而不卑。 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>kfly</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="icon-font icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-数据仓库的基本概念"><span class="toc-text">1.数据仓库的基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-数据仓库的基本概念-1"><span class="toc-text">1.数据仓库的基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-数据仓库的主要特征"><span class="toc-text">2.数据仓库的主要特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-数据仓库与数据库区别"><span class="toc-text">3. 数据仓库与数据库区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-数据仓库分层架构"><span class="toc-text">4.数据仓库分层架构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Hive是什么"><span class="toc-text">2. Hive是什么</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-hive的概念"><span class="toc-text">1 hive的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Hive与数据库的区别"><span class="toc-text">2 Hive与数据库的区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Hive的优缺点"><span class="toc-text">3 Hive的优缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Hive架构原理"><span class="toc-text">4 Hive架构原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Hive的安装部署"><span class="toc-text">3. Hive的安装部署</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-hive的交互方式"><span class="toc-text">4. hive的交互方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Hive交互shell"><span class="toc-text">1 Hive交互shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Hive-JDBC服务"><span class="toc-text">2 Hive JDBC服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Hive的命令"><span class="toc-text">3  Hive的命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、Hive的数据类型"><span class="toc-text">5、Hive的数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-基本数据类型"><span class="toc-text">1 基本数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-复合数据类型"><span class="toc-text">2 复合数据类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、Hive的DDL操作"><span class="toc-text">6、Hive的DDL操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-hive的数据库DDL操作"><span class="toc-text">1 hive的数据库DDL操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1、创建数据库"><span class="toc-text">1、创建数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2、显示所有数据库"><span class="toc-text">2、显示所有数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3、查询数据库"><span class="toc-text">3、查询数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4、查看数据库详情"><span class="toc-text">4、查看数据库详情</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5、显示数据库详细信息"><span class="toc-text">5、显示数据库详细信息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6、切换当前数据库"><span class="toc-text">6、切换当前数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7、删除数据库"><span class="toc-text">7、删除数据库</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-hive的表DDL操作"><span class="toc-text">6.2 hive的表DDL操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-、建表语法介绍"><span class="toc-text">1 、建表语法介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-、字段解释说明"><span class="toc-text">2 、字段解释说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3、-创建内部表"><span class="toc-text">3、 创建内部表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4、-创建外部表"><span class="toc-text">4、 创建外部表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5、-内部表与外部表的互相转换"><span class="toc-text">5、 内部表与外部表的互相转换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6、-内部表与外部表的区别"><span class="toc-text">6、 内部表与外部表的区别</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7、内部表与外部表的使用时机"><span class="toc-text">7、内部表与外部表的使用时机</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8、hive的分区表"><span class="toc-text">8、hive的分区表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9、hive的分桶表"><span class="toc-text">9、hive的分桶表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7、Hive修改表结构"><span class="toc-text">7、Hive修改表结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-修改表的名称"><span class="toc-text">7.1 修改表的名称</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-表的结构信息"><span class="toc-text">7.2 表的结构信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-增加-修改-替换列信息"><span class="toc-text">7.3 增加/修改/替换列信息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Hive数据导入"><span class="toc-text">8. Hive数据导入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1、直接向表中插入数据（强烈不推荐使用）"><span class="toc-text">8.1、直接向表中插入数据（强烈不推荐使用）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2、通过load方式加载数据（必须掌握）"><span class="toc-text">8.2、通过load方式加载数据（必须掌握）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3、通过查询方式加载数据（必须掌握）"><span class="toc-text">8.3、通过查询方式加载数据（必须掌握）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-4、查询语句中创建表并加载数据（as-select）"><span class="toc-text">8.4、查询语句中创建表并加载数据（as select）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-5、创建表时通过location指定加载数据路径"><span class="toc-text">8.5、创建表时通过location指定加载数据路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-6、export导出与import-导入-hive表数据（内部表操作）"><span class="toc-text">8.6、export导出与import 导入 hive表数据（内部表操作）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9、Hive数据导出"><span class="toc-text">9、Hive数据导出</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-insert-导出"><span class="toc-text">9.1 insert 导出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2、-Hive-Shell-命令导出"><span class="toc-text">9.2、 Hive Shell 命令导出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3、export导出到HDFS上"><span class="toc-text">9.3、export导出到HDFS上</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10、hive的静态分区和动态分区"><span class="toc-text">10、hive的静态分区和动态分区</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-静态分区"><span class="toc-text">10.1 静态分区</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-动态分区"><span class="toc-text">.2 动态分区</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11、hive的基本查询语法"><span class="toc-text">11、hive的基本查询语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-基本查询"><span class="toc-text">1. 基本查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-全表和特定列查询"><span class="toc-text">1.1 全表和特定列查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-列起别名"><span class="toc-text">1.2 列起别名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-limit-语句"><span class="toc-text">1.4 limit 语句</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-5-where-语句"><span class="toc-text">1.5 where 语句</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-6-算术运算符"><span class="toc-text">1.6 算术运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-7-比较运算符"><span class="toc-text">1.7 比较运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-逻辑运算符"><span class="toc-text">1.8 逻辑运算符</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-分组"><span class="toc-text">2. 分组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-Group-By-语句"><span class="toc-text">2.1 Group By 语句</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-Having语句"><span class="toc-text">2.2 Having语句</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-join语句"><span class="toc-text">3. join语句</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#11-3-1-等值-join"><span class="toc-text">11.3.1 等值 join</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-3-2-表的别名"><span class="toc-text">11.3.2 表的别名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-3-3-内连接-inner-join"><span class="toc-text">11.3.3 内连接 inner join</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-3-4-左外连接-left-outer-join"><span class="toc-text">11.3.4 左外连接 left outer join</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-5-右外连接-right-outer-join"><span class="toc-text">3.5 右外连接 right outer join</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-3-6-满外连接-full-outer-join"><span class="toc-text">11.3.6 满外连接 full outer join</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-3-7-多表连接"><span class="toc-text">11.3.7 多表连接</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-4-排序"><span class="toc-text">11.4. 排序</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#11-4-1-order-by-全局排序"><span class="toc-text">11.4.1 order by 全局排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-4-2-按照别名排序"><span class="toc-text">11.4.2 按照别名排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-4-3-每个MapReduce内部排序（Sort-By）局部排序"><span class="toc-text">11.4.3 每个MapReduce内部排序（Sort By）局部排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-4-4-distribute-by-分区排序"><span class="toc-text">11.4.4 distribute by 分区排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-4-5-cluster-by"><span class="toc-text">11.4.5 cluster by</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12、hive客户端jdbc操作"><span class="toc-text">12、hive客户端jdbc操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#第一步：启动hiveserver2的服务端"><span class="toc-text">第一步：启动hiveserver2的服务端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第二步：引入依赖"><span class="toc-text">第二步：引入依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第三步：代码开发"><span class="toc-text">第三步：代码开发</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#、hive的可视化工具dbeaver介绍以及使用"><span class="toc-text">、hive的可视化工具dbeaver介绍以及使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、dbeaver的基本介绍"><span class="toc-text">1、dbeaver的基本介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、dbeaver的下载安装"><span class="toc-text">2、dbeaver的下载安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、dbeaver的安装与使用"><span class="toc-text">3、dbeaver的安装与使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#第一步：双击dbeaver-exe然后启动dbeaver图形化界面"><span class="toc-text">第一步：双击dbeaver.exe然后启动dbeaver图形化界面</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#第二步：配置我们的主机名与端口号"><span class="toc-text">第二步：配置我们的主机名与端口号</span></a></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 君子谦谦，温和有礼，有才而不骄，得志而不傲，居于谷而不卑。 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        Hadoop之数据分析Hive（一）
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-11-01 16:01:32</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#hadoop" title="hadoop">hadoop</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#hive" title="hive">hive</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h3 id="1-数据仓库的基本概念"><a href="#1-数据仓库的基本概念" class="headerlink" title="1.数据仓库的基本概念"></a>1.数据仓库的基本概念</h3><h4 id="1-数据仓库的基本概念-1"><a href="#1-数据仓库的基本概念-1" class="headerlink" title="1.数据仓库的基本概念"></a>1.数据仓库的基本概念</h4><p>英文名称为Data Warehouse，可简写为DW或DWH。数据仓库的目的是构建面向分析的集成化数据环境，为企业提供决策支持（Decision Support）。它出于分析性报告和决策支持目的而创建。</p>
<p>数据仓库本身并不“生产”任何数据，同时自身也不需要“消费”任何的数据，数据来源于外部，并且开放给外部应用，这也是为什么叫“仓库”，而不叫“工厂”的原因。</p>
<h4 id="2-数据仓库的主要特征"><a href="#2-数据仓库的主要特征" class="headerlink" title="2.数据仓库的主要特征"></a>2.数据仓库的主要特征</h4><p>数据仓库是面向主题的（Subject-Oriented）、集成的（Integrated）、非易失的（Non-Volatile）和时变的（Time-Variant ）数据集合，用以支持管理决策。</p>
<h4 id="3-数据仓库与数据库区别"><a href="#3-数据仓库与数据库区别" class="headerlink" title="3. 数据仓库与数据库区别"></a>3. 数据仓库与数据库区别</h4><p>数据库与数据仓库的区别实际讲的是 OLTP 与 OLAP 的区别。 </p>
<p>操作型处理，叫联机事务处理 OLTP（On-Line Transaction Processing，），也可以称面向交易的处理系统，它是针对具体业务在数据库联机的日常操作，通常对少数记录进行查询、修改。用户较为关心操作的响应时间、数据的安全性、完整性和并发支持的用户数等问题。传统的数据库系统作为数据管理的主要手段，主要用于操作型处理。 </p>
<p>分析型处理，叫联机分析处理 OLAP（On-Line Analytical Processing）一般针对某些主题的历史数据进行分析，支持管理决策。</p>
<p>首先要明白，数据仓库的出现，并不是要取代数据库。</p>
<p>数据库是面向事务的设计，数据仓库是面向主题设计的。</p>
<p>数据库一般存储业务数据，数据仓库存储的一般是历史数据。</p>
<p>数据库设计是尽量避免冗余，一般针对某一业务应用进行设计，比如一张简单的User表，记录用户名、密码等简单数据即可，符合业务应用，但是不符合分析。数据仓库在设计是有意引入冗余，依照分析需求，分析维度、分析指标进行设计。</p>
<p>数据库是为捕获数据而设计，数据仓库是为分析数据而设计。</p>
<p>以银行业务为例。数据库是事务系统的数据平台，客户在银行做的每笔交易都会写入数据库，被记录下来，这里，可以简单地理解为用数据库记账。数据仓库是分析系统的数据平台，它从事务系统获取数据，并做汇总、加工，为决策者提供决策的依据。比如，某银行某分行一个月发生多少交易，该分行当前存款余额是多少。如果存款又多，消费交易又多，那么该地区就有必要设立ATM了。 </p>
<p>显然，银行的交易量是巨大的，通常以百万甚至千万次来计算。事务系统是实时的，这就要求时效性，客户存一笔钱需要几十秒是无法忍受的，这就要求数据库只能存储很短一段时间的数据。而分析系统是事后的，它要提供关注时间段内所有的有效数据。这些数据是海量的，汇总计算起来也要慢一些，但是，只要能够提供有效的分析数据就达到目的了。 </p>
<p>数据仓库，是在数据库已经大量存在的情况下，为了进一步挖掘数据资源、为了决策需要而产生的，它决不是所谓的“大型数据库”。</p>
<h4 id="4-数据仓库分层架构"><a href="#4-数据仓库分层架构" class="headerlink" title="4.数据仓库分层架构"></a>4.数据仓库分层架构</h4><p>按照数据流入流出的过程，数据仓库架构可分为三层——<strong>源数据</strong>、<strong>数据仓库</strong>、<strong>数据应用。</strong>                            </p>
<p>数据仓库的数据来源于不同的源数据，并提供多样的数据应用，数据自下而上流入数据仓库后向上层开放应用，而数据仓库只是中间集成化数据管理的一个平台。</p>
<p>源数据层（ODS）：此层数据无任何更改，直接沿用外围系统数据结构和数据，不对外开放；为临时存储层，是接口数据的临时存储区域，为后一步的数据处理做准备。</p>
<p>数据仓库层（DW）：也称为细节层，DW层的数据应该是一致的、准确的、干净的数据，即对源系统数据进行了清洗（去除了杂质）后的数据。</p>
<p>数据应用层（DA或APP）：前端应用直接读取的数据源；根据报表、专题分析需求而计算生成的数据。</p>
<p>数据仓库从各数据源获取数据及在数据仓库内的数据转换和流动都可以认为是ETL（抽取Extra, 转化Transfer, 装载Load）的过程，ETL是数据仓库的流水线，也可以认为是数据仓库的血液，它维系着数据仓库中数据的新陈代谢，而数据仓库日常的管理和维护工作的大部分精力就是保持ETL的正常和稳定。</p>
<p>为什么要对数据仓库分层？</p>
<p>用空间换时间，通过大量的预处理来提升应用系统的用户体验（效率），因此数据仓库会存在大量冗余的数据；不分层的话，如果源业务系统的业务规则发生变化将会影响整个数据清洗过程，工作量巨大。</p>
<p>通过数据分层管理可以简化数据清洗的过程，因为把原来一步的工作分到了多个步骤去完成，相当于把一个复杂的工作拆成了多个简单的工作，把一个大的黑盒变成了一个白盒，每一层的处理逻辑都相对简单和容易理解，这样我们比较容易保证每一个步骤的正确性，当数据发生错误的时候，往往我们只需要局部调整某个步骤即可。</p>
<h3 id="2-Hive是什么"><a href="#2-Hive是什么" class="headerlink" title="2. Hive是什么"></a>2. Hive是什么</h3><h4 id="1-hive的概念"><a href="#1-hive的概念" class="headerlink" title="1 hive的概念"></a>1 hive的概念</h4><p>Hive是基于Hadoop的一个数据仓库工具，==可以将结构化的数据文件映射为一张数据库表==，并提供类SQL查询功能。其本质是将SQL转换为MapReduce的任务进行运算，底层由HDFS来提供数据的存储，说白了hive可以理解为一个将SQL转换为MapReduce的任务的工具，甚至更进一步可以说hive就是一个MapReduce的客户端</p>
<p><img src="/Users/dingchuangshi/Downloads/hive_day01_课前资料/hive_day01课程设计.assets/Snipaste_2019-07-10_23-23-31.png" alt=""></p>
<h4 id="2-Hive与数据库的区别"><a href="#2-Hive与数据库的区别" class="headerlink" title="2 Hive与数据库的区别"></a>2 Hive与数据库的区别</h4><p><img src="/Users/dingchuangshi/Downloads/hive_day01_课前资料/hive_day01课程设计.assets/2018040319335283.png" alt=""></p>
<ul>
<li>Hive 具有 SQL 数据库的外表，但应用场景完全不同。</li>
<li>==Hive 只适合用来做海量离线数据统计分析，也就是数据仓库==。</li>
</ul>
<h4 id="3-Hive的优缺点"><a href="#3-Hive的优缺点" class="headerlink" title="3 Hive的优缺点"></a>3 Hive的优缺点</h4><ul>
<li><p>==优点==</p>
<ul>
<li><p><strong>操作接口采用类SQL语法</strong>，提供快速开发的能力（简单、容易上手）。</p>
</li>
<li><p><strong>避免了去写MapReduce</strong>，减少开发人员的学习成本。</p>
</li>
<li><p><strong>Hive支持用户自定义函数</strong>，用户可以根据自己的需求来实现自己的函数。</p>
</li>
</ul>
</li>
<li><p>==缺点==</p>
<ul>
<li><strong>Hive 不支持记录级别的增删改操作</strong></li>
<li><strong>Hive 的查询延迟很严重</strong><ul>
<li>hadoop jar  xxxx.jar  xxx.class /input /output<ul>
<li>进行任务的划分，然后进行计算资源的申请</li>
<li>map 0%  reduce 0%</li>
<li>map 10%  reduce 0%</li>
</ul>
</li>
</ul>
</li>
<li><strong>Hive 不支持事务</strong></li>
</ul>
</li>
</ul>
<h4 id="4-Hive架构原理"><a href="#4-Hive架构原理" class="headerlink" title="4 Hive架构原理"></a>4 Hive架构原理</h4><p><img src="assets/2019-07-11_11-08-35.png" alt=""></p>
<ul>
<li>1、用户接口：Client</li>
</ul>
<ul>
<li>CLI（hive shell）、JDBC/ODBC(java访问hive)、WEBUI（浏览器访问hive）</li>
</ul>
<ul>
<li><p>2、元数据：Metastore</p>
<ul>
<li><p>元数据包括：表名、表所属的数据库（默认是default）、表的拥有者、列/分区字段、表的类型（是否是外部表）、表的数据所在目录等；</p>
<ul>
<li>默认存储在自带的derby数据库中，==推荐使用MySQL存储Metastore==</li>
</ul>
</li>
</ul>
</li>
<li><p>3、Hadoop集群</p>
<ul>
<li>使用HDFS进行存储，使用MapReduce进行计算。</li>
</ul>
</li>
<li><p>4、Driver：驱动器</p>
<ul>
<li>解析器（SQL Parser） <ul>
<li>将SQL字符串转换成抽象语法树AST</li>
<li>对AST进行语法分析，比如表是否存在、字段是否存在、SQL语义是否有误</li>
</ul>
</li>
<li>编译器（Physical Plan）：将AST编译生成逻辑执行计划</li>
<li>优化器（Query Optimizer）：对逻辑执行计划进行优化</li>
<li>执行器（Execution）：把逻辑执行计划转换成可以运行的物理计划。对于Hive来说默认就是mapreduce任务</li>
</ul>
</li>
</ul>
<p><img src="assets/hive1.png" alt="hive1"></p>
<h3 id="3-Hive的安装部署"><a href="#3-Hive的安装部署" class="headerlink" title="3. Hive的安装部署"></a>3. Hive的安装部署</h3><p>​    注意hive就是==一个构建数据仓库的工具==，只需要在==一台服务器上==安装就可以了，不需要在多台服务器上安装。 </p>
<ul>
<li><p>1、提前先安装好mysql服务和hadoop集群</p>
<ul>
<li>详细见<a href="https://www.cnblogs.com/brianzhu/p/8575243.html" target="_blank" rel="noopener">https://www.cnblogs.com/brianzhu/p/8575243.html</a></li>
</ul>
</li>
<li><p>2、下载hive的安装包</p>
<ul>
<li><a href="http://archive.cloudera.com/cdh5/cdh/5/hive-1.1.0-cdh5.14.2.tar.gz" target="_blank" rel="noopener">http://archive.cloudera.com/cdh5/cdh/5/hive-1.1.0-cdh5.14.2.tar.gz</a></li>
</ul>
</li>
<li><p>3、规划安装目录</p>
<ul>
<li>/kkb/install</li>
</ul>
</li>
<li><p>4、上传安装包到node03服务器中的/kkb/soft路径下</p>
</li>
<li><p>5、解压安装包到指定的规划目录</p>
<ul>
<li><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/soft/</span><br><span class="line">tar -zxf hive<span class="number">-1.1</span><span class="number">.0</span>-cdh5<span class="number">.14</span><span class="number">.2</span>.tar.gz -C /kkb/install/</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>6、修改配置文件</p>
<ul>
<li><p>进入到Hive的安装目录下的conf文件夹中</p>
<ul>
<li><p>cd /kkb/install/hive-1.1.0-cdh5.14.2/conf/</p>
</li>
<li><p>mv  hive-env.sh.template hive-env.sh</p>
</li>
<li><p>vim hive-env.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">配置HADOOP_HOME路径</span></span><br><span class="line">export HADOOP_HOME=/kkb/install/hadoop-2.6.0-cdh5.14.2/</span><br><span class="line"><span class="meta">#</span><span class="bash">配置HIVE_CONF_DIR路径</span></span><br><span class="line">export HIVE_CONF_DIR=/kkb/install/hive-1.1.0-cdh5.14.2/conf</span><br></pre></td></tr></table></figure>
</li>
<li><p>vim hive-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml-stylesheet type=<span class="string">"text/xsl"</span> href=<span class="string">"configuration.xsl"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://node03:3306/hive?createDatabaseIfNotExist=true&amp;amp;characterEncoding=latin1&amp;amp;useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.current.db<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.header<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.bind.host<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>node03.kaikeba.com<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改hive的日志配置文件路径，便于我们排查hive出现的错误问题</p>
<p>​    node03执行以下命令，定义hive的日志文件存放路径</p>
<p>​    </p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /kkb/install/hive<span class="number">-1.1</span><span class="number">.0</span>-cdh5<span class="number">.14</span><span class="number">.2</span>/logs/</span><br><span class="line">cd /kkb/install/hive<span class="number">-1.1</span><span class="number">.0</span>-cdh5<span class="number">.14</span><span class="number">.2</span>/conf/</span><br><span class="line">mv hive-log4j.properties.template hive-log4j.properties</span><br><span class="line">vim hive-log4j.properties</span><br><span class="line"></span><br><span class="line">#更改以下内容，设置我们的日志文件存放的路径</span><br><span class="line">hive.log.dir=/kkb/install/hive<span class="number">-1.1</span><span class="number">.0</span>-cdh5<span class="number">.14</span><span class="number">.2</span>/logs/</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>* ps: ==需要将mysql的驱动包上传到hive的lib目录下==

  * 例如 mysql-connector-java-5.1.38.jar
</code></pre><h3 id="4-hive的交互方式"><a href="#4-hive的交互方式" class="headerlink" title="4. hive的交互方式"></a>4. hive的交互方式</h3><ul>
<li>==先启动hadoop集群和mysql服务==</li>
</ul>
<h4 id="1-Hive交互shell"><a href="#1-Hive交互shell" class="headerlink" title="1 Hive交互shell"></a>1 Hive交互shell</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hive-1.1.0-cdh5.14.2</span><br><span class="line">bin/hive</span><br></pre></td></tr></table></figure>
<h4 id="2-Hive-JDBC服务"><a href="#2-Hive-JDBC服务" class="headerlink" title="2 Hive JDBC服务"></a>2 Hive JDBC服务</h4><ul>
<li><p>启动hiveserver2服务</p>
<ul>
<li><p>前台启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hive-1.1.0-cdh5.14.2</span><br><span class="line">bin/hive --service hiveserver2</span><br></pre></td></tr></table></figure>
</li>
<li><p>后台启动</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hive-1.1.0-cdh5.14.2</span><br><span class="line">nohup  bin/hive --service hiveserver2  &amp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>beeline连接hiveserver2</p>
<p>重新开启一个会话窗口，然后使用beeline连接hive</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hive-1.1.0-cdh5.14.2</span><br><span class="line">bin/beeline</span><br><span class="line"><span class="meta">beeline&gt;</span><span class="bash"> !connect jdbc:hive2://node03:10000</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-Hive的命令"><a href="#3-Hive的命令" class="headerlink" title="3  Hive的命令"></a>3  Hive的命令</h4><ul>
<li>hive  ==-e== sql语句<ul>
<li>使用 –e  参数来直接执行hql的语句</li>
</ul>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hive<span class="number">-1.1</span><span class="number">.0</span>-cdh5<span class="number">.14</span><span class="number">.2</span>/</span><br><span class="line">bin/hive -e <span class="string">"show databases"</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>hive  ==-f==  sql文件</p>
<ul>
<li><p>使用 –f  参数执行包含hql语句的文件</p>
</li>
<li><p>node03执行以下命令准备hive执行脚本</p>
</li>
<li><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/<span class="keyword">install</span>/</span><br><span class="line">vim hive.sql</span><br><span class="line"></span><br><span class="line">文件内容如下</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> myhive;</span><br><span class="line"></span><br><span class="line">通过以下命令来执行我们的hive脚本</span><br><span class="line">cd /kkb/<span class="keyword">install</span>/hive<span class="number">-1.1</span><span class="number">.0</span>-cdh5<span class="number">.14</span><span class="number">.2</span>/</span><br><span class="line"><span class="keyword">bin</span>/hive -f /kkb/<span class="keyword">install</span>/hive.sql</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="5、Hive的数据类型"><a href="#5、Hive的数据类型" class="headerlink" title="5、Hive的数据类型"></a>5、Hive的数据类型</h3><h4 id="1-基本数据类型"><a href="#1-基本数据类型" class="headerlink" title="1 基本数据类型"></a>1 基本数据类型</h4><table>
<thead>
<tr>
<th style="text-align:center">类型名称</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">举例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">boolean</td>
<td style="text-align:center">true/false</td>
<td style="text-align:center">true</td>
</tr>
<tr>
<td style="text-align:center">tinyint</td>
<td style="text-align:center">1字节的有符号整数</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">smallint</td>
<td style="text-align:center">2字节的有符号整数</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">==<strong>int</strong>==</td>
<td style="text-align:center">4字节的有符号整数</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center"><strong>==bigint==</strong></td>
<td style="text-align:center">8字节的有符号整数</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">float</td>
<td style="text-align:center">4字节单精度浮点数</td>
<td style="text-align:center">1.0</td>
</tr>
<tr>
<td style="text-align:center"><strong>==double==</strong></td>
<td style="text-align:center">8字节单精度浮点数</td>
<td style="text-align:center">1.0</td>
</tr>
<tr>
<td style="text-align:center"><strong>==string==</strong></td>
<td style="text-align:center">字符串(不设长度)</td>
<td style="text-align:center">“abc”</td>
</tr>
<tr>
<td style="text-align:center">varchar</td>
<td style="text-align:center">字符串（1-65355长度，超长截断）</td>
<td style="text-align:center">“abc”</td>
</tr>
<tr>
<td style="text-align:center">timestamp</td>
<td style="text-align:center">时间戳</td>
<td style="text-align:center">1563157873</td>
</tr>
<tr>
<td style="text-align:center">date</td>
<td style="text-align:center">日期</td>
<td style="text-align:center">20190715</td>
</tr>
</tbody>
</table>
<h4 id="2-复合数据类型"><a href="#2-复合数据类型" class="headerlink" title="2 复合数据类型"></a>2 复合数据类型</h4><table>
<thead>
<tr>
<th style="text-align:center">类型名称</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">举例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">array</td>
<td style="text-align:center">一组有序的字段，字段类型必须相同 array(元素1，元素2)</td>
<td style="text-align:center">Array（1,2,3）</td>
</tr>
<tr>
<td style="text-align:center">map</td>
<td style="text-align:center">一组无序的键值对 map(k1,v1,k2,v2)</td>
<td style="text-align:center">Map(‘a’,1,’b’,2)</td>
</tr>
<tr>
<td style="text-align:center">struct</td>
<td style="text-align:center">一组命名的字段，字段类型可以不同 struct(元素1，元素2)</td>
<td style="text-align:center">Struct(‘a’,1,2,0)</td>
</tr>
</tbody>
</table>
<ul>
<li><p>array字段的元素访问方式：</p>
<ul>
<li><p>下标获取元素，下标从0开始</p>
<ul>
<li><p>获取第一个元素</p>
<ul>
<li>array[0]</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>map字段的元素访问方式</p>
<ul>
<li><p>通过键获取值</p>
<ul>
<li><p>获取a这个key对应的value</p>
<ul>
<li>map[‘a’]</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>struct字段的元素获取方式<ul>
<li>定义一个字段c的类型为struct{a int;b string}<ul>
<li>获取a和b的值<ul>
<li>使用c.a 和c.b 获取其中的元素值<ul>
<li>这里可以把这种类型看成是一个对象</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> complex(</span><br><span class="line">         col1 <span class="built_in">array</span>&lt;<span class="built_in">int</span>&gt;,</span><br><span class="line">         col2 <span class="keyword">map</span>&lt;<span class="keyword">string</span>,<span class="built_in">int</span>&gt;,</span><br><span class="line">         col3 <span class="keyword">struct</span>&lt;a:<span class="keyword">string</span>,b:<span class="built_in">int</span>,c:<span class="keyword">double</span>&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="6、Hive的DDL操作"><a href="#6、Hive的DDL操作" class="headerlink" title="6、Hive的DDL操作"></a>6、Hive的DDL操作</h3><h4 id="1-hive的数据库DDL操作"><a href="#1-hive的数据库DDL操作" class="headerlink" title="1 hive的数据库DDL操作"></a>1 hive的数据库DDL操作</h4><h5 id="1、创建数据库"><a href="#1、创建数据库" class="headerlink" title="1、创建数据库"></a>1、创建数据库</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive &gt; create database db_hive;</span><br><span class="line"># 或者</span><br><span class="line">hive &gt; create database if not exists db_hive;</span><br></pre></td></tr></table></figure>
<ul>
<li>数据库在HDFS上的默认存储路径是==/user/hive/warehouse/*.db==</li>
</ul>
<h5 id="2、显示所有数据库"><a href="#2、显示所有数据库" class="headerlink" title="2、显示所有数据库"></a>2、显示所有数据库</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; show databases;</span><br></pre></td></tr></table></figure>
<h5 id="3、查询数据库"><a href="#3、查询数据库" class="headerlink" title="3、查询数据库"></a>3、查询数据库</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; show databases like 'db_hive*';</span><br></pre></td></tr></table></figure>
<h5 id="4、查看数据库详情"><a href="#4、查看数据库详情" class="headerlink" title="4、查看数据库详情"></a>4、查看数据库详情</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; desc database db_hive;</span><br></pre></td></tr></table></figure>
<h5 id="5、显示数据库详细信息"><a href="#5、显示数据库详细信息" class="headerlink" title="5、显示数据库详细信息"></a>5、显示数据库详细信息</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; desc database extended db_hive;</span><br></pre></td></tr></table></figure>
<h5 id="6、切换当前数据库"><a href="#6、切换当前数据库" class="headerlink" title="6、切换当前数据库"></a>6、切换当前数据库</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive &gt; use db_hive;</span><br></pre></td></tr></table></figure>
<h5 id="7、删除数据库"><a href="#7、删除数据库" class="headerlink" title="7、删除数据库"></a>7、删除数据库</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#删除为空的数据库</span><br><span class="line">hive&gt; drop database db_hive;</span><br><span class="line"></span><br><span class="line">#如果删除的数据库不存在，最好采用if exists 判断数据库是否存在</span><br><span class="line">hive&gt; drop database if exists db_hive;</span><br><span class="line"></span><br><span class="line">#如果数据库中有表存在，这里需要使用cascade强制删除数据库</span><br><span class="line">hive&gt; drop database if exists db_hive cascade;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-hive的表DDL操作"><a href="#6-2-hive的表DDL操作" class="headerlink" title="6.2 hive的表DDL操作"></a>6.2 hive的表DDL操作</h4><h5 id="1-、建表语法介绍"><a href="#1-、建表语法介绍" class="headerlink" title="1 、建表语法介绍"></a>1 、建表语法介绍</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] table_name </span><br><span class="line">[(col_name data_type [<span class="keyword">COMMENT</span> col_comment], ...)] </span><br><span class="line">[<span class="keyword">COMMENT</span> table_comment] </span><br><span class="line">[PARTITIONED <span class="keyword">BY</span> (col_name data_type [<span class="keyword">COMMENT</span> col_comment], ...)] 分区</span><br><span class="line">[CLUSTERED <span class="keyword">BY</span> (col_name, col_name, ...) 分桶</span><br><span class="line">[SORTED <span class="keyword">BY</span> (col_name [<span class="keyword">ASC</span>|<span class="keyword">DESC</span>], ...)] <span class="keyword">INTO</span> num_buckets BUCKETS] </span><br><span class="line">[<span class="keyword">ROW</span> <span class="keyword">FORMAT</span> row_format]  <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> “分隔符”</span><br><span class="line">[<span class="keyword">STORED</span> <span class="keyword">AS</span> file_format] </span><br><span class="line">[LOCATION hdfs_path]</span><br></pre></td></tr></table></figure>
<p>官网地址：<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL</a></p>
<h5 id="2-、字段解释说明"><a href="#2-、字段解释说明" class="headerlink" title="2 、字段解释说明"></a>2 、字段解释说明</h5><ul>
<li><p>create table </p>
<ul>
<li>创建一个指定名字的表</li>
</ul>
</li>
<li><p>EXTERNAL  </p>
<ul>
<li>创建一个外部表，在建表的同时指定一个指向实际数据的路径（LOCATION），指定表的数据保存在哪里</li>
</ul>
</li>
<li><p>COMMENT</p>
<ul>
<li>为表和列添加注释</li>
</ul>
</li>
<li><p>PARTITIONED BY</p>
<ul>
<li>创建分区表</li>
</ul>
</li>
<li><p>CLUSTERED BY</p>
<ul>
<li>创建分桶表</li>
</ul>
</li>
<li><p>SORTED BY</p>
<ul>
<li>按照字段排序（一般不常用）</li>
</ul>
</li>
<li><p>ROW FORMAT</p>
<ul>
<li><p>指定每一行中字段的分隔符</p>
<ul>
<li>row format delimited fields terminated by ‘\t’</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>STORED AS<ul>
<li>指定存储文件类型<ul>
<li>常用的存储文件类型：SEQUENCEFILE（二进制序列文件）、TEXTFILE（文本）、RCFILE（列式存储格式文件）</li>
<li>如果文件数据是纯文本，可以使用STORED AS TEXTFILE。如果数据需要压缩，使用 STORED AS SEQUENCEFILE</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>LOCATION </p>
<ul>
<li>指定表在HDFS上的存储位置。</li>
</ul>
</li>
</ul>
<h5 id="3、-创建内部表"><a href="#3、-创建内部表" class="headerlink" title="3、 创建内部表"></a>3、 创建内部表</h5><ul>
<li>1、==直接建表==<ul>
<li>使用标准的建表语句</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> myhive;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu(<span class="keyword">id</span> <span class="built_in">int</span>,<span class="keyword">name</span> <span class="keyword">string</span>);</span><br><span class="line"></span><br><span class="line">可以通过<span class="keyword">insert</span>  <span class="keyword">into</span>  向hive表当中插入数据，但是不建议工作当中这么做</span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> stu(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">"zhangsan"</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span>  stu;</span><br></pre></td></tr></table></figure>
<ul>
<li>2、==查询建表法==<ul>
<li>通过AS 查询语句完成建表：将子查询的结果存在新表里，有数据 </li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> myhive.stu1 <span class="keyword">as</span> <span class="keyword">select</span> <span class="keyword">id</span>, <span class="keyword">name</span> <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>
<ul>
<li>3、==like建表法==<ul>
<li>根据已经存在的表结构创建表</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> myhive.stu2 <span class="keyword">like</span> stu;</span><br></pre></td></tr></table></figure>
<ul>
<li>4、查询表的类型</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive &gt; desc formatted myhive.stu;</span><br></pre></td></tr></table></figure>
<p><img src="/Users/dingchuangshi/Downloads/hive_day01_课前资料/hive_day01课程设计.assets/2019-07-12_14-33-00-1563156555810.png" alt="2019-07-12_14-33-00"></p>
<p>创建内部表并指定字段之间的分隔符，指定文件的存储格式，以及数据存放的位置</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span>  <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> myhive.stu3(<span class="keyword">id</span> <span class="built_in">int</span> ,<span class="keyword">name</span> <span class="keyword">string</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span> <span class="keyword">stored</span> <span class="keyword">as</span> textfile location       <span class="string">'/user/stu2'</span>;</span><br></pre></td></tr></table></figure>
<h5 id="4、-创建外部表"><a href="#4、-创建外部表" class="headerlink" title="4、 创建外部表"></a>4、 创建外部表</h5><p>外部表因为是指定其他的hdfs路径的数据加载到表当中来，所以hive表会认为自己不完全独占这份数据，所以删除hive表的时候，数据仍然存放在hdfs当中，不会删掉</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">external</span> <span class="keyword">table</span> myhive.teacher (t_id <span class="keyword">string</span>,t_name <span class="keyword">string</span>) <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>创建外部表的时候需要加上<strong>==external==</strong> 关键字</li>
<li>location字段可以指定，也可以不指定<ul>
<li>指定就是数据存放的具体目录</li>
<li>不指定就是使用默认目录 ==/user/hive/warehouse==</li>
</ul>
</li>
</ul>
<p><img src="assets/2019-07-12_14-51-53.png" alt="2019-07-12_14-51-53"></p>
<p>向外部表当中加载数据：</p>
<p>我们前面已经看到过通过insert的方式向内部表当中插入数据，外部表也可以通过insert的方式进行插入数据，只不过insert的方式，我们一般都不推荐，实际工作当中我们都是使用load的方式来加载数据到内部表或者外部表</p>
<p>load数据可以从本地文件系统加载或者也可以从hdfs上面的数据进行加载</p>
<ul>
<li><p>从本地文件系统加载数据到teacher表当中去，==将我们附件当汇总的数据资料都上传到node03服务器的/kkb/install/hivedatas路径下面去==</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /kkb/<span class="keyword">install</span>/hivedatas</span><br><span class="line">#将数据都上传到/kkb/<span class="keyword">install</span>/hivedatas路径下，然后在hive客户端下执行以下操作</span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/teacher.csv'</span> <span class="keyword">into</span> <span class="keyword">table</span> myhive.teacher;</span><br></pre></td></tr></table></figure>
</li>
<li><p>从hdfs上面加载文件到teacher表里面去(将teacher.csv文件上传到==hdfs的/kkb/hdfsload/hivedatas==路径下)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hivedatas</span><br><span class="line">hdfs dfs -mkdir -p /kkb/hdfsload/hivedatas</span><br><span class="line">hdfs dfs -put teacher.csv /kkb/hdfsload/hivedatas</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在hive的客户端当中执行</span></span><br><span class="line">load  data  inpath  '/kkb/hdfsload/hivedatas'  overwrite into table myhive.teacher;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="5、-内部表与外部表的互相转换"><a href="#5、-内部表与外部表的互相转换" class="headerlink" title="5、 内部表与外部表的互相转换"></a>5、 内部表与外部表的互相转换</h5><ul>
<li>1、内部表转换为外部表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#将stu内部表改为外部表</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">set</span> tblproperties(<span class="string">'EXTERNAL'</span>=<span class="string">'TRUE'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>2、外部表转换为内部表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#把emp外部表改为内部表</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> teacher <span class="keyword">set</span> tblproperties(<span class="string">'EXTERNAL'</span>=<span class="string">'FALSE'</span>);</span><br></pre></td></tr></table></figure>
<h5 id="6、-内部表与外部表的区别"><a href="#6、-内部表与外部表的区别" class="headerlink" title="6、 内部表与外部表的区别"></a>6、 内部表与外部表的区别</h5><ul>
<li><p>1、建表语法的区别</p>
<ul>
<li>外部表在创建的时候需要加上==external==关键字</li>
</ul>
</li>
<li><p>2、删除表之后的区别</p>
<ul>
<li>内部表删除后，表的元数据和真实数据都被删除了</li>
</ul>
</li>
<li>外部表删除后，仅仅只是把该表的元数据删除了，真实数据还在，后期还是可以恢复出来</li>
</ul>
<h5 id="7、内部表与外部表的使用时机"><a href="#7、内部表与外部表的使用时机" class="headerlink" title="7、内部表与外部表的使用时机"></a>7、内部表与外部表的使用时机</h5><p>​    内部表由于删除表的时候会同步删除HDFS的数据文件，所以确定如果一个表仅仅是你独占使用，其他人不适用的时候就可以创建内部表，如果一个表的文件数据，其他人也要使用，那么就创建外部表</p>
<p>一般外部表都是用在数据仓库的ODS层</p>
<p>内部表都是用在数据仓库的DW层</p>
<h5 id="8、hive的分区表"><a href="#8、hive的分区表" class="headerlink" title="8、hive的分区表"></a>8、hive的分区表</h5><p>如果hive当中所有的数据都存入到一个文件夹下面，那么在使用MR计算程序的时候，读取一整个目录下面的所有文件来进行计算，就会变得特别慢，因为数据量太大了，实际工作当中一般都是计算前一天的数据，所以我们只需要将前一天的数据挑出来放到一个文件夹下面即可，专门去计算前一天的数据。这样就可以使用hive当中的分区表，通过分文件夹的形式，将每一天的数据都分成为一个文件夹，然后我们计算数据的时候，通过指定前一天的文件夹即可只计算前一天的数据。</p>
<p>在大数据中，最常用的一种思想就是分治，我们可以把大的文件切割划分成一个个的小的文件，这样每次操作一个小的文件就会很容易了，同样的道理，在hive当中也是支持这种思想的，就是我们可以把大的数据，按照每天，或者每小时进行切分成一个个的小的文件，这样去操作小的文件就会容易得多了</p>
<p><img src="assets/2019-07-15_11-35-37.png" alt="2019-07-15_11-35-37"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在文件系统上建立文件夹，把表的数据放在不同文件夹下面，加快查询速度。</span><br></pre></td></tr></table></figure>
<p>创建分区表语法</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; <span class="built_in">create</span> <span class="built_in">table</span> score(s_id <span class="built_in">string</span>,c_id <span class="built_in">string</span>, s_score int) partitioned by (month <span class="built_in">string</span>) row <span class="built_in">format</span> delimited fields terminated by <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>
<p>创建一个表带多个分区</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create table score2 (s_id <span class="built_in">string</span>,c_id <span class="built_in">string</span>, s_score int) partitioned <span class="keyword">by</span> (<span class="built_in">year</span> <span class="built_in">string</span>,<span class="built_in">month</span> <span class="built_in">string</span>,<span class="built_in">day</span> <span class="built_in">string</span>) row format delimited fields terminated <span class="keyword">by</span> '\t';</span><br></pre></td></tr></table></figure>
<p> 加载数据到分区表当中去</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt;load data  local inpath <span class="string">'/kkb/install/hivedatas/score.csv'</span> into <span class="keyword">table</span> score <span class="comment">partition  (month=</span><span class="comment">'201806'</span><span class="comment">)</span>;</span><br></pre></td></tr></table></figure>
<p>加载数据到多分区表当中去</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; load data local inpath <span class="string">'/kkb/install/hivedatas/score.csv'</span> into <span class="keyword">table</span> score2 <span class="comment">partition(year=</span><span class="comment">'2018'</span><span class="comment">,month=</span><span class="comment">'06'</span><span class="comment">,day=</span><span class="comment">'01'</span><span class="comment">)</span>;</span><br></pre></td></tr></table></figure>
<p>查看分区</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (<span class="name">myhive</span>)&gt; show  partitions  score<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>添加一个分区</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; alter table score <span class="builtin-name">add</span> partition(<span class="attribute">month</span>=<span class="string">'201805'</span>);</span><br></pre></td></tr></table></figure>
<p>同时添加多个分区</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (<span class="name">myhive</span>)&gt; alter table score add partition(<span class="name">month=</span>'<span class="number">201804</span>') partition(<span class="name">month</span> = '<span class="number">201803</span>')<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>注意：添加分区之后就可以在hdfs文件系统当中看到表下面多了一个文件夹</p>
<p>删除分区</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; alter <span class="keyword">table</span> score <span class="comment">drop partition(month =</span> <span class="comment">'201806'</span><span class="comment">)</span>;</span><br></pre></td></tr></table></figure>
<p>外部分区表综合练习：</p>
<p>需求描述：现在有一个文件score.csv文件，里面有三个字段，分别是s_id string, c_id string,s_score int，字段都是使用 \t进行分割，存放在集群的这个目录下/scoredatas/day=20180607，这个文件每天都会生成，存放到对应的日期文件夹下面去，文件别人也需要公用，不能移动。需求，创建hive对应的表，并将数据加载到表中，进行数据统计分析，且删除表之后，数据不能删除</p>
<p>需求实现:</p>
<p>数据准备:</p>
<p>node03执行以下命令，将数据上传到hdfs上面去</p>
<p>将我们的score.csv上传到node03服务器的/kkb/install/hivedatas目录下，然后将score.csv文件上传到/kkb/install/hivedatas目录下去</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/kkb/i</span>nstall<span class="regexp">/hivedatas/</span></span><br><span class="line">hdfs dfs -mkdir -p <span class="regexp">/scoredatas/</span>day=<span class="number">20180607</span></span><br><span class="line">hdfs dfs -put score.csv <span class="regexp">/scoredatas/</span>day=<span class="number">20180607</span><span class="regexp">/</span></span><br></pre></td></tr></table></figure>
<p>创建外部分区表，并指定文件数据存放目录</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; <span class="built_in">create</span> external <span class="built_in">table</span> score4(s_id <span class="built_in">string</span>, c_id <span class="built_in">string</span>,s_score int) partitioned by (day <span class="built_in">string</span>) row <span class="built_in">format</span> delimited fields terminated by <span class="string">'\t'</span> location <span class="string">'/scoredatas'</span>;</span><br></pre></td></tr></table></figure>
<p>进行表的修复,说白了就是建立我们表与我们数据文件之间的一个关系映射</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; msck  repair   <span class="keyword">table</span>  score4;</span><br></pre></td></tr></table></figure>
<p>修复成功之后即可看到数据已经全部加载到表当中去了</p>
<h5 id="9、hive的分桶表"><a href="#9、hive的分桶表" class="headerlink" title="9、hive的分桶表"></a>9、hive的分桶表</h5><p><img src="assets/2019-07-16_17-01-51.png" alt=""></p>
<ul>
<li><p>分桶是相对分区进行更细粒度的划分。</p>
</li>
<li><p>==分桶将整个数据内容安装某列属性值取hash值进行区分，具有相同hash值的数据进入到同一个文件中==</p>
<ul>
<li>比如按照name属性分为3个桶，就是对name属性值的hash值对3取摸，按照取模结果对数据分桶。<ul>
<li>取模结果为==0==的数据记录存放到一个文件</li>
<li>取模结果为==1==的数据记录存放到一个文件</li>
<li>取模结果为==2==的数据记录存放到一个文件</li>
<li>取模结果为==3==的数据记录存放到一个文件</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>==作用==</strong></p>
<ul>
<li>1、取样sampling更高效。没有分区的话需要扫描整个数据集。</li>
<li>2、提升某些查询操作效率，例如map side join</li>
</ul>
</li>
<li><p>案例演示</p>
<ul>
<li><p>1、创建分桶表</p>
<ul>
<li>在创建分桶表之前要执行的命令<ul>
<li>==set hive.enforce.bucketing=true;==  开启对分桶表的支持</li>
<li>==set mapreduce.job.reduces=4;==      设置与桶相同的reduce个数（默认只有一个reduce）</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 进入hive客户端然后执行以下命令</span><br><span class="line"><span class="keyword">use</span> myhive;</span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces=<span class="number">4</span>;  </span><br><span class="line"><span class="keyword">set</span> hive.enforce.bucketing=<span class="literal">true</span>; </span><br><span class="line"><span class="comment">--分桶表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> myhive.user_buckets_demo(<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">name</span> <span class="keyword">string</span>)</span><br><span class="line">clustered <span class="keyword">by</span>(<span class="keyword">id</span>) </span><br><span class="line"><span class="keyword">into</span> <span class="number">4</span> buckets </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--普通表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user_demo(<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">name</span> <span class="keyword">string</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>2、准备数据文件 buckets.txt</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">#在linux当中执行以下命令</span></span><br><span class="line"><span class="attr">cd /kkb/install/hivedatas/</span></span><br><span class="line"><span class="attr">vim user_bucket.txt</span></span><br><span class="line"><span class="attr"></span></span><br><span class="line"><span class="attr">1</span>	laowa<span class="symbol">ng1</span></span><br><span class="line"><span class="number">2</span>	laowa<span class="symbol">ng2</span></span><br><span class="line"><span class="number">3</span>	laowa<span class="symbol">ng3</span></span><br><span class="line"><span class="number">4</span>	laowa<span class="symbol">ng4</span></span><br><span class="line"><span class="number">5</span>	laowa<span class="symbol">ng5</span></span><br><span class="line"><span class="number">6</span>	laowa<span class="symbol">ng6</span></span><br><span class="line"><span class="number">7</span>	laowa<span class="symbol">ng7</span></span><br><span class="line"><span class="number">8</span>	laowa<span class="symbol">ng8</span></span><br><span class="line"><span class="number">9</span>	laowa<span class="symbol">ng9</span></span><br><span class="line"><span class="number">10</span>	laowa<span class="symbol">ng10</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 3、加载数据到普通表 user_demo 中</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/user_bucket.txt'</span>  overwrite <span class="keyword">into</span> <span class="keyword">table</span> user_demo;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  #在hive客户端当中加载数据</span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/user_bucket.txt'</span> <span class="keyword">into</span> <span class="keyword">table</span> user_demo;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>4、加载数据到桶表user_buckets_demo中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> user_buckets_demo <span class="keyword">select</span> * <span class="keyword">from</span> user_demo;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>5、hdfs上查看表的数据目录</p>
<p><img src="assets/2019-07-16_16-30-09.png" alt=""></p>
</li>
</ul>
<ul>
<li>6、抽样查询桶表的数据<ul>
<li>tablesample抽样语句，语法：tablesample(bucket  x  out  of  y)<ul>
<li>x表示从第几个桶开始取数据</li>
<li>y表示桶数的倍数，一共需要从 ==桶数/y==  个桶中取数据</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> user_buckets_demo tablesample(bucket <span class="number">1</span> <span class="keyword">out</span> <span class="keyword">of</span> <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需要的总桶数=4/2=2个</span></span><br><span class="line"><span class="comment">-- 先从第1个桶中取出数据</span></span><br><span class="line"><span class="comment">-- 再从第1+2=3个桶中取出数据</span></span><br></pre></td></tr></table></figure>
<h3 id="7、Hive修改表结构"><a href="#7、Hive修改表结构" class="headerlink" title="7、Hive修改表结构"></a>7、Hive修改表结构</h3><p>修改表名称语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span>  old_table_name  <span class="keyword">rename</span> <span class="keyword">to</span>  new_table_name;</span><br></pre></td></tr></table></figure>
<h4 id="7-1-修改表的名称"><a href="#7-1-修改表的名称" class="headerlink" title="7.1 修改表的名称"></a>7.1 修改表的名称</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; alter table stu3 rename to stu4;</span><br></pre></td></tr></table></figure>
<h4 id="7-2-表的结构信息"><a href="#7-2-表的结构信息" class="headerlink" title="7.2 表的结构信息"></a>7.2 表的结构信息</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; desc stu4;</span><br><span class="line"></span><br><span class="line">hive&gt; desc formatted stu4;</span><br></pre></td></tr></table></figure>
<h4 id="7-3-增加-修改-替换列信息"><a href="#7-3-增加-修改-替换列信息" class="headerlink" title="7.3 增加/修改/替换列信息"></a>7.3 增加/修改/替换列信息</h4><ul>
<li>增加列</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; alter table stu4 add columns(address string);</span><br></pre></td></tr></table></figure>
<ul>
<li>修改列</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; alter table stu4 change column address address_id int;</span><br></pre></td></tr></table></figure>
<h3 id="8-Hive数据导入"><a href="#8-Hive数据导入" class="headerlink" title="8. Hive数据导入"></a>8. Hive数据导入</h3><h4 id="8-1、直接向表中插入数据（强烈不推荐使用）"><a href="#8-1、直接向表中插入数据（强烈不推荐使用）" class="headerlink" title="8.1、直接向表中插入数据（强烈不推荐使用）"></a>8.1、直接向表中插入数据（强烈不推荐使用）</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create table score3 like score;</span><br><span class="line">hive (myhive)&gt; insert into table score3 partition(month ='201807') values ('001','002','100');</span><br></pre></td></tr></table></figure>
<h4 id="8-2、通过load方式加载数据（必须掌握）"><a href="#8-2、通过load方式加载数据（必须掌握）" class="headerlink" title="8.2、通过load方式加载数据（必须掌握）"></a>8.2、通过load方式加载数据（必须掌握）</h4><p>语法：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; load data [local] inpath 'dataPath' overwrite | into table student [partition (partcol1=val1,…)];</span><br></pre></td></tr></table></figure>
<p>通过load方式加载数据</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; load data local inpath '/kkb/install/hivedatas/score.csv' overwrite into table score3 partition(month='201806');</span><br></pre></td></tr></table></figure>
<h4 id="8-3、通过查询方式加载数据（必须掌握）"><a href="#8-3、通过查询方式加载数据（必须掌握）" class="headerlink" title="8.3、通过查询方式加载数据（必须掌握）"></a>8.3、通过查询方式加载数据（必须掌握）</h4><p>通过查询方式加载数据</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create table score5 like score;</span><br><span class="line">hive (myhive)&gt; insert overwrite table score5 partition(month = '201806') select s_id,c_id,s_score from score;</span><br></pre></td></tr></table></figure>
<h4 id="8-4、查询语句中创建表并加载数据（as-select）"><a href="#8-4、查询语句中创建表并加载数据（as-select）" class="headerlink" title="8.4、查询语句中创建表并加载数据（as select）"></a>8.4、查询语句中创建表并加载数据（as select）</h4><p>将查询的结果保存到一张表当中去</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; <span class="keyword">create</span> table score6 <span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>
<h4 id="8-5、创建表时通过location指定加载数据路径"><a href="#8-5、创建表时通过location指定加载数据路径" class="headerlink" title="8.5、创建表时通过location指定加载数据路径"></a>8.5、创建表时通过location指定加载数据路径</h4><p>1）创建表，并指定在hdfs上的位置</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create external table score7 (s_id string,c_id string,s_score int) row format delimited fields terminated by '\t' location '/myscore7';</span><br></pre></td></tr></table></figure>
<p>2）上传数据到hdfs上，我们也可以直接在hive客户端下面通过dfs命令来进行操作hdfs的数据</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive <span class="params">(myhive)</span>&gt;  dfs -mkdir -p <span class="string">/myscore7</span>;</span><br><span class="line">hive <span class="params">(myhive)</span>&gt; dfs -put <span class="string">/kkb/install/hivedatas/score.csv</span> <span class="string">/myscore7</span>;</span><br></pre></td></tr></table></figure>
<p>3）查询数据</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; <span class="keyword">select</span> * <span class="keyword">from</span> score7;</span><br></pre></td></tr></table></figure>
<h4 id="8-6、export导出与import-导入-hive表数据（内部表操作）"><a href="#8-6、export导出与import-导入-hive表数据（内部表操作）" class="headerlink" title="8.6、export导出与import 导入 hive表数据（内部表操作）"></a>8.6、export导出与import 导入 hive表数据（内部表操作）</h4><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create <span class="keyword">table</span> teacher2 <span class="comment">like teacher</span>;</span><br><span class="line">hive (myhive)&gt; export <span class="keyword">table</span> teacher <span class="comment">to</span>  <span class="comment">'/kkb/teacher'</span>;</span><br><span class="line">hive (myhive)&gt; import <span class="keyword">table</span> teacher2 <span class="comment">from</span> <span class="comment">'/kkb/teacher'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="9、Hive数据导出"><a href="#9、Hive数据导出" class="headerlink" title="9、Hive数据导出"></a>9、Hive数据导出</h3><h4 id="9-1-insert-导出"><a href="#9-1-insert-导出" class="headerlink" title="9.1 insert 导出"></a>9.1 insert 导出</h4><ul>
<li>1、将查询的结果导出到本地</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/stu'</span> <span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>
<ul>
<li>2、将查询的结果格式化导出到本地</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/stu2'</span> <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span>  <span class="string">','</span> <span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>
<ul>
<li>3、将查询的结果导出到HDFS上==(没有local)==</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite  <span class="keyword">directory</span> <span class="string">'/kkb/hivedatas/stu'</span>  <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span>  <span class="string">','</span>  <span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>
<h4 id="9-2、-Hive-Shell-命令导出"><a href="#9-2、-Hive-Shell-命令导出" class="headerlink" title="9.2、 Hive Shell 命令导出"></a>9.2、 Hive Shell 命令导出</h4><ul>
<li><p>基本语法：</p>
<ul>
<li>hive -e “sql语句” &gt;   file</li>
<li>hive -f  sql文件   &gt;    file</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/hive -e 'select * from myhive.stu;' &gt; /kkb/install/hivedatas/student1.txt</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="9-3、export导出到HDFS上"><a href="#9-3、export导出到HDFS上" class="headerlink" title="9.3、export导出到HDFS上"></a>9.3、export导出到HDFS上</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export table  myhive.stu to '/kkb/<span class="keyword">install</span>/hivedatas/stuexport<span class="string">';</span></span><br></pre></td></tr></table></figure>
<h3 id="10、hive的静态分区和动态分区"><a href="#10、hive的静态分区和动态分区" class="headerlink" title="10、hive的静态分区和动态分区"></a>10、hive的静态分区和动态分区</h3><h4 id="10-1-静态分区"><a href="#10-1-静态分区" class="headerlink" title="10.1 静态分区"></a>10.1 静态分区</h4><ul>
<li><p>表的分区字段的值需要开发人员手动给定</p>
<ul>
<li>1、创建分区表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> myhive;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> order_partition(</span><br><span class="line">order_number <span class="keyword">string</span>,</span><br><span class="line">order_price  <span class="keyword">double</span>,</span><br><span class="line">order_time <span class="keyword">string</span></span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">BY</span>(<span class="keyword">month</span> <span class="keyword">string</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">- <span class="number">10.2</span>、准备数据	order.txt内容如下</span><br><span class="line">  </span><br><span class="line">cd /kkb/install/hivedatas</span><br><span class="line">vim order.txt </span><br><span class="line"><span class="number">10001</span>	<span class="number">100</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-02</span></span><br><span class="line"><span class="number">10002</span>	<span class="number">200</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-02</span></span><br><span class="line"><span class="number">10003</span>	<span class="number">300</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-02</span></span><br><span class="line"><span class="number">10004</span>	<span class="number">400</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-03</span></span><br><span class="line"><span class="number">10005</span>	<span class="number">500</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-03</span></span><br><span class="line"><span class="number">10006</span>	<span class="number">600</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-03</span></span><br><span class="line"><span class="number">10007</span>	<span class="number">700</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-04</span></span><br><span class="line"><span class="number">10008</span>	<span class="number">800</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-04</span></span><br><span class="line"><span class="number">10009</span>	<span class="number">900</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-04</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>3、加载数据到分区表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/order.txt'</span> overwrite <span class="keyword">into</span> <span class="keyword">table</span> order_partition <span class="keyword">partition</span>(<span class="keyword">month</span>=<span class="string">'2019-03'</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>4、查询结果数据    </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> order_partition <span class="keyword">where</span> <span class="keyword">month</span>=<span class="string">'2019-03'</span>;</span><br><span class="line">结果为：</span><br><span class="line">  </span><br><span class="line">10001   100.0   2019-03-02      2019-03</span><br><span class="line">10002   200.0   2019-03-02      2019-03</span><br><span class="line">10003   300.0   2019-03-02      2019-03</span><br><span class="line">10004   400.0   2019-03-03      2019-03</span><br><span class="line">10005   500.0   2019-03-03      2019-03</span><br><span class="line">10006   600.0   2019-03-03      2019-03</span><br><span class="line">10007   700.0   2019-03-04      2019-03</span><br><span class="line">10008   800.0   2019-03-04      2019-03</span><br><span class="line">10009   900.0   2019-03-04      2019-03</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-动态分区"><a href="#2-动态分区" class="headerlink" title=".2 动态分区"></a>.2 动态分区</h4><ul>
<li><p>按照需求实现把数据自动导入到表的不同分区中，==不需要手动指定==</p>
<ul>
<li><p><strong>需求：按照不同部门作为分区导数据到目标表</strong> </p>
<p>1、创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建普通表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_order(</span><br><span class="line">    order_number <span class="keyword">string</span>,</span><br><span class="line">    order_price  <span class="keyword">double</span>, </span><br><span class="line">    order_time   <span class="keyword">string</span></span><br><span class="line">)<span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建目标分区表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> order_dynamic_partition(</span><br><span class="line">    order_number <span class="keyword">string</span>,</span><br><span class="line">    order_price  <span class="keyword">double</span>    </span><br><span class="line">)partitioned <span class="keyword">BY</span>(order_time <span class="keyword">string</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>
<p>2、准备数据     order_created.txt内容如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/<span class="keyword">install</span>/hivedatas</span><br><span class="line">vim order_partition.txt</span><br><span class="line"></span><br><span class="line"><span class="number">10001</span>	<span class="number">100</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-02</span> </span><br><span class="line"><span class="number">10002</span>	<span class="number">200</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-02</span></span><br><span class="line"><span class="number">10003</span>	<span class="number">300</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-02</span></span><br><span class="line"><span class="number">10004</span>	<span class="number">400</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-03</span></span><br><span class="line"><span class="number">10005</span>	<span class="number">500</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-03</span></span><br><span class="line"><span class="number">10006</span>	<span class="number">600</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-03</span></span><br><span class="line"><span class="number">10007</span>	<span class="number">700</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-04</span></span><br><span class="line"><span class="number">10008</span>	<span class="number">800</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-04</span></span><br><span class="line"><span class="number">10009</span>	<span class="number">900</span>	<span class="number">2019</span><span class="number">-03</span><span class="number">-04</span></span><br></pre></td></tr></table></figure>
<p>3、向普通表t_order加载数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/order_partition.txt'</span> overwrite <span class="keyword">into</span> <span class="keyword">table</span> t_order;</span><br></pre></td></tr></table></figure>
<p>4、动态加载数据到分区表中</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">要想进行动态分区，需要设置参数</span><br><span class="line"><span class="comment">//开启动态分区功能</span></span><br><span class="line">hive&gt; <span class="keyword">set</span> hive.exec.<span class="keyword">dynamic</span>.partition=<span class="literal">true</span>; </span><br><span class="line"><span class="comment">//设置hive为非严格模式</span></span><br><span class="line">hive&gt; <span class="keyword">set</span> hive.exec.<span class="keyword">dynamic</span>.partition.mode=nonstrict; </span><br><span class="line">hive&gt; <span class="function">insert <span class="keyword">into</span> table order_dynamic_partition <span class="title">partition</span>(<span class="params">order_time</span>) <span class="keyword">select</span> order_number,order_price,order_time <span class="keyword">from</span> t_order</span>;</span><br></pre></td></tr></table></figure>
<p>5、查看分区</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bin/hive&gt; </span> <span class="keyword">show </span>partitions <span class="keyword">order_dynamic_partition;</span></span><br></pre></td></tr></table></figure>
<p><img src="assets/1569313506031.png" alt="1569313506031"></p>
</li>
</ul>
</li>
</ul>
<h3 id="11、hive的基本查询语法"><a href="#11、hive的基本查询语法" class="headerlink" title="11、hive的基本查询语法"></a>11、hive的基本查询语法</h3><h4 id="1-基本查询"><a href="#1-基本查询" class="headerlink" title="1. 基本查询"></a>1. 基本查询</h4><ul>
<li>注意<ul>
<li>SQL 语言==大小写不敏感==</li>
<li>SQL 可以写在一行或者多行</li>
<li>==关键字不能被缩写也不能分行==</li>
<li>各子句一般要分行写</li>
<li>使用缩进提高语句的可读性</li>
</ul>
</li>
</ul>
<h5 id="1-1-全表和特定列查询"><a href="#1-1-全表和特定列查询" class="headerlink" title="1.1 全表和特定列查询"></a>1.1 全表和特定列查询</h5><ul>
<li>全表查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>
<ul>
<li>选择特定列查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>
<h5 id="1-2-列起别名"><a href="#1-2-列起别名" class="headerlink" title="1.2 列起别名"></a>1.2 列起别名</h5><ul>
<li><p>重命名一个列</p>
<ul>
<li>紧跟列名，也可以在列名和别名之间加入关键字 ‘as’ </li>
</ul>
</li>
<li><p>案例实操</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">as</span> stuName <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>1.3 常用函数</p>
<ul>
<li>1．求总行数（count）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) cnt <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>
<ul>
<li>2、求分数的最大值（max）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>
<ul>
<li>3、求分数的最小值（min）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">min</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>
<ul>
<li>4、求分数的总和（sum）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>
<ul>
<li>5、求分数的平均值（avg）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>
<h5 id="1-4-limit-语句"><a href="#1-4-limit-语句" class="headerlink" title="1.4 limit 语句"></a>1.4 limit 语句</h5><ul>
<li>典型的查询会返回多行数据。limit子句用于限制返回的行数。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> score <span class="keyword">limit</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h5 id="1-5-where-语句"><a href="#1-5-where-语句" class="headerlink" title="1.5 where 语句"></a>1.5 where 语句</h5><ul>
<li>1、使用 where 子句，将不满足条件的行过滤掉</li>
<li>2、==where 子句紧随from子句==</li>
<li>3、案例实操</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> score <span class="keyword">where</span> s_score &gt; <span class="number">60</span>;</span><br></pre></td></tr></table></figure>
<h5 id="1-6-算术运算符"><a href="#1-6-算术运算符" class="headerlink" title="1.6 算术运算符"></a>1.6 算术运算符</h5><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>A+B</td>
<td>A和B 相加</td>
</tr>
<tr>
<td>A-B</td>
<td>A减去B</td>
</tr>
<tr>
<td>A*B</td>
<td>A和B 相乘</td>
</tr>
<tr>
<td>A/B</td>
<td>A除以B</td>
</tr>
<tr>
<td>A%B</td>
<td>A对B取余</td>
</tr>
<tr>
<td>A&amp;B</td>
<td>A和B按位取与</td>
</tr>
<tr>
<td>A\</td>
<td>B</td>
<td>A和B按位取或</td>
</tr>
<tr>
<td>A^B</td>
<td>A和B按位取异或</td>
</tr>
<tr>
<td>~A</td>
<td>A按位取反</td>
</tr>
</tbody>
</table>
<h5 id="1-7-比较运算符"><a href="#1-7-比较运算符" class="headerlink" title="1.7 比较运算符"></a>1.7 比较运算符</h5><table>
<thead>
<tr>
<th style="text-align:center">操作符</th>
<th style="text-align:center">支持的数据类型</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A=B</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">如果A等于B则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">A&lt;=&gt;B</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">如果A和B都为NULL，则返回true，其他的和等号（=）操作符的结果一致，如果任一为NULL则结果为NULL</td>
</tr>
<tr>
<td style="text-align:center">A&lt;&gt;B, A!=B</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">A或者B为NULL则返回NULL；如果A不等于B，则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">A&lt;B</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">A或者B为NULL，则返回NULL；如果A小于B，则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">A&lt;=B</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">A或者B为NULL，则返回NULL；如果A小于等于B，则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">A&gt;B</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">A或者B为NULL，则返回NULL；如果A大于B，则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">A&gt;=B</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">A或者B为NULL，则返回NULL；如果A大于等于B，则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">A [NOT] BETWEEN B AND C</td>
<td style="text-align:center">基本数据类型</td>
<td style="text-align:center">如果A，B或者C任一为NULL，则结果为NULL。如果A的值大于等于B而且小于或等于C，则结果为true，反之为false。如果使用NOT关键字则可达到相反的效果。</td>
</tr>
<tr>
<td style="text-align:center">A IS NULL</td>
<td style="text-align:center">所有数据类型</td>
<td style="text-align:center">如果A等于NULL，则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">A IS NOT NULL</td>
<td style="text-align:center">所有数据类型</td>
<td style="text-align:center">如果A不等于NULL，则返回true，反之返回false</td>
</tr>
<tr>
<td style="text-align:center">IN(数值1, 数值2)</td>
<td style="text-align:center">所有数据类型</td>
<td style="text-align:center">使用 IN运算显示列表中的值</td>
</tr>
<tr>
<td style="text-align:center">A [NOT] LIKE B</td>
<td style="text-align:center">STRING 类型</td>
<td style="text-align:center">B是一个SQL下的简单正则表达式，如果A与其匹配的话，则返回true；反之返回false。B的表达式说明如下：‘x%’表示A必须以字母‘x’开头，‘%x’表示A必须以字母’x’结尾，而‘%x%’表示A包含有字母’x’,可以位于开头，结尾或者字符串中间。如果使用NOT关键字则可达到相反的效果。like不是正则，而是通配符</td>
</tr>
<tr>
<td style="text-align:center">A RLIKE B, A REGEXP B</td>
<td style="text-align:center">STRING 类型</td>
<td style="text-align:center">B是一个正则表达式，如果A与其匹配，则返回true；反之返回false。匹配使用的是JDK中的正则表达式接口实现的，因为正则也依据其中的规则。例如，正则表达式必须和整个字符串A相匹配，而不是只需与其字符串匹配。</td>
</tr>
</tbody>
</table>
<h5 id="1-8-逻辑运算符"><a href="#1-8-逻辑运算符" class="headerlink" title="1.8 逻辑运算符"></a>1.8 逻辑运算符</h5><table>
<thead>
<tr>
<th style="text-align:center">操作符</th>
<th style="text-align:center">操作</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A AND  B</td>
<td style="text-align:center">逻辑并</td>
<td style="text-align:center">如果A和B都是true则为true，否则false</td>
</tr>
<tr>
<td style="text-align:center">A  OR  B</td>
<td style="text-align:center">逻辑或</td>
<td style="text-align:center">如果A或B或两者都是true则为true，否则false</td>
</tr>
<tr>
<td style="text-align:center">NOT  A</td>
<td style="text-align:center">逻辑否</td>
<td style="text-align:center">如果A为false则为true,否则false</td>
</tr>
</tbody>
</table>
<h4 id="2-分组"><a href="#2-分组" class="headerlink" title="2. 分组"></a>2. 分组</h4><h5 id="2-1-Group-By-语句"><a href="#2-1-Group-By-语句" class="headerlink" title="2.1 Group By 语句"></a>2.1 Group By 语句</h5><p>​    Group By 语句通常会和==聚合函数==一起使用，按照一个或者多个列队结果进行分组，然后对每个组执行聚合操作。</p>
<ul>
<li><p>案例实操：</p>
<ul>
<li>（1）计算每个学生的平均分数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id,<span class="keyword">avg</span>(s_score) <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id;</span><br></pre></td></tr></table></figure>
<ul>
<li>（2）计算每个学生最高的分数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id,<span class="keyword">max</span>(s_score) <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="2-2-Having语句"><a href="#2-2-Having语句" class="headerlink" title="2.2 Having语句"></a>2.2 Having语句</h5><ul>
<li><p>having 与 where 不同点</p>
<ul>
<li>where针对==表中的列发挥作用==，查询数据；==having针对查询结果中的列==发挥作用，筛选数据</li>
<li>where后面==不能写分组函数==，而having后面可以==使用分组函数==</li>
<li>having只用于group by分组统计语句</li>
</ul>
</li>
<li><p>案例实操</p>
<ul>
<li>求每个学生的平均分数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id,<span class="keyword">avg</span>(s_score) <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id;</span><br></pre></td></tr></table></figure>
<ul>
<li>求每个学生平均分数大于60的人</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id,<span class="keyword">avg</span>(s_score) <span class="keyword">as</span> avgScore <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id <span class="keyword">having</span> avgScore &gt; <span class="number">60</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-join语句"><a href="#3-join语句" class="headerlink" title="3. join语句"></a>3. join语句</h4><h5 id="11-3-1-等值-join"><a href="#11-3-1-等值-join" class="headerlink" title="11.3.1 等值 join"></a>11.3.1 等值 join</h5><ul>
<li><p>Hive支持通常的SQL JOIN语句，但是只支持等值连接，不支持非等值连接。</p>
</li>
<li><p>案例实操</p>
<ul>
<li>根据学生和成绩表，查询学生姓名对应的成绩</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> stu <span class="keyword">left</span> <span class="keyword">join</span> score <span class="keyword">on</span> stu.id = score.s_id;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="11-3-2-表的别名"><a href="#11-3-2-表的别名" class="headerlink" title="11.3.2 表的别名"></a>11.3.2 表的别名</h5><ul>
<li><p>好处</p>
<ul>
<li>使用别名可以简化查询。</li>
<li>使用表名前缀可以提高执行效率。</li>
</ul>
</li>
<li><p>案例实操</p>
<ul>
<li>合并老师与课程表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#hive当中创建course表并加载数据</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course (c_id <span class="keyword">string</span>,c_name <span class="keyword">string</span>,t_id <span class="keyword">string</span>) <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/course.csv'</span> overwrite <span class="keyword">into</span> <span class="keyword">table</span> course;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">join</span> course c <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="11-3-3-内连接-inner-join"><a href="#11-3-3-内连接-inner-join" class="headerlink" title="11.3.3 内连接 inner join"></a>11.3.3 内连接 inner join</h5><ul>
<li>内连接：只有进行连接的两个表中都存在与连接条件相匹配的数据才会被保留下来。<ul>
<li>join默认是inner  join</li>
</ul>
</li>
<li>案例实操</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">inner</span> <span class="keyword">join</span> course c  <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>
<h5 id="11-3-4-左外连接-left-outer-join"><a href="#11-3-4-左外连接-left-outer-join" class="headerlink" title="11.3.4 左外连接 left outer join"></a>11.3.4 左外连接 left outer join</h5><ul>
<li><p>左外连接：join操作符==左边表中==符合where子句的所有记录将会被返回。</p>
</li>
<li><p>案例实操</p>
<ul>
<li>查询老师对应的课程</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> course c  <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="3-5-右外连接-right-outer-join"><a href="#3-5-右外连接-right-outer-join" class="headerlink" title="3.5 右外连接 right outer join"></a>3.5 右外连接 right outer join</h5><ul>
<li><p>右外连接：join操作符==右边表中==符合where子句的所有记录将会被返回。</p>
</li>
<li><p>案例实操</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> course c  <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="11-3-6-满外连接-full-outer-join"><a href="#11-3-6-满外连接-full-outer-join" class="headerlink" title="11.3.6 满外连接 full outer join"></a>11.3.6 满外连接 full outer join</h5><ul>
<li><p>满外连接：将会返回==所有表中==符合where语句条件的所有记录。如果任一表的指定字段没有符合条件的值的话，那么就使用null值替代。</p>
</li>
<li><p>案例实操</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> course c  <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="11-3-7-多表连接"><a href="#11-3-7-多表连接" class="headerlink" title="11.3.7 多表连接"></a>11.3.7 多表连接</h5><ul>
<li><p><strong>多个表使用join进行连接</strong></p>
</li>
<li><p>注意：连接 n个表，至少需要n-1个连接条件。例如：连接三个表，至少需要两个连接条件。</p>
</li>
<li><p>案例实操</p>
<ul>
<li>多表连接查询，查询老师对应的课程，以及对应的分数，对应的学生</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">left</span> <span class="keyword">join</span> course c <span class="keyword">on</span> t.t_id = c.t_id </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> score s <span class="keyword">on</span> c.c_id = s.c_id </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> stu <span class="keyword">on</span> s.s_id = stu.id;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="11-4-排序"><a href="#11-4-排序" class="headerlink" title="11.4. 排序"></a>11.4. 排序</h4><h5 id="11-4-1-order-by-全局排序"><a href="#11-4-1-order-by-全局排序" class="headerlink" title="11.4.1 order by 全局排序"></a>11.4.1 order by 全局排序</h5><ul>
<li><p>order by 说明</p>
<ul>
<li>全局排序，只有一个reduce</li>
<li>使用 ORDER BY 子句排序<ul>
<li>asc ( ascend)<ul>
<li>升序 (默认)</li>
</ul>
</li>
<li>desc (descend)<ul>
<li>降序</li>
</ul>
</li>
</ul>
</li>
<li>order by 子句在select语句的结尾</li>
</ul>
</li>
<li><p>案例实操</p>
<ul>
<li>查询学生的成绩，并按照分数降序排列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> score  s <span class="keyword">order</span> <span class="keyword">by</span> s_score <span class="keyword">desc</span> ;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="11-4-2-按照别名排序"><a href="#11-4-2-按照别名排序" class="headerlink" title="11.4.2 按照别名排序"></a>11.4.2 按照别名排序</h5><ul>
<li>按照学生分数的平均值排序</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id,<span class="keyword">avg</span>(s_score) avgscore  <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id <span class="keyword">order</span> <span class="keyword">by</span> avgscore <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<h5 id="11-4-3-每个MapReduce内部排序（Sort-By）局部排序"><a href="#11-4-3-每个MapReduce内部排序（Sort-By）局部排序" class="headerlink" title="11.4.3 每个MapReduce内部排序（Sort By）局部排序"></a>11.4.3 每个MapReduce内部排序（Sort By）局部排序</h5><ul>
<li><p>sort by：每个reducer内部进行排序，对全局结果集来说不是排序。</p>
<p>1、设置reduce个数</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">set</span> mapreduce.job.<span class="attribute">reduces</span>=3;</span><br></pre></td></tr></table></figure>
<p>2、查看reduce的个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> mapreduce.job.reduces;</span><br></pre></td></tr></table></figure>
<p>3、查询成绩按照成绩降序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> score s <span class="keyword">sort</span> <span class="keyword">by</span> s.s_score;</span><br></pre></td></tr></table></figure>
<p>4、将查询结果导入到文件中（按照成绩降序排列）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/sort'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score s <span class="keyword">sort</span> <span class="keyword">by</span> s.s_score;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="11-4-4-distribute-by-分区排序"><a href="#11-4-4-distribute-by-分区排序" class="headerlink" title="11.4.4 distribute by 分区排序"></a>11.4.4 distribute by 分区排序</h5><ul>
<li><p>distribute by：类似MR中partition，==采集hash算法，在map端将查询的结果中hash值相同的结果分发到对应的reduce文件中==。结合sort by使用。</p>
</li>
<li><p>注意</p>
<ul>
<li>Hive要求 <strong>distribute by</strong> 语句要写在 <strong>sort by</strong> 语句之前。</li>
</ul>
</li>
<li><p>案例实操</p>
<ul>
<li><p>先按照学生 sid 进行分区，再按照学生成绩进行排序</p>
<ul>
<li>设置reduce的个数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> mapreduce.job.reduces=<span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过distribute by  进行数据的分区,，将不同的sid 划分到对应的reduce当中去</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/distribute'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score <span class="keyword">distribute</span> <span class="keyword">by</span> s_id <span class="keyword">sort</span> <span class="keyword">by</span> s_score;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h5 id="11-4-5-cluster-by"><a href="#11-4-5-cluster-by" class="headerlink" title="11.4.5 cluster by"></a>11.4.5 cluster by</h5><ul>
<li><p>当distribute by和sort by字段相同时，可以使用cluster by方式</p>
</li>
<li><p>除了distribute by 的功能外，还会对该字段进行排序，所以cluster by = distribute by + sort by</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--以下两种写法等价</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/distribute_sort'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score <span class="keyword">distribute</span>  <span class="keyword">by</span> s_score <span class="keyword">sort</span>  <span class="keyword">by</span> s_score;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/cluster'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score  cluster <span class="keyword">by</span> s_score;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="12、hive客户端jdbc操作"><a href="#12、hive客户端jdbc操作" class="headerlink" title="12、hive客户端jdbc操作"></a>12、hive客户端jdbc操作</h3><h4 id="第一步：启动hiveserver2的服务端"><a href="#第一步：启动hiveserver2的服务端" class="headerlink" title="第一步：启动hiveserver2的服务端"></a>第一步：启动hiveserver2的服务端</h4><p>node03执行以下命令启动hiveserver2的服务端</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hive<span class="number">-1.1</span><span class="number">.0</span>-cdh5<span class="number">.14</span><span class="number">.2</span>/</span><br><span class="line">nohup bin/hive --service hiveserver2 <span class="number">2</span>&gt;&amp;<span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure>
<h4 id="第二步：引入依赖"><a href="#第二步：引入依赖" class="headerlink" title="第二步：引入依赖"></a>第二步：引入依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">id</span>&gt;</span>cloudera<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repository.cloudera.com/artifactory/cloudera-repos/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hive-exec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.0-cdh5.14.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hive-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.0-cdh5.14.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hive-cli<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.0-cdh5.14.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.0-cdh5.14.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">                 <span class="comment">&lt;!--    &lt;verbal&gt;true&lt;/verbal&gt;--&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="第三步：代码开发"><a href="#第三步：代码开发" class="headerlink" title="第三步：代码开发"></a>第三步：代码开发</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HiveJDBC</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url=<span class="string">"jdbc:hive2://192.168.52.120:10000/myhive"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Class.forName(<span class="string">"org.apache.hive.jdbc.HiveDriver"</span>);</span><br><span class="line">        <span class="comment">//获取数据库连接</span></span><br><span class="line">        Connection connection = DriverManager.getConnection(url, <span class="string">"hadoop"</span>,<span class="string">""</span>);</span><br><span class="line">        <span class="comment">//定义查询的sql语句</span></span><br><span class="line">        String sql=<span class="string">"select * from stu"</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            PreparedStatement ps = connection.prepareStatement(sql);</span><br><span class="line">            ResultSet rs = ps.executeQuery();</span><br><span class="line">            <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                <span class="comment">//获取id字段值</span></span><br><span class="line">                <span class="keyword">int</span> id = rs.getInt(<span class="number">1</span>);</span><br><span class="line">                <span class="comment">//获取deptid字段</span></span><br><span class="line">                String name = rs.getString(<span class="number">2</span>);</span><br><span class="line">                System.out.println(id+<span class="string">"\t"</span>+name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="、hive的可视化工具dbeaver介绍以及使用"><a href="#、hive的可视化工具dbeaver介绍以及使用" class="headerlink" title="、hive的可视化工具dbeaver介绍以及使用"></a>、hive的可视化工具dbeaver介绍以及使用</h3><h4 id="1、dbeaver的基本介绍"><a href="#1、dbeaver的基本介绍" class="headerlink" title="1、dbeaver的基本介绍"></a>1、dbeaver的基本介绍</h4><p>dbeaver是一个图形化的界面工具，专门用于与各种数据库的集成，通过dbeaver我们可以与各种数据库进行集成通过图形化界面的方式来操作我们的数据库与数据库表，类似于我们的sqlyog或者navicate</p>
<h4 id="2、dbeaver的下载安装"><a href="#2、dbeaver的下载安装" class="headerlink" title="2、dbeaver的下载安装"></a>2、dbeaver的下载安装</h4><p><a href="https://github.com/dbeaver/dbeaver/releases" target="_blank" rel="noopener">https://github.com/dbeaver/dbeaver/releases</a></p>
<p>我们可以直接从github上面下载我们需要的对应的安装包即可</p>
<h4 id="3、dbeaver的安装与使用"><a href="#3、dbeaver的安装与使用" class="headerlink" title="3、dbeaver的安装与使用"></a>3、dbeaver的安装与使用</h4><p>这里我们使用的版本是6.15这个版本，下载zip的压缩包，直接解压就可以使用，然后双击dbeaver.exe即可启动</p>
<h5 id="第一步：双击dbeaver-exe然后启动dbeaver图形化界面"><a href="#第一步：双击dbeaver-exe然后启动dbeaver图形化界面" class="headerlink" title="第一步：双击dbeaver.exe然后启动dbeaver图形化界面"></a>第一步：双击dbeaver.exe然后启动dbeaver图形化界面</h5><p><img src="assets/1569407489837.png" alt="1569407489837"></p>
<h5 id="第二步：配置我们的主机名与端口号"><a href="#第二步：配置我们的主机名与端口号" class="headerlink" title="第二步：配置我们的主机名与端口号"></a>第二步：配置我们的主机名与端口号</h5><p><img src="assets/20181113110722636.png" alt="20181113110722636"></p>
<p><img src="assets/1569407697691.png" alt="1569407697691"></p>
<p><strong>注意：⚠️</strong></p>
<p>企业hive可视化工具：Hub</p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a href="https://www.10000h.top">10000H</a></span>
        <span>/</span>
        
        <span><a href="https://niexiaotao.com">Xiaotao&#39;s Page</a></span>
        <span>/</span>
        
        <span><a href="#">It helps SEO</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
