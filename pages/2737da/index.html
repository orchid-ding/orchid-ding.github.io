<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>工作流调度引擎oozie | clivia‘s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="Java后端、大数据等技术博客，专注于各种技术总结。Java、高并发、hadoop、spark、hbase、hive、zookeeper、mysql、mongodb、redis">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.027adcb0.css" as="style"><link rel="preload" href="/assets/js/app.06f86fe0.js" as="script"><link rel="preload" href="/assets/js/2.ed69dcfc.js" as="script"><link rel="preload" href="/assets/js/3.b6cd915d.js" as="script"><link rel="preload" href="/assets/js/10.2b0a2d8d.js" as="script"><link rel="prefetch" href="/assets/js/100.16d5c2bc.js"><link rel="prefetch" href="/assets/js/101.c4ff0a78.js"><link rel="prefetch" href="/assets/js/102.4e574824.js"><link rel="prefetch" href="/assets/js/103.ac1661b8.js"><link rel="prefetch" href="/assets/js/104.dfdf274c.js"><link rel="prefetch" href="/assets/js/105.f792ba33.js"><link rel="prefetch" href="/assets/js/106.4347b2a7.js"><link rel="prefetch" href="/assets/js/107.7248a258.js"><link rel="prefetch" href="/assets/js/108.a3c43671.js"><link rel="prefetch" href="/assets/js/109.e8c087b3.js"><link rel="prefetch" href="/assets/js/11.0c3d61f1.js"><link rel="prefetch" href="/assets/js/110.2b89ad56.js"><link rel="prefetch" href="/assets/js/111.d35e07d0.js"><link rel="prefetch" href="/assets/js/112.2402331a.js"><link rel="prefetch" href="/assets/js/113.82a39665.js"><link rel="prefetch" href="/assets/js/114.4c8d3fcb.js"><link rel="prefetch" href="/assets/js/115.f038010e.js"><link rel="prefetch" href="/assets/js/116.c7865d0c.js"><link rel="prefetch" href="/assets/js/117.2729b824.js"><link rel="prefetch" href="/assets/js/118.b8c9bb1f.js"><link rel="prefetch" href="/assets/js/119.a9eea003.js"><link rel="prefetch" href="/assets/js/12.e4b75a11.js"><link rel="prefetch" href="/assets/js/120.06f1eb1b.js"><link rel="prefetch" href="/assets/js/121.354a7fd4.js"><link rel="prefetch" href="/assets/js/122.af00dd2b.js"><link rel="prefetch" href="/assets/js/123.976e22ad.js"><link rel="prefetch" href="/assets/js/124.de810dba.js"><link rel="prefetch" href="/assets/js/125.2c17fa05.js"><link rel="prefetch" href="/assets/js/126.ffeb8997.js"><link rel="prefetch" href="/assets/js/127.6b2f64dd.js"><link rel="prefetch" href="/assets/js/128.f9b62119.js"><link rel="prefetch" href="/assets/js/129.ce5c5c0e.js"><link rel="prefetch" href="/assets/js/13.2c54c92b.js"><link rel="prefetch" href="/assets/js/130.7db38d34.js"><link rel="prefetch" href="/assets/js/131.5abdd66a.js"><link rel="prefetch" href="/assets/js/132.5dd5eece.js"><link rel="prefetch" href="/assets/js/133.651d4b9b.js"><link rel="prefetch" href="/assets/js/134.68173250.js"><link rel="prefetch" href="/assets/js/135.ca520569.js"><link rel="prefetch" href="/assets/js/136.1515cd12.js"><link rel="prefetch" href="/assets/js/137.d783808b.js"><link rel="prefetch" href="/assets/js/138.05efd534.js"><link rel="prefetch" href="/assets/js/139.a65dce22.js"><link rel="prefetch" href="/assets/js/14.5cb33b3a.js"><link rel="prefetch" href="/assets/js/140.44dc5c4e.js"><link rel="prefetch" href="/assets/js/141.0632e3aa.js"><link rel="prefetch" href="/assets/js/142.66ac9883.js"><link rel="prefetch" href="/assets/js/143.8a75f55a.js"><link rel="prefetch" href="/assets/js/144.349bba43.js"><link rel="prefetch" href="/assets/js/15.06dff62d.js"><link rel="prefetch" href="/assets/js/16.ad74e0a9.js"><link rel="prefetch" href="/assets/js/17.e0d7a93c.js"><link rel="prefetch" href="/assets/js/18.0c217b19.js"><link rel="prefetch" href="/assets/js/19.33d29011.js"><link rel="prefetch" href="/assets/js/20.5c47e53a.js"><link rel="prefetch" href="/assets/js/21.4623dcf3.js"><link rel="prefetch" href="/assets/js/22.1d2819bf.js"><link rel="prefetch" href="/assets/js/23.da3264cc.js"><link rel="prefetch" href="/assets/js/24.a3976766.js"><link rel="prefetch" href="/assets/js/25.52b1b746.js"><link rel="prefetch" href="/assets/js/26.527a58d4.js"><link rel="prefetch" href="/assets/js/27.1a611ca9.js"><link rel="prefetch" href="/assets/js/28.19848920.js"><link rel="prefetch" href="/assets/js/29.0399b7cc.js"><link rel="prefetch" href="/assets/js/30.f4967fc4.js"><link rel="prefetch" href="/assets/js/31.ec15c096.js"><link rel="prefetch" href="/assets/js/32.ea29ed83.js"><link rel="prefetch" href="/assets/js/33.2506e8df.js"><link rel="prefetch" href="/assets/js/34.b317cb6a.js"><link rel="prefetch" href="/assets/js/35.e98b1f8e.js"><link rel="prefetch" href="/assets/js/36.5a3c937d.js"><link rel="prefetch" href="/assets/js/37.d8e66f15.js"><link rel="prefetch" href="/assets/js/38.583bd78a.js"><link rel="prefetch" href="/assets/js/39.02884927.js"><link rel="prefetch" href="/assets/js/4.4f8d037f.js"><link rel="prefetch" href="/assets/js/40.11d31d5e.js"><link rel="prefetch" href="/assets/js/41.e3b7229f.js"><link rel="prefetch" href="/assets/js/42.ed31fd5c.js"><link rel="prefetch" href="/assets/js/43.71601b99.js"><link rel="prefetch" href="/assets/js/44.7235eb98.js"><link rel="prefetch" href="/assets/js/45.8adef6f7.js"><link rel="prefetch" href="/assets/js/46.44d68224.js"><link rel="prefetch" href="/assets/js/47.ec6b4de8.js"><link rel="prefetch" href="/assets/js/48.ee56118d.js"><link rel="prefetch" href="/assets/js/49.0f6101ee.js"><link rel="prefetch" href="/assets/js/5.0e4db68d.js"><link rel="prefetch" href="/assets/js/50.2d01b40c.js"><link rel="prefetch" href="/assets/js/51.ddf132cb.js"><link rel="prefetch" href="/assets/js/52.fbc9619b.js"><link rel="prefetch" href="/assets/js/53.089b304e.js"><link rel="prefetch" href="/assets/js/54.34c0d377.js"><link rel="prefetch" href="/assets/js/55.41e71cff.js"><link rel="prefetch" href="/assets/js/56.ed6b0ac8.js"><link rel="prefetch" href="/assets/js/57.538bf884.js"><link rel="prefetch" href="/assets/js/58.d0051104.js"><link rel="prefetch" href="/assets/js/59.00792d53.js"><link rel="prefetch" href="/assets/js/6.6a15c5c7.js"><link rel="prefetch" href="/assets/js/60.44529245.js"><link rel="prefetch" href="/assets/js/61.6a6e2fe6.js"><link rel="prefetch" href="/assets/js/62.b02509d6.js"><link rel="prefetch" href="/assets/js/63.c865f599.js"><link rel="prefetch" href="/assets/js/64.7aafe0f4.js"><link rel="prefetch" href="/assets/js/65.029254a7.js"><link rel="prefetch" href="/assets/js/66.1d8c00be.js"><link rel="prefetch" href="/assets/js/67.191949ec.js"><link rel="prefetch" href="/assets/js/68.fc11d430.js"><link rel="prefetch" href="/assets/js/69.5e5d346e.js"><link rel="prefetch" href="/assets/js/7.4353a828.js"><link rel="prefetch" href="/assets/js/70.61cd3f71.js"><link rel="prefetch" href="/assets/js/71.1a87ddd4.js"><link rel="prefetch" href="/assets/js/72.f561b5cf.js"><link rel="prefetch" href="/assets/js/73.d1c67ae7.js"><link rel="prefetch" href="/assets/js/74.3725d6d7.js"><link rel="prefetch" href="/assets/js/75.310c7556.js"><link rel="prefetch" href="/assets/js/76.b8a53386.js"><link rel="prefetch" href="/assets/js/77.e04be33a.js"><link rel="prefetch" href="/assets/js/78.17c06f28.js"><link rel="prefetch" href="/assets/js/79.3ff2fb40.js"><link rel="prefetch" href="/assets/js/8.248194f5.js"><link rel="prefetch" href="/assets/js/80.96d575dc.js"><link rel="prefetch" href="/assets/js/81.770ca2a4.js"><link rel="prefetch" href="/assets/js/82.8900493c.js"><link rel="prefetch" href="/assets/js/83.4716d242.js"><link rel="prefetch" href="/assets/js/84.5ae9874f.js"><link rel="prefetch" href="/assets/js/85.924e7d3d.js"><link rel="prefetch" href="/assets/js/86.5073d16d.js"><link rel="prefetch" href="/assets/js/87.1148acd0.js"><link rel="prefetch" href="/assets/js/88.629d8beb.js"><link rel="prefetch" href="/assets/js/89.36b4cdb0.js"><link rel="prefetch" href="/assets/js/9.85151a25.js"><link rel="prefetch" href="/assets/js/90.fac275aa.js"><link rel="prefetch" href="/assets/js/91.93484ec9.js"><link rel="prefetch" href="/assets/js/92.01e42c63.js"><link rel="prefetch" href="/assets/js/93.50a55dd7.js"><link rel="prefetch" href="/assets/js/94.6a3f96c8.js"><link rel="prefetch" href="/assets/js/95.7dd7befb.js"><link rel="prefetch" href="/assets/js/96.38d049b2.js"><link rel="prefetch" href="/assets/js/97.a129eb48.js"><link rel="prefetch" href="/assets/js/98.f848c937.js"><link rel="prefetch" href="/assets/js/99.2dc3271b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.027adcb0.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/C-logo.png" alt="clivia‘s blog" class="logo"> <span class="site-name can-hide">clivia‘s blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">大数据</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://gitee.com/kflys/clivia-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Gitee
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>clivia’s blog</h3> <span>专注于后端开发，致力于简洁知识。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">大数据</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://gitee.com/kflys/clivia-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Gitee
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>大数据文章</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>大数据辅助框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/2737da/" aria-current="page" class="active sidebar-link">工作流调度引擎oozie</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2737da/#_1-oozie的介绍" class="sidebar-link">1. oozie的介绍</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_2-oozie的架构" class="sidebar-link">2. oozie的架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2737da/#_2-1-oozie的执行流程" class="sidebar-link">2.1 oozie的执行流程</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_2-2-oozie的组件介绍" class="sidebar-link">2.2 oozie的组件介绍</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_3-oozie的使用" class="sidebar-link">3. oozie的使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2737da/#_3-1-使用oozie调度shell脚本" class="sidebar-link">3.1 使用oozie调度shell脚本</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_3-2-oozie调度hive" class="sidebar-link">3.2 oozie调度hive</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_3-3-oozie调度mr任务" class="sidebar-link">3.3 oozie调度MR任务</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_3-4、oozie的任务串联" class="sidebar-link">3.4、oozie的任务串联</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_3-5、oozie的任务调度-定时任务执行" class="sidebar-link">3.5、oozie的任务调度,定时任务执行</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_4-hue整合oozie" class="sidebar-link">4. hue整合oozie</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2737da/#_4-1-停止oozie与hue的进程" class="sidebar-link">4.1 停止oozie与hue的进程</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_4-2-修改oozie的配置文件" class="sidebar-link">4.2 修改oozie的配置文件</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_4-3-修改hue的配置文件" class="sidebar-link">4.3 修改hue的配置文件</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_4-4-启动hue与oozie的进程" class="sidebar-link">4.4 启动hue与oozie的进程</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_5-oozie使用过程当中可能遇到的问题" class="sidebar-link">5. oozie使用过程当中可能遇到的问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2737da/#_5-1-mysql权限配置" class="sidebar-link">5.1 Mysql权限配置</a></li><li class="sidebar-sub-header"><a href="/pages/2737da/#_5-2-部署oozie出错" class="sidebar-link">5.2 部署oozie出错</a></li></ul></li></ul></li><li><a href="/pages/ae8a76/" class="sidebar-link">图形化界面整合Hue</a></li><li><a href="/pages/2f4df8/" class="sidebar-link">大数据技术之Impala</a></li><li><a href="/pages/72efb9/" class="sidebar-link">Flume日志采集框架</a></li><li><a href="/pages/4ed21b/" class="sidebar-link">Sqoop数据迁移工具</a></li><li><a href="/pages/bd6912/" class="sidebar-link">工作流调度Azkaban</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>分布式协调框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>大数据缓冲层框架</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-70a2d273><div class="articleInfo" data-v-70a2d273><ul class="breadcrumbs" data-v-70a2d273><li data-v-70a2d273><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-70a2d273></a></li> <li data-v-70a2d273><a href="/bigdata" title="大数据-目录页" data-v-70a2d273>大数据</a></li> <li data-v-70a2d273><a href="/bigdata/#大数据文章" title="大数据#大数据文章" data-v-70a2d273>大数据文章</a></li> <li data-v-70a2d273><a href="/bigdata/#大数据辅助框架" title="大数据#大数据辅助框架" data-v-70a2d273>大数据辅助框架</a></li></ul> <div class="info" data-v-70a2d273><div title="作者" class="author iconfont icon-touxiang" data-v-70a2d273><a href="https://gitee.com/kflys" target="_blank" title="作者" class="beLink" data-v-70a2d273>kflys</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-70a2d273><a href="javascript:;" data-v-70a2d273>2021-10-12</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          工作流调度引擎oozie
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h2 id="_1-oozie的介绍"><a href="#_1-oozie的介绍" class="header-anchor">#</a> 1. oozie的介绍</h2> <div class="language- extra-class"><pre><code>	Oozie是运行在hadoop平台上的一种工作流调度引擎，它可以用来调度与管理hadoop任务，如，MapReduce、Pig等。那么，对于		OozieWorkflow中的一个个的action（可以理解成一个个MapReduce任务）Oozie是根据什么来对action的执行时间与执行顺序进行管理调度的呢？答案就是我们在数据结构中常见的有向无环图(DAGDirect Acyclic Graph)的模式来进行管理调度的，我们可以利用HPDL语言（一种xml语言）来定义整个workflow，实现工作流的调度oozie的架构以及执行流程
</code></pre></div><h2 id="_2-oozie的架构"><a href="#_2-oozie的架构" class="header-anchor">#</a> 2. oozie的架构</h2> <p><img src="https://gitee.com/kflys/uPic/raw/master/uPic/1613804112187-481cb7c7-4600-4ce2-b26e-fef6e025ba90.png" alt=""></p> <h3 id="_2-1-oozie的执行流程"><a href="#_2-1-oozie的执行流程" class="header-anchor">#</a> 2.1 oozie的执行流程</h3> <p><img src="https://gitee.com/kflys/uPic/raw/master/uPic/1613804112647-79169071-30e4-489d-85df-19cea217a245.png" alt=""></p> <h3 id="_2-2-oozie的组件介绍"><a href="#_2-2-oozie的组件介绍" class="header-anchor">#</a> 2.2 oozie的组件介绍</h3> <ul><li>workFlow
<ul><li>工作流，定义我们的工作流的任务的执行，主要由一个个的action，在xml中进行配置即可</li></ul></li> <li>Coordinator
<ul><li>协作器，说白了就是oozie当中的定时任务调度的模块</li></ul></li> <li>Bundle
<ul><li>多个Coordinator 的抽象，可以通过bundle将多个Coordinator 进行组装集合起来，形成一个bundle</li></ul></li></ul> <h2 id="_3-oozie的使用"><a href="#_3-oozie的使用" class="header-anchor">#</a> 3. oozie的使用</h2> <h3 id="_3-1-使用oozie调度shell脚本"><a href="#_3-1-使用oozie调度shell脚本" class="header-anchor">#</a> 3.1 使用oozie调度shell脚本</h3> <div class="language- extra-class"><pre><code>	oozie安装好了之后，我们需要测试oozie的功能是否完整好使，官方已经给我们带了各种测试案例，我们可以通过官方提供的各种案例来对我们的oozie进行调度
</code></pre></div><h4 id="_3-1-1-解压官方提供的调度案例"><a href="#_3-1-1-解压官方提供的调度案例" class="header-anchor">#</a> 3.1.1 解压官方提供的调度案例</h4> <div class="language- extra-class"><pre><code>	oozie自带了各种案例，我们可以使用oozie自带的各种案例来作为模板，所以我们这里先把官方提供的各种案例给解压出来
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2

tar -zxf oozie-examples.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-1-2-创建我们的工作目录"><a href="#_3-1-2-创建我们的工作目录" class="header-anchor">#</a> 3.1.2 创建我们的工作目录</h4> <div class="language- extra-class"><pre><code>	在任意地方创建一个oozie的工作目录，以后我们的调度任务的配置文件全部放到oozie的工作目录当中去
</code></pre></div><p>我这里直接在oozie的安装目录下面创建工作目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2

mkdir oozie_works
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-1-3-拷贝任务模板到工作目录"><a href="#_3-1-3-拷贝任务模板到工作目录" class="header-anchor">#</a> 3.1.3 拷贝任务模板到工作目录</h4> <p>我们的任务模板以及工作目录都准备好了之后，我们把我们的shell的任务模板拷贝到我们oozie的工作目录当中去</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2

cp -r examples/apps/shell/ oozie_works/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-1-4-准备一个shell脚本"><a href="#_3-1-4-准备一个shell脚本" class="header-anchor">#</a> 3.1.4 准备一个shell脚本</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
vim oozie_works/shell/hello.sh
# 注意：这个脚本一定要是在我们oozie工作路径下的shell路径下的位置

#!/bin/bash
echo &quot;hello world&quot; &gt;&gt; /kfly/install/hello_oozie.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_3-1-5-job-properties"><a href="#_3-1-5-job-properties" class="header-anchor">#</a> 3.1.5 job.properties</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/shell

vim job.properties

nameNode=hdfs://node01:8020
jobTracker=node01:8032
queueName=default
examplesRoot=oozie_works
oozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/shell
EXEC=hello.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_3-1-6-workflow-xml"><a href="#_3-1-6-workflow-xml" class="header-anchor">#</a> 3.1.6 workflow.xml</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim workflow.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;workflow-app xmlns=&quot;uri:oozie:workflow:0.4&quot; name=&quot;shell-wf&quot;&gt;
&lt;start to=&quot;shell-node&quot;/&gt;
&lt;action name=&quot;shell-node&quot;&gt;
    &lt;shell xmlns=&quot;uri:oozie:shell-action:0.2&quot;&gt;
        &lt;job-tracker&gt;${jobTracker}&lt;/job-tracker&gt;
        &lt;name-node&gt;${nameNode}&lt;/name-node&gt;
        &lt;configuration&gt;
            &lt;property&gt;
                &lt;name&gt;mapred.job.queue.name&lt;/name&gt;
                &lt;value&gt;${queueName}&lt;/value&gt;
            &lt;/property&gt;
        &lt;/configuration&gt;
        &lt;exec&gt;${EXEC}&lt;/exec&gt;
        &lt;!-- &lt;argument&gt;my_output=Hello Oozie&lt;/argument&gt; --&gt;
        &lt;file&gt;/user/hadoop/oozie_works/shell/${EXEC}#${EXEC}&lt;/file&gt;

        &lt;capture-output/&gt;
    &lt;/shell&gt;
    &lt;ok to=&quot;end&quot;/&gt;
    &lt;error to=&quot;fail&quot;/&gt;
&lt;/action&gt;
&lt;decision name=&quot;check-output&quot;&gt;
    &lt;switch&gt;
        &lt;case to=&quot;end&quot;&gt;
            ${wf:actionData('shell-node')['my_output'] eq 'Hello Oozie'}
        &lt;/case&gt;
        &lt;default to=&quot;fail-output&quot;/&gt;
    &lt;/switch&gt;
&lt;/decision&gt;
&lt;kill name=&quot;fail&quot;&gt;
    &lt;message&gt;Shell action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]&lt;/message&gt;
&lt;/kill&gt;
&lt;kill name=&quot;fail-output&quot;&gt;
    &lt;message&gt;Incorrect output, expected [Hello Oozie] but was [${wf:actionData('shell-node')['my_output']}]&lt;/message&gt;
&lt;/kill&gt;
&lt;end name=&quot;end&quot;/&gt;
&lt;/workflow-app&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h4 id="_3-1-7-调度任务到hdfs上面去"><a href="#_3-1-7-调度任务到hdfs上面去" class="header-anchor">#</a> 3.1.7 调度任务到hdfs上面去</h4> <p>注意：上传的hdfs目录为/user/root，因为我们hadoop启动的时候使用的是root用户，如果hadoop启动的是其他用户，那么就上传到
/user/其他用户</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
hdfs dfs -put oozie_works/ /user/hadoop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-1-8-执行调度任务"><a href="#_3-1-8-执行调度任务" class="header-anchor">#</a> 3.1.8 执行调度任务</h4> <p>通过oozie的命令来执行我们的调度任务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
bin/oozie job -oozie http://node03:11000/oozie -config oozie_works/shell/job.properties  -run
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>从监控界面可以看到我们的任务执行成功了
![](https://cdn.nlark.com/yuque/0/2021/png/434900/1613804113941-860e5912-99cc-46ca-b206-727cdf640751.png#align=left&amp;display=inline&amp;height=66&amp;margin=[object Object]&amp;originHeight=260&amp;originWidth=1640&amp;status=done&amp;style=none&amp;width=415)</p> <p>查看hadoop的19888端口，我们会发现，oozie启动了一个MR的任务去执行我们的shell脚本
<img src="https://gitee.com/kflys/uPic/raw/master/uPic/1613804114379-c4407ce5-86ee-469a-881d-522a81ec1cad.png" alt=""></p> <h3 id="_3-2-oozie调度hive"><a href="#_3-2-oozie调度hive" class="header-anchor">#</a> 3.2 oozie调度hive</h3> <h4 id="_3-2-1-拷贝hive的案例模板"><a href="#_3-2-1-拷贝hive的案例模板" class="header-anchor">#</a> 3.2.1 拷贝hive的案例模板</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
cp -ra examples/apps/hive2/ oozie_works/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-2-2-编辑hive模板"><a href="#_3-2-2-编辑hive模板" class="header-anchor">#</a> 3.2.2 编辑hive模板</h4> <p>这里使用的是hiveserver2来进行提交任务，需要注意我们要将hiveserver2的服务给启动起来</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/hive2
vim job.properties

nameNode=hdfs://node01:8020
jobTracker=node01:8032
queueName=default
jdbcURL=jdbc:hive2://node03:10000/default
examplesRoot=oozie_works

oozie.use.system.libpath=true

# 配置我们文件上传到hdfs的保存路径 实际上就是在hdfs 的/user/root/oozie_works/hive2这个路径下

oozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/hive2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_3-2-3-workflow-xml"><a href="#_3-2-3-workflow-xml" class="header-anchor">#</a> 3.2.3 workflow.xml</h4> <p>vim workflow.xml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;workflow-app xmlns=&quot;uri:oozie:workflow:0.5&quot; name=&quot;hive2-wf&quot;&gt;
    &lt;start to=&quot;hive2-node&quot;/&gt;

    &lt;action name=&quot;hive2-node&quot;&gt;
        &lt;hive2 xmlns=&quot;uri:oozie:hive2-action:0.1&quot;&gt;
            &lt;job-tracker&gt;${jobTracker}&lt;/job-tracker&gt;
            &lt;name-node&gt;${nameNode}&lt;/name-node&gt;
            &lt;prepare&gt;
                &lt;delete path=&quot;${nameNode}/user/${wf:user()}/${examplesRoot}/output-data/hive2&quot;/&gt;
                &lt;mkdir path=&quot;${nameNode}/user/${wf:user()}/${examplesRoot}/output-data&quot;/&gt;
            &lt;/prepare&gt;
            &lt;configuration&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.job.queue.name&lt;/name&gt;
                    &lt;value&gt;${queueName}&lt;/value&gt;
                &lt;/property&gt;
            &lt;/configuration&gt;
            &lt;jdbc-url&gt;${jdbcURL}&lt;/jdbc-url&gt;

            &lt;script&gt;script.q&lt;/script&gt;

            &lt;param&gt;INPUT=/user/${wf:user()}/${examplesRoot}/input-data/table&lt;/param&gt;
            &lt;param&gt;OUTPUT=/user/${wf:user()}/${examplesRoot}/output-data/hive2&lt;/param&gt;
        &lt;/hive2&gt;
        &lt;ok to=&quot;end&quot;/&gt;
        &lt;error to=&quot;fail&quot;/&gt;
    &lt;/action&gt;

    &lt;kill name=&quot;fail&quot;&gt;
        &lt;message&gt;Hive2 (Beeline) action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]&lt;/message&gt;
    &lt;/kill&gt;
    &lt;end name=&quot;end&quot;/&gt;
&lt;/workflow-app&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="_3-2-4-编辑script-q文件"><a href="#_3-2-4-编辑script-q文件" class="header-anchor">#</a> 3.2.4 编辑script.q文件</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim script.q

DROP TABLE IF EXISTS test;

CREATE EXTERNAL TABLE test (a INT) STORED AS TEXTFILE LOCATION '${INPUT}';
insert into test values(10);
insert into test values(20);
insert into test values(30);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3-2-5-工作文件上传到hdfs"><a href="#_3-2-5-工作文件上传到hdfs" class="header-anchor">#</a> 3.2.5 工作文件上传到hdfs</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works
hdfs dfs -put hive2/ /user/hadoop/oozie_works/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-2-6-执行oozie的调度"><a href="#_3-2-6-执行oozie的调度" class="header-anchor">#</a> 3.2.6 执行oozie的调度</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
bin/oozie job -oozie http://node03:11000/oozie -config oozie_works/hive2/job.properties  -run
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-2-7-查看调度结果"><a href="#_3-2-7-查看调度结果" class="header-anchor">#</a> 3.2.7 查看调度结果</h4> <p><img src="https://gitee.com/kflys/uPic/raw/master/uPic/1613804114712-f8cbca21-978c-45e1-b925-c972e23c34ff.png" alt=""></p> <h3 id="_3-3-oozie调度mr任务"><a href="#_3-3-oozie调度mr任务" class="header-anchor">#</a> 3.3 oozie调度MR任务</h3> <h4 id="_3-3-1-准备mr执行的数据"><a href="#_3-3-1-准备mr执行的数据" class="header-anchor">#</a> 3.3.1 准备MR执行的数据</h4> <div class="language- extra-class"><pre><code>	我们这里通过oozie调度一个MR的程序的执行，MR的程序可以是自己写的，也可以是hadoop工程自带的，我们这里就选用hadoop工程自带的MR程序来运行wordcount的示例
</code></pre></div><p>准备以下数据上传到HDFS的/oozie/input路径下去</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hdfs dfs -mkdir -p /oozie/input

vim wordcount.txt

hello   world   hadoop
spark   hive    hadoop
将我们的数据上传到hdfs对应目录

hdfs dfs -put wordcount.txt /oozie/input
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_3-3-2-执行官方测试案例"><a href="#_3-3-2-执行官方测试案例" class="header-anchor">#</a> 3.3.2 执行官方测试案例</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>yarn jar /kfly/install/hadoop-2.6.2-cdh5.14.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.6.0-cdh5.14.2.jar wordcount /oozie/input/ /oozie/output
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_3-3-3-准备我们调度的资源"><a href="#_3-3-3-准备我们调度的资源" class="header-anchor">#</a> 3.3.3 准备我们调度的资源</h4> <div class="language- extra-class"><pre><code>	将我们需要调度的资源都准备好放到一个文件夹下面去，包括我们的jar包，我们的job.properties，以及我们的workflow.xml。
</code></pre></div><p>拷贝MR的任务模板。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2

cp -ra examples/apps/map-reduce/ oozie_works/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>	删掉MR任务模板lib目录下自带的jar包
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce/lib

rm -rf oozie-examples-4.1.0-cdh5.14.2.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-2-4-拷贝我们自己的jar包到对应目录"><a href="#_3-2-4-拷贝我们自己的jar包到对应目录" class="header-anchor">#</a> 3.2.4 拷贝我们自己的jar包到对应目录</h4> <div class="language- extra-class"><pre><code>	从上一步的删除当中，我们可以看到我们需要调度的jar包存放在了
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 这个目录下，所以我们把我们需要调度的jar包也放到这个路径下即可
/kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce/lib 

cp /kfly/install/hadoop-2.6.2-cdh5.14.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.6.0-cdh5.14.2.jar /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce/lib/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_3-2-5-修改配置文件job-properties"><a href="#_3-2-5-修改配置文件job-properties" class="header-anchor">#</a> 3.2.5 修改配置文件job.properties</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>
cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce
vim job.properties
nameNode=hdfs://node01:8020
jobTracker=node01:8032
queueName=default
examplesRoot=oozie_works

oozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/map-reduce/workflow.xml
outputDir=/oozie/output
inputdir=/oozie/input
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>workflow.xml</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce

vim workflow.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  &quot;License&quot;); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

       [http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0)

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&gt;
&lt;workflow-app xmlns=&quot;uri:oozie:workflow:0.5&quot; name=&quot;map-reduce-wf&quot;&gt;
    &lt;start to=&quot;mr-node&quot;/&gt;
    &lt;action name=&quot;mr-node&quot;&gt;
        &lt;map-reduce&gt;
            &lt;job-tracker&gt;${jobTracker}&lt;/job-tracker&gt;
            &lt;name-node&gt;${nameNode}&lt;/name-node&gt;
            &lt;prepare&gt;
                &lt;delete path=&quot;${nameNode}/${outputDir}&quot;/&gt;
            &lt;/prepare&gt;
            &lt;configuration&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.job.queue.name&lt;/name&gt;
                    &lt;value&gt;${queueName}&lt;/value&gt;
                &lt;/property&gt;
              &lt;!-- 
                &lt;property&gt;
                    &lt;name&gt;mapred.mapper.class&lt;/name&gt;
                    &lt;value&gt;org.apache.oozie.example.SampleMapper&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.reducer.class&lt;/name&gt;
                    &lt;value&gt;org.apache.oozie.example.SampleReducer&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.map.tasks&lt;/name&gt;
                    &lt;value&gt;1&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.input.dir&lt;/name&gt;
                    &lt;value&gt;/user/${wf:user()}/${examplesRoot}/input-data/text&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.output.dir&lt;/name&gt;
                    &lt;value&gt;/user/${wf:user()}/${examplesRoot}/output-data/${outputDir}&lt;/value&gt;
                &lt;/property&gt;
              --&gt;
             
                 &lt;!-- 开启使用新的API来进行配置 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.mapper.new-api&lt;/name&gt;
                    &lt;value&gt;true&lt;/value&gt;
                &lt;/property&gt;

                &lt;property&gt;
                    &lt;name&gt;mapred.reducer.new-api&lt;/name&gt;
                    &lt;value&gt;true&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定MR的输出key的类型 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.output.key.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.io.Text&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定MR的输出的value的类型--&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.output.value.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.io.IntWritable&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定输入路径 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.input.dir&lt;/name&gt;
                    &lt;value&gt;${nameNode}/${inputdir}&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定输出路径 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.output.dir&lt;/name&gt;
                    &lt;value&gt;${nameNode}/${outputDir}&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定执行的map类 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.map.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.examples.WordCount$TokenizerMapper&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定执行的reduce类 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.reduce.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.examples.WordCount$IntSumReducer&lt;/value&gt;
                &lt;/property&gt;
              &lt;!--  配置map task的个数 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.map.tasks&lt;/name&gt;
                    &lt;value&gt;1&lt;/value&gt;
                &lt;/property&gt;

            &lt;/configuration&gt;
        &lt;/map-reduce&gt;
        &lt;ok to=&quot;end&quot;/&gt;
        &lt;error to=&quot;fail&quot;/&gt;
    &lt;/action&gt;
    &lt;kill name=&quot;fail&quot;&gt;
        &lt;message&gt;Map/Reduce failed, error message[${wf:errorMessage(wf:lastErrorNode())}]&lt;/message&gt;
    &lt;/kill&gt;
    &lt;end name=&quot;end&quot;/&gt;
&lt;/workflow-app&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br></div></div><h4 id="_3-2-6-上传调度任务到hdfs对应目录"><a href="#_3-2-6-上传调度任务到hdfs对应目录" class="header-anchor">#</a> 3.2.6 上传调度任务到hdfs对应目录</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works

hdfs dfs -put map-reduce/ /user/hadoop/oozie_works/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-2-7-执行调度任务"><a href="#_3-2-7-执行调度任务" class="header-anchor">#</a> 3.2.7 执行调度任务</h4> <div class="language- extra-class"><pre><code>	执行我们的调度任务，然后通过oozie的11000端口进行查看任务结果
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2

bin/oozie job -oozie http://node03:11000/oozie -config oozie_works/map-reduce/job.properties -run
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-4、oozie的任务串联"><a href="#_3-4、oozie的任务串联" class="header-anchor">#</a> 3.4、oozie的任务串联</h3> <div class="language- extra-class"><pre><code>	在实际工作当中，肯定会存在多个任务需要执行，并且存在上一个任务的输出结果作为下一个任务的输入数据这样的情况，所以我们需要在workflow.xml配置文件当中配置多个action，实现多个任务之间的相互依赖关系
</code></pre></div><p>需求：首先执行一个shell脚本，执行完了之后再执行一个MR的程序，最后再执行一个hive的程序</p> <h4 id="_3-4-1-准备我们的工作目录"><a href="#_3-4-1-准备我们的工作目录" class="header-anchor">#</a> 3.4.1 准备我们的工作目录</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works

mkdir -p sereval-actions
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-4-2-准备我们的调度文件"><a href="#_3-4-2-准备我们的调度文件" class="header-anchor">#</a> 3.4.2 准备我们的调度文件</h4> <div class="language- extra-class"><pre><code>	将我们之前的hive，shell，以及MR的执行，进行串联成到一个workflow当中去，准备我们的资源文件
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works
cp hive2/script.q sereval-actions/
cp shell/hello.sh sereval-actions/
cp -ra map-reduce/lib sereval-actions/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_3-4-3-开发调度的配置文件"><a href="#_3-4-3-开发调度的配置文件" class="header-anchor">#</a> 3.4.3 开发调度的配置文件</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/sereval-actions

# 创建配置文件workflow.xml并编辑
vim workflow.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;workflow-app xmlns=&quot;uri:oozie:workflow:0.4&quot; name=&quot;shell-wf&quot;&gt;
&lt;start to=&quot;shell-node&quot;/&gt;
&lt;action name=&quot;shell-node&quot;&gt;
    &lt;shell xmlns=&quot;uri:oozie:shell-action:0.2&quot;&gt;
        &lt;job-tracker&gt;${jobTracker}&lt;/job-tracker&gt;
        &lt;name-node&gt;${nameNode}&lt;/name-node&gt;
        &lt;configuration&gt;
            &lt;property&gt;
                &lt;name&gt;mapred.job.queue.name&lt;/name&gt;
                &lt;value&gt;${queueName}&lt;/value&gt;
            &lt;/property&gt;
        &lt;/configuration&gt;
        &lt;exec&gt;${EXEC}&lt;/exec&gt;
        &lt;!-- &lt;argument&gt;my_output=Hello Oozie&lt;/argument&gt; --&gt;
        &lt;file&gt;/user/hadoop/oozie_works/sereval-actions/${EXEC}#${EXEC}&lt;/file&gt;

        &lt;capture-output/&gt;
    &lt;/shell&gt;
    &lt;ok to=&quot;mr-node&quot;/&gt;
    &lt;error to=&quot;mr-node&quot;/&gt;
&lt;/action&gt;

 


&lt;action name=&quot;mr-node&quot;&gt;
        &lt;map-reduce&gt;
            &lt;job-tracker&gt;${jobTracker}&lt;/job-tracker&gt;
            &lt;name-node&gt;${nameNode}&lt;/name-node&gt;
            &lt;prepare&gt;
                &lt;delete path=&quot;${nameNode}/${outputDir}&quot;/&gt;
            &lt;/prepare&gt;
            &lt;configuration&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.job.queue.name&lt;/name&gt;
                    &lt;value&gt;${queueName}&lt;/value&gt;
                &lt;/property&gt;
              &lt;!-- 
                &lt;property&gt;
                    &lt;name&gt;mapred.mapper.class&lt;/name&gt;
                    &lt;value&gt;org.apache.oozie.example.SampleMapper&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.reducer.class&lt;/name&gt;
                    &lt;value&gt;org.apache.oozie.example.SampleReducer&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.map.tasks&lt;/name&gt;
                    &lt;value&gt;1&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.input.dir&lt;/name&gt;
                    &lt;value&gt;/user/${wf:user()}/${examplesRoot}/input-data/text&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.output.dir&lt;/name&gt;
                    &lt;value&gt;/user/${wf:user()}/${examplesRoot}/output-data/${outputDir}&lt;/value&gt;
                &lt;/property&gt;
              --&gt;
             
                 &lt;!-- 开启使用新的API来进行配置 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.mapper.new-api&lt;/name&gt;
                    &lt;value&gt;true&lt;/value&gt;
                &lt;/property&gt;

                &lt;property&gt;
                    &lt;name&gt;mapred.reducer.new-api&lt;/name&gt;
                    &lt;value&gt;true&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定MR的输出key的类型 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.output.key.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.io.Text&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定MR的输出的value的类型--&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.output.value.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.io.IntWritable&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定输入路径 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.input.dir&lt;/name&gt;
                    &lt;value&gt;${nameNode}/${inputdir}&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定输出路径 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.output.dir&lt;/name&gt;
                    &lt;value&gt;${nameNode}/${outputDir}&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定执行的map类 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.map.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.examples.WordCount$TokenizerMapper&lt;/value&gt;
                &lt;/property&gt;

                &lt;!-- 指定执行的reduce类 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapreduce.job.reduce.class&lt;/name&gt;
                    &lt;value&gt;org.apache.hadoop.examples.WordCount$IntSumReducer&lt;/value&gt;
                &lt;/property&gt;
              &lt;!--  配置map task的个数 --&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.map.tasks&lt;/name&gt;
                    &lt;value&gt;1&lt;/value&gt;
                &lt;/property&gt;

            &lt;/configuration&gt;
        &lt;/map-reduce&gt;
        &lt;ok to=&quot;hive2-node&quot;/&gt;
        &lt;error to=&quot;fail&quot;/&gt;
    &lt;/action&gt;

 &lt;action name=&quot;hive2-node&quot;&gt;
        &lt;hive2 xmlns=&quot;uri:oozie:hive2-action:0.1&quot;&gt;
            &lt;job-tracker&gt;${jobTracker}&lt;/job-tracker&gt;
            &lt;name-node&gt;${nameNode}&lt;/name-node&gt;
            &lt;prepare&gt;
                &lt;delete path=&quot;${nameNode}/user/${wf:user()}/${examplesRoot}/output-data/hive2&quot;/&gt;
                &lt;mkdir path=&quot;${nameNode}/user/${wf:user()}/${examplesRoot}/output-data&quot;/&gt;
            &lt;/prepare&gt;
            &lt;configuration&gt;
                &lt;property&gt;
                    &lt;name&gt;mapred.job.queue.name&lt;/name&gt;
                    &lt;value&gt;${queueName}&lt;/value&gt;
                &lt;/property&gt;
            &lt;/configuration&gt;
            &lt;jdbc-url&gt;${jdbcURL}&lt;/jdbc-url&gt;

            &lt;script&gt;script.q&lt;/script&gt;

            &lt;param&gt;INPUT=/user/${wf:user()}/${examplesRoot}/input-data/table&lt;/param&gt;
            &lt;param&gt;OUTPUT=/user/${wf:user()}/${examplesRoot}/output-data/hive2&lt;/param&gt;
        &lt;/hive2&gt;
        &lt;ok to=&quot;end&quot;/&gt;
        &lt;error to=&quot;fail&quot;/&gt;
    &lt;/action&gt;
&lt;decision name=&quot;check-output&quot;&gt;
    &lt;switch&gt;
        &lt;case to=&quot;end&quot;&gt;
            ${wf:actionData('shell-node')['my_output'] eq 'Hello Oozie'}
        &lt;/case&gt;
        &lt;default to=&quot;fail-output&quot;/&gt;
    &lt;/switch&gt;
&lt;/decision&gt;
&lt;kill name=&quot;fail&quot;&gt;
    &lt;message&gt;Shell action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]&lt;/message&gt;
&lt;/kill&gt;
&lt;kill name=&quot;fail-output&quot;&gt;
    &lt;message&gt;Incorrect output, expected [Hello Oozie] but was [${wf:actionData('shell-node')['my_output']}]&lt;/message&gt;
&lt;/kill&gt;
&lt;end name=&quot;end&quot;/&gt;
&lt;/workflow-app&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br></div></div><h4 id="_3-4-4-job-properties配置文件"><a href="#_3-4-4-job-properties配置文件" class="header-anchor">#</a> 3.4.4 job.properties配置文件</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/sereval-actions
vim  job.properties
nameNode=hdfs://node01:8020
jobTracker=node01:8032
queueName=default
examplesRoot=oozie_works
EXEC=hello.sh
outputDir=/oozie/output
inputdir=/oozie/input
jdbcURL=jdbc:hive2://node03:10000/default
oozie.use.system.libpath=true

# 配置我们文件上传到hdfs的保存路径 实际上就是在hdfs 的/user/root/oozie_works/sereval-actions这个路径下
oozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/sereval-actions/workflow.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_3-4-5-上传资源文件夹到hdfs对应路径"><a href="#_3-4-5-上传资源文件夹到hdfs对应路径" class="header-anchor">#</a> 3.4.5 上传资源文件夹到hdfs对应路径</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/

hdfs dfs -put sereval-actions/ /user/hadoop/oozie_works/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-4-6-执行调度任务"><a href="#_3-4-6-执行调度任务" class="header-anchor">#</a> 3.4.6 执行调度任务</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/

bin/oozie job -oozie http://node03:11000/oozie -config oozie_works/serveral-actions/job.properties -run
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-5、oozie的任务调度-定时任务执行"><a href="#_3-5、oozie的任务调度-定时任务执行" class="header-anchor">#</a> 3.5、oozie的任务调度,定时任务执行</h3> <div class="language- extra-class"><pre><code>	在oozie当中，主要是通过Coordinator 来实现任务的定时调度，与我们的workflow类似的，Coordinator 这个模块也是主要通过xml来进行配置即可，接下来我们就来看看如何配置Coordinator 来实现任务的定时调度
</code></pre></div><ul><li>Coordinator 的调度主要可以有两种实现方式
<ul><li>第一种：基于时间的定时任务调度，
oozie基于时间的调度主要需要指定三个参数，第一个起始时间，第二个结束时间，第三个调度频率</li> <li>第二种：基于数据的任务调度，只有在有了数据才会去出发执行
这种是基于数据的调度，只要在有了数据才会触发调度任务</li></ul></li></ul> <h4 id="_3-5-1-拷贝定时任务的调度模板"><a href="#_3-5-1-拷贝定时任务的调度模板" class="header-anchor">#</a> 3.5.1 拷贝定时任务的调度模板</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
cp -r examples/apps/cron oozie_works/cron-job
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-5-2-第二步-拷贝我们的hello-sh脚本"><a href="#_3-5-2-第二步-拷贝我们的hello-sh脚本" class="header-anchor">#</a> 3.5.2 第二步：拷贝我们的hello.sh脚本</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works
cp shell/hello.sh  cron-job/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-5-3-第三步-修改配置文件"><a href="#_3-5-3-第三步-修改配置文件" class="header-anchor">#</a> 3.5.3 第三步：修改配置文件</h4> <ul><li>job.properties</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/cron-job
vim job.properties

nameNode=hdfs://node01:8020
jobTracker=node01:8032
queueName=default
examplesRoot=oozie_works

oozie.coord.application.path=${nameNode}/user/${user.name}/${examplesRoot}/cron-job/coordinator.xml
start=2018-08-22T19:20+0800
end=2019-08-22T19:20+0800
EXEC=hello.sh
workflowAppUri=${nameNode}/user/${user.name}/${examplesRoot}/cron-job/workflow.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>coordinator.xml</li></ul> <div class="language-\ line-numbers-mode"><pre class="language-text"><code>
&lt;!--
    oozie的frequency 可以支持很多表达式，其中可以通过定时每分，或者每小时，或者每天，或者每月进行执行，也支持可以通过与linux的crontab表达式类似的写法来进行定时任务的执行
    例如frequency 也可以写成以下方式
    frequency=&quot;10 9 * * *&quot;  每天上午的09:10:00开始执行任务
    frequency=&quot;0 1 * * *&quot;  每天凌晨的01:00开始执行任务
 --&gt;
&lt;coordinator-app name=&quot;cron-job&quot; frequency=&quot;${coord:minutes(1)}&quot; start=&quot;${start}&quot; end=&quot;${end}&quot; timezone=&quot;GMT+0800&quot;
                 xmlns=&quot;uri:oozie:coordinator:0.4&quot;&gt;
        &lt;action&gt;
        &lt;workflow&gt;
            &lt;app-path&gt;${workflowAppUri}&lt;/app-path&gt;
            &lt;configuration&gt;
                &lt;property&gt;
                    &lt;name&gt;jobTracker&lt;/name&gt;
                    &lt;value&gt;${jobTracker}&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;nameNode&lt;/name&gt;
                    &lt;value&gt;${nameNode}&lt;/value&gt;
                &lt;/property&gt;
                &lt;property&gt;
                    &lt;name&gt;queueName&lt;/name&gt;
                    &lt;value&gt;${queueName}&lt;/value&gt;
                &lt;/property&gt;
            &lt;/configuration&gt;
        &lt;/workflow&gt;
    &lt;/action&gt;
&lt;/coordinator-app&gt;

修改workflow.xml
vim workflow.xml
&lt;workflow-app xmlns=&quot;uri:oozie:workflow:0.5&quot; name=&quot;one-op-wf&quot;&gt;
    &lt;start to=&quot;action1&quot;/&gt;
    &lt;action name=&quot;action1&quot;&gt;
    &lt;shell xmlns=&quot;uri:oozie:shell-action:0.2&quot;&gt;
        &lt;job-tracker&gt;${jobTracker}&lt;/job-tracker&gt;
        &lt;name-node&gt;${nameNode}&lt;/name-node&gt;
        &lt;configuration&gt;
            &lt;property&gt;
                &lt;name&gt;mapred.job.queue.name&lt;/name&gt;
                &lt;value&gt;${queueName}&lt;/value&gt;
            &lt;/property&gt;
        &lt;/configuration&gt;
        &lt;exec&gt;${EXEC}&lt;/exec&gt;
        &lt;!-- &lt;argument&gt;my_output=Hello Oozie&lt;/argument&gt; --&gt;
        &lt;file&gt;/user/hadoop/oozie_works/cron-job/${EXEC}#${EXEC}&lt;/file&gt;

        &lt;capture-output/&gt;
    &lt;/shell&gt;
    &lt;ok to=&quot;end&quot;/&gt;
    &lt;error to=&quot;end&quot;/&gt;
&lt;/action&gt;
    &lt;end name=&quot;end&quot;/&gt;
&lt;/workflow-app&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h4 id="_3-5-4-上传到hdfs对应路径"><a href="#_3-5-4-上传到hdfs对应路径" class="header-anchor">#</a> 3.5.4 上传到hdfs对应路径</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works
hdfs dfs -put cron-job/ /user/hadoop/oozie_works/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-5-5-运行定时任务"><a href="#_3-5-5-运行定时任务" class="header-anchor">#</a> 3.5.5 运行定时任务</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2

bin/oozie job -oozie http://node03:11000/oozie -config oozie_works/cron-job/job.properties -run
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-5-6-oozie当中任务的查看以及杀死"><a href="#_3-5-6-oozie当中任务的查看以及杀死" class="header-anchor">#</a> 3.5.6 oozie当中任务的查看以及杀死</h4> <ul><li>查看所有普通任务</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>oozie  jobs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>查看定时任务</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>oozie jobs -jobtype coordinator
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://gitee.com/kflys/uPic/raw/master/uPic/1613804115012-926d518d-9bd4-444f-9144-05696eb3dd4a.png" alt=""></p> <ul><li>杀死某个任务</li></ul> <p>oozie可以通过jobid来杀死某个定时任务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>oozie job -kill [id]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>例如我们可以使用命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>oozie job -kill 0000085-180628150519513-oozie-root-C
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>来杀死我们定时任务
<img src="https://gitee.com/kflys/uPic/raw/master/uPic/1613804115348-57e8e57e-cb6b-4be3-9919-d34556bfe377.png" alt=""></p> <h2 id="_4-hue整合oozie"><a href="#_4-hue整合oozie" class="header-anchor">#</a> 4. hue整合oozie</h2> <h3 id="_4-1-停止oozie与hue的进程"><a href="#_4-1-停止oozie与hue的进程" class="header-anchor">#</a> 4.1 停止oozie与hue的进程</h3> <p>通过命令停止oozie与hue的进程，准备修改oozie与hue的配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/oozied.sh stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-2-修改oozie的配置文件"><a href="#_4-2-修改oozie的配置文件" class="header-anchor">#</a> 4.2 修改oozie的配置文件</h3> <div class="language- extra-class"><pre><code>（老版本的bug，新版本已经不需要了）这一步我们都不需要做了
</code></pre></div><p>修改oozie的配置文件oozie-site.xml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;property&gt;   
	&lt;name&gt;oozie.service.WorkflowAppService.system.libpath&lt;/name&gt;
	&lt;value&gt;/user/oozie/share/lib&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
	&lt;name&gt;oozie.use.system.libpath&lt;/name&gt;
	&lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- extra-class"><pre><code>	重新上传所有的jar包到hdfs的/user/oozie/share/lib路径下去
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
bin/oozie-setup.sh  sharelib create -fs hdfs://node01:8020 -locallib oozie-sharelib-4.1.0-cdh5.14.2-yarn.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_4-3-修改hue的配置文件"><a href="#_4-3-修改hue的配置文件" class="header-anchor">#</a> 4.3 修改hue的配置文件</h3> <p>修改hue的配置文件hue.ini</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[liboozie]
  remote_deployement_dir=/user/hadoop/oozie_works

# 修改oozie的配置文件大概在1151行左右的样子
[oozie]
  oozie_jobs_count=100

  enable_cron_scheduling=true

  enable_document_action=true

  enable_oozie_backend_filtering=true

  enable_impala_action=true

[filebrowser]
  archive_upload_tempdir=/tmp

  show_download_button=true

  show_upload_button=true

  enable_extract_uploaded_archive=true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_4-4-启动hue与oozie的进程"><a href="#_4-4-启动hue与oozie的进程" class="header-anchor">#</a> 4.4 启动hue与oozie的进程</h3> <ul><li>启动hue进程</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/hue-3.9.0-cdh5.14.2
build/env/bin/supervisor
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>启动oozie进程</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /kfly/install/oozie-4.1.0-cdh5.14.2
bin/oozied.sh start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>页面访问hue</p> <p><a href="http://node03.hadoop.com:8888/" target="_blank" rel="noopener noreferrer">http://node03.hadoop.com:8888/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h2 id="_5-oozie使用过程当中可能遇到的问题"><a href="#_5-oozie使用过程当中可能遇到的问题" class="header-anchor">#</a> 5. oozie使用过程当中可能遇到的问题</h2> <h3 id="_5-1-mysql权限配置"><a href="#_5-1-mysql权限配置" class="header-anchor">#</a> 5.1 Mysql权限配置</h3> <div class="language- extra-class"><pre><code>	授权所有主机可以使用root用户操作所有数据库和数据表
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code> grant all on *.* to root@'%' identified by '123456' with grant option;
 
 flush privileges;
  
 exit; 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>workflow.xml配置的时候不要忽略file属性

jps查看进程时，注意有没有bootstrap

关闭oozie
 		如果bin/oozied.sh stop无法关闭，则可以使用kill -9 [pid]，之后oozie根目录下的oozie-server/temp/xxx.pid文件一定要删除。

Oozie重新打包时，一定要注意先关闭进程，删除对应文件夹下面的pid文件。（可以参考第4条目）

配置文件一定要生效
  	起始标签和结束标签无对应则不生效，配置文件的属性写错了，那么则执行默认的属性。

libext下边的jar存放于某个文件夹中，导致share/lib创建不成功。

修改Hadoop配置文件，需要重启集群。一定要记得scp到其他节点

JobHistoryServer必须开启，集群要重启的。

Mysql配置如果没有生效的话，默认使用derby数据库。

在本地修改完成的job配置，必须重新上传到HDFS。

将HDFS中上传的oozie配置文件下载下来查看是否有错误。

Linux用户名和Hadoop的用户名不一致。

sharelib找不到，包括重新初始化oozie
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_5-2-部署oozie出错"><a href="#_5-2-部署oozie出错" class="header-anchor">#</a> 5.2 部署oozie出错</h3> <ul><li>修复执行，初始化oozie，需要执行以下操作。
<ul><li>停止oozie（要通过jps检查bootstrap进程是否已经不存在）</li> <li>删除oozie-server/temp/</li> <li>删除HDFS上的sharelib文件夹</li> <li>删除oozie.sql文件，删除Mysql中删除oozie库，重新创建</li> <li>重新按照顺序执行文档中oozie的安装重新再来一遍</li></ul></li></ul></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://gitee.com/kflys/clivia-blog/edit/master/docs/01.大数据/10.大数据文章/10.大数据辅助框架/01.工作流调度引擎oozie.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=oozie" title="标签">#oozie</a><a href="/tags/?tag=hue" title="标签">#hue</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">10/14/2021, 5:07:46 PM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/ae8a76/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">图形化界面整合Hue</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/ae8a76/">图形化界面整合Hue</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/8e0b33/"><div>阿里官方Redis开发规范</div></a> <span>10-08</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/20a714/"><div>无监督学习</div></a> <span>01-26</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/e78220/"><div>模拟保存预加载</div></a> <span>01-26</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:clivia.pro@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://gitee.com/kflys" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://y.qq.com/n/ryqq/songDetail/003lgoEG1SWHmF" title="music" target="_blank" class="iconfont icon-erji"></a></div> <div><span> Theme by <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> | Powered by <a href="https://webify.cloudbase.net/" target="_blank">CloudBase Webify</a></span></div> <span>Clivia‘s <a href="https://gitee.com/kflys/clivia-blog" target="_blank">blog</a> </span>
    | Copyright © 2019-2022
    <span><a href="http://beian.miit.gov.cn/" target="_blank">皖ICP备2021014093号</a> </span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;left:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><!----></div></div></div>
    <script src="/assets/js/app.06f86fe0.js" defer></script><script src="/assets/js/2.ed69dcfc.js" defer></script><script src="/assets/js/3.b6cd915d.js" defer></script><script src="/assets/js/10.2b0a2d8d.js" defer></script>
  </body>
</html>