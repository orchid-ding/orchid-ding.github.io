(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{614:function(a,t,s){"use strict";s.r(t);var _=s(19),e=Object(_.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"_4-6-无监督学习-k-means算法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-无监督学习-k-means算法"}},[a._v("#")]),a._v(" 4.6 无监督学习-K-means算法")]),a._v(" "),s("h2",{attrs:{id:"学习目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#学习目标"}},[a._v("#")]),a._v(" 学习目标")]),a._v(" "),s("ul",[s("li",[a._v("目标\n"),s("ul",[s("li",[a._v("说明K-means算法原理")]),a._v(" "),s("li",[a._v("说明K-means的性能评估标准轮廓系数")]),a._v(" "),s("li",[a._v("说明K-means的优缺点")])])]),a._v(" "),s("li",[a._v("应用\n"),s("ul",[s("li",[a._v("instacart用户聚类")])])])]),a._v(" "),s("ul",[s("li",[a._v("内容预览\n"),s("ul",[s("li",[a._v("4.6.1 什么是无监督学习")]),a._v(" "),s("li",[a._v("4.6.2 无监督学习包含算法")]),a._v(" "),s("li",[a._v("4.6.3 K-means原理")]),a._v(" "),s("li",[a._v("4.6.4 K-meansAPI")]),a._v(" "),s("li",[a._v("4.6.5 案例：k-means对Instacart Market用户聚类")]),a._v(" "),s("li",[a._v("4.6.6 Kmeans性能评估指标")])])])]),a._v(" "),s("h4",{attrs:{id:"回忆非监督学习的特点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#回忆非监督学习的特点"}},[a._v("#")]),a._v(" 回忆非监督学习的特点？")]),a._v(" "),s("h2",{attrs:{id:"_4-6-1-什么是无监督学习"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-1-什么是无监督学习"}},[a._v("#")]),a._v(" 4.6.1 什么是无监督学习")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/03/22/uPic/mlib/images/%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0.png",alt:"K-means如何聚类效果"}})]),a._v(" "),s("ul",[s("li",[a._v("一家广告平台需要根据相似的人口学特征和购买\t\t\t习惯将美国人口分成不同的小组，以便广告客户可以通过有关联的广告接触到他们的目标客户。")]),a._v(" "),s("li",[a._v("Airbnb 需要将自己的房屋清单分组成不同的社区，以便用户能更轻松地查阅这些清单。")]),a._v(" "),s("li",[a._v("一个数据科学团队需要降低一个大型数据集的维度的数量，以便简化建模和降低文件大小。")])]),a._v(" "),s("p",[a._v("我们可以怎样最有用地对其进行归纳和分组？我们可以怎样以一种压缩格式有效地表征数据？"),s("strong",[a._v("这都是无监督学习的目标，之所以称之为无监督，是因为这是从无标签的数据开始学习的。")])]),a._v(" "),s("h2",{attrs:{id:"_4-6-2-无监督学习包含算法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-2-无监督学习包含算法"}},[a._v("#")]),a._v(" 4.6.2 无监督学习包含算法")]),a._v(" "),s("ul",[s("li",[a._v("聚类\n"),s("ul",[s("li",[a._v("K-means(K均值聚类)")])])]),a._v(" "),s("li",[a._v("降维\n"),s("ul",[s("li",[a._v("PCA")])])])]),a._v(" "),s("h2",{attrs:{id:"_4-6-3-k-means原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-3-k-means原理"}},[a._v("#")]),a._v(" 4.6.3 K-means原理")]),a._v(" "),s("p",[a._v("我们先来看一下一个K-means的聚类效果图")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/03/22/uPic/mlib/images/K-means%E5%A6%82%E4%BD%95%E8%81%9A%E7%B1%BB%E6%95%88%E6%9E%9C.png",alt:"K-means如何聚类效果"}})]),a._v(" "),s("h3",{attrs:{id:"k-means聚类步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#k-means聚类步骤"}},[a._v("#")]),a._v(" K-means聚类步骤")]),a._v(" "),s("ul",[s("li",[a._v("1、随机设置K个特征空间内的点作为初始的聚类中心")]),a._v(" "),s("li",[a._v("2、对于其他每个点计算到K个中心的距离，未知的点选择最近的一个聚类中心点作为标记类别")]),a._v(" "),s("li",[a._v("3、接着对着标记的聚类中心之后，重新计算出每个聚类的新中心点（平均值）")]),a._v(" "),s("li",[a._v("4、如果计算得出的新中心点与原中心点一样，那么结束，否则重新进行第二步过程")])]),a._v(" "),s("p",[a._v("我们以一张图来解释效果")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/03/22/uPic/mlib/images/K-means%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90.png",alt:"K-means过程分析"}})]),a._v(" "),s("h2",{attrs:{id:"_4-6-4-k-meansapi"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-4-k-meansapi"}},[a._v("#")]),a._v(" 4.6.4 K-meansAPI")]),a._v(" "),s("ul",[s("li",[a._v("sklearn.cluster.KMeans(n_clusters=8,init=‘k-means++’)\n"),s("ul",[s("li",[a._v("k-means聚类")]),a._v(" "),s("li",[a._v("n_clusters:开始的聚类中心数量")]),a._v(" "),s("li",[a._v("init:初始化方法，默认为'k-means ++’")]),a._v(" "),s("li",[a._v("labels_:默认标记的类型，可以和真实值比较（不是值比较）")])])])]),a._v(" "),s("h2",{attrs:{id:"_4-6-5-案例-k-means对instacart-market用户聚类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-5-案例-k-means对instacart-market用户聚类"}},[a._v("#")]),a._v(" 4.6.5 案例：k-means对Instacart Market用户聚类")]),a._v(" "),s("h3",{attrs:{id:"_1-分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-分析"}},[a._v("#")]),a._v(" 1 分析")]),a._v(" "),s("ul",[s("li",[a._v("1、降维之后的数据")]),a._v(" "),s("li",[a._v("2、k-means聚类")]),a._v(" "),s("li",[a._v("3、聚类结果显示")])]),a._v(" "),s("h3",{attrs:{id:"_2-代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-代码"}},[a._v("#")]),a._v(" 2 代码")]),a._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 取500个用户进行测试")]),a._v("\ncust "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nkm "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" KMeans"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("n_clusters"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nkm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("fit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("cust"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\npre "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" km"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("predict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("cust"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h4",{attrs:{id:"问题-如何去评估聚类的效果呢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题-如何去评估聚类的效果呢"}},[a._v("#")]),a._v(" 问题：如何去评估聚类的效果呢？")]),a._v(" "),s("h2",{attrs:{id:"_4-6-6-kmeans性能评估指标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-6-kmeans性能评估指标"}},[a._v("#")]),a._v(" 4.6.6 Kmeans性能评估指标")]),a._v(" "),s("h3",{attrs:{id:"_1-轮廓系数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-轮廓系数"}},[a._v("#")]),a._v(" 1 轮廓系数")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/03/22/uPic/mlib/images/%E8%BD%AE%E5%BB%93%E7%B3%BB%E6%95%B0%E5%85%AC%E5%BC%8F.png",alt:"轮廓系数公式"}})]),a._v(" "),s("blockquote",[s("p",[a._v("注：对于每个点i 为已聚类数据中的样本 ，b_i 为i 到其它族群的所有样本的距离最小值，a_i 为i 到本身簇的距离平均值。最终计算出所有的样本点的轮廓系数平均值")])]),a._v(" "),s("h3",{attrs:{id:"_2-轮廓系数值分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-轮廓系数值分析"}},[a._v("#")]),a._v(" 2 轮廓系数值分析")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/03/22/uPic/mlib/images/%E8%BD%AE%E5%BB%93%E7%B3%BB%E6%95%B0%E5%88%86%E6%9E%90.png",alt:"img"}})]),a._v(" "),s("ul",[s("li",[a._v("分析过程（我们以一个蓝1点为例）\n"),s("ul",[s("li",[a._v("1、计算出蓝1离本身族群所有点的距离的平均值a_i")]),a._v(" "),s("li",[a._v("2、蓝1到其它两个族群的距离计算出平均值红平均，绿平均，取最小的那个距离作为b_i")]),a._v(" "),s("li",[a._v("根据公式：极端值考虑：如果b_i >>a_i: 那么公式结果趋近于1；如果a_i>>>b_i: 那么公式结果趋近于-1")])])])]),a._v(" "),s("h3",{attrs:{id:"_3-结论"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-结论"}},[a._v("#")]),a._v(" 3 结论")]),a._v(" "),s("p",[s("strong",[a._v("如果b_i>>a_i:趋近于1效果越好， b_i<<a_i:趋近于-1，效果不好。轮廓系数的值是介于 [-1,1] ，越趋近于1代表内聚度和分离度都相对较优。")])]),a._v(" "),s("h3",{attrs:{id:"_4-轮廓系数api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-轮廓系数api"}},[a._v("#")]),a._v(" 4 轮廓系数API")]),a._v(" "),s("ul",[s("li",[a._v("sklearn.metrics.silhouette_score(X, labels)\n"),s("ul",[s("li",[a._v("计算所有样本的平均轮廓系数")]),a._v(" "),s("li",[a._v("X：特征值")]),a._v(" "),s("li",[a._v("labels：被聚类标记的目标值")])])])]),a._v(" "),s("h3",{attrs:{id:"_5-用户聚类结果评估"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-用户聚类结果评估"}},[a._v("#")]),a._v(" 5 用户聚类结果评估")]),a._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[a._v("silhouette_score"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("cust"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" pre"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"_4-6-7-k-means总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-7-k-means总结"}},[a._v("#")]),a._v(" 4.6.7 K-means总结")]),a._v(" "),s("ul",[s("li",[a._v("特点分析：采用迭代式算法，直观易懂并且非常实用")]),a._v(" "),s("li",[a._v("缺点：容易收敛到局部最优解(多次聚类)")])]),a._v(" "),s("blockquote",[s("p",[a._v("注意：聚类一般做在分类之前")])])])}),[],!1,null,null,null);t.default=e.exports}}]);