(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{500:function(s,a,n){"use strict";n.r(a);var e=n(19),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_1-sqoop介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-sqoop介绍"}},[s._v("#")]),s._v(" 1. Sqoop介绍")]),s._v(" "),n("p",[s._v("​\t\tSqoop是apache旗下的一款 ”Hadoop和关系数据库之间传输数据”的工具。数据导入：将MySQL，Oracle导入数据到Hadoop的HDFS、HIVE、HBASE等数据存储系统。导出数据：从Hadoop的文件系统中导出数据到关系数据库。")]),s._v(" "),n("h3",{attrs:{id:"_1-1-sqoop的工作机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-sqoop的工作机制"}},[s._v("#")]),s._v(" 1.1 Sqoop的工作机制")]),s._v(" "),n("ul",[n("li",[s._v("将导入和导出的命令翻译成mapreduce程序实现")]),s._v(" "),n("li",[s._v("在翻译出的mapreduce中主要是对inputformat和outputformat进行定制")])]),s._v(" "),n("h3",{attrs:{id:"_1-2-sqoop基本架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-sqoop基本架构"}},[s._v("#")]),s._v(" 1.2 Sqoop基本架构")]),s._v(" "),n("ul",[n("li",[s._v("sqoop在发展中的过程中演进出来了两种不同的架构.")]),s._v(" "),n("li",[s._v("架构演变史：https://blogs.apache.org/sqoop/entry/apache_sqoop_highlights_of_sqoop#comment-1561314193000")])]),s._v(" "),n("h4",{attrs:{id:"_1-2-1-版本号为1-4-x0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-版本号为1-4-x0"}},[s._v("#")]),s._v(" 1.2.1 版本号为1.4.x0")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613789783047-2bc79eb3-87a9-45db-8620-f49d1e8b9a8a.jpeg",alt:"image"}})]),s._v(" "),n("h4",{attrs:{id:"_1-2-2-版本号为1-99x为sqoop2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-版本号为1-99x为sqoop2"}},[s._v("#")]),s._v(" 1.2.2 版本号为1.99x为sqoop2")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/jpeg/434900/1613789783042-f97f65c4-0f98-4485-aef0-50e571f46611.jpeg",alt:"image"}})]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("在架构上：sqoop2引入了sqoop server，对connector实现了集中的管理 \n访问方式：REST API、 JAVA API、 WEB UI以及CLI控制台方式进行访问\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("![sqoop1 VS sqoop2](https://kflys.gitee.io/upic/2020/04/02/uPic/sqoop数据迁移工具/assets//sqoop1 VS sqoop2.png)")]),s._v(" "),n("h2",{attrs:{id:"_2-数据导入"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-数据导入"}},[s._v("#")]),s._v(" 2 数据导入")]),s._v(" "),n("p",[s._v("​\t\t导入单个表从RDBMS到HDFS。表中的每一行被视为HDFS的记录。所有记录都存储为文本文件的文本数据（或者Avro、sequence文件等二进制数据）")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("## 命令行查看帮助文档\nsqoop list-databases --help\n\n## 列出node03上mysql数据库中所有的数据库名称\nsqoop list-databases --connect jdbc:mysql://node03:3306/ --username root --password 123456\n\n## 查看某一个数据库下面的所有数据表\nsqoop list-tables --connect jdbc:mysql://node03:3306/hive --username root --password 123456\n\n## 导入数据库表数据到HDFS\nsqoop import \\\n  --connect jdbc:mysql://node02:3306/userdb \\\n  --username root   \\\n  --password 123456 \\\n  --table emp \\\n  --m 1\n  \n## 导出数据到指定目录,指定分隔符\nsqoop import  \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--delete-target-dir \\\n--table emp  \\\n--target-dir /sqoop/emp1 \\\n--fields-terminated-by '#' \\\n--m 1\n\n\n#参数解释\n--connect   指定mysql链接地址\n--username  连接mysql的用户名\n--password  连接mysql的密码\n--table     指定要导入的mysql表名称\n--m:        表示这个MR程序需要多少个MapTask去运行，默认为4\n--target-dir    来指定导出目的地，\n--delete-target-dir 来判断导出目录是否存在，如果存在就删掉\n--fields-terminated-by '#' 指定数据的分隔符\n## 默认路径是/user/hadoop下\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("--  导入关系表到Hive中\ncreate database sqooptohive;\n\ncreate external table sqooptohive.emp_hive(id int,name string,deg string,salary double ,dept string) row format delimited fields terminated by '\\001';\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("## 导入数据到hive表\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--table emp \\\n--fields-terminated-by '\\001' \\\n--hive-import \\\n--hive-table sqooptohive.emp_hive \\\n--hive-overwrite \\\n--delete-target-dir \\\n--m 1\n\n## 导入数据库表数据到hive中(并自动创建hive表)\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--table emp \\\n--hive-database sqooptohive \\\n--hive-table emp1 \\\n--hive-import \\\n--m 1 \n\n## 导入表数据子集\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--table emp \\\n--target-dir /sqoop/emp_where \\\n--delete-target-dir \\\n--where \"dept = 'TP'\" \\\n--m 1 \n\n## sql语句查找导入hive\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--target-dir /sqoop/emp_sql \\\n--delete-target-dir \\\n--query 'select * from emp where salary >30000 and $CONDITIONS' \\\n--m 1\n\n###  $CONTITONS是linux系统的变量，如果你想通过并行的方式导入结果，每个map task需要执行sql查询后脚语句的副本，结果会根据sqoop推测的边界条件分区。query必须包含$CONDITIONS。这样每个sqoop程序都会被替换为一个独立的条件。同时你必须指定 --split-by '字段'，后期是按照字段进行数据划分，最后可以达到多个MapTask并行运行。\n\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--target-dir /sqoop/emp_sql_2 \\\n--delete-target-dir \\\n--query 'select * from emp where salary >30000 and $CONDITIONS' \\\n--split-by 'id' \\\n--m 2\n\n\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--target-dir /sqoop/emp_sql_2 \\\n--delete-target-dir \\\n--query 'select * from emp where id >1 and $CONDITIONS' \\\n--split-by 'salary' \\\n--m 2\n\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--target-dir /sqoop/emp_sql_2 \\\n--delete-target-dir \\\n--query 'select * from emp where id >1 and $CONDITIONS' \\\n--split-by 'id' \\\n--m 7\n### --split-by '字段'： 后期按照字段进行数据划分实现并行运行多个MapTask。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br")])]),n("h3",{attrs:{id:"_2-1-增量导入"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-增量导入"}},[s._v("#")]),s._v(" 2.1 增量导入")]),s._v(" "),n("ul",[n("li",[s._v("在实际工作当中，数据的导入很多时候都是只需要导入增量数据即可，并不需要将表中的数据全部导入到hive或者hdfs当中去，肯定会出现重复的数据的状况，所以我们一般都是选用一些字段进行增量的导入，为了支持增量的导入，sqoop也给我们考虑到了这种情况并且支持增量的导入数据")]),s._v(" "),n("li",[s._v("增量导入是仅导入新添加的表中的行的技术。")]),s._v(" "),n("li",[s._v("它需要添加 ==‘incremental’, ‘check-column’, 和 ‘last-value’==选项来执行增量导入。")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("--incremental <mode>\n--check-column <column name>\n--last value <last check column value>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"_2-2-第一种增量导入实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-第一种增量导入实现"}},[s._v("#")]),s._v(" 2.2 第一种增量导入实现")]),s._v(" "),n("p",[s._v("基于递增列的增量数据导入（Append方式）")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("导入emp表当中id大于1202的所有数据")])]),s._v(" "),n("li",[n("ul",[n("li",[s._v("注意：这里不能加上 --delete-target-dir  参数，添加就报错")])])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--table emp \\\n--incremental append \\\n--check-column id \\\n--last-value 1202  \\\n--target-dir /sqoop/increment \\\n--m 1\n\n\n##参数解释\n--incremental   这里使用基于递增列的增量数据导入\n--check-column  递增列字段\n--last-value    指定上一次导入中检查列指定字段最大值\n--target-dir    数据导入的目录\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h3",{attrs:{id:"_2-3-第二种增量导入实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-第二种增量导入实现"}},[s._v("#")]),s._v(" 2.3 第二种增量导入实现")]),s._v(" "),n("p",[s._v("基于时间列的增量数据导入（LastModified方式）")]),s._v(" "),n("ul",[n("li",[s._v("此方式要求原有表中有time字段，它能指定一个时间戳")]),s._v(" "),n("li",[s._v("user表结构和数据")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613789782963-3f639094-07b6-4a8e-acbc-0ec761d46f1b.png",alt:"image"}})]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456  \\\n--table user \\\n--incremental lastmodified  \\\n--check-column createTime  \\\n--last-value '2019-10-01 10:30:00'  \\\n--target-dir /sqoop/increment2 \\\n--m 1\n\n##参数解释\n--incremental   这里使用基于时间列的增量导入\n--check-column  时间字段\n--last-value    指定上一次导入中检查列指定字段最大值\n--target-dir    数据导入的目录\n                如果该目录存在(可能已经有数据)\n                再使用的时候需要添加 --merge-key or --append\n        --merge-key 指定合并key（对于有修改的）\n        --append    直接追加修改的数据\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h2",{attrs:{id:"_3-mysql导入hbase"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-mysql导入hbase"}},[s._v("#")]),s._v(" 3. mysql导入hbase")]),s._v(" "),n("h3",{attrs:{id:"_3-1-mysql表数据导入到hbase中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-mysql表数据导入到hbase中"}},[s._v("#")]),s._v(" 3.1 mysql表数据导入到hbase中")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456  \\\n--table emp \\\n--hbase-table  mysqluser \\\n--column-family  f1 \\\n--hbase-create-table \\\n--hbase-row-key id  \\\n--m 1 \n\n\n#参数说明\n--hbase-table           指定hbase表名\n--column-family         指定表的列族\n--hbase-create-table    表不存在就创建\n--hbase-row-key         指定hbase表的id\n--m                     指定使用的MapTask个数\nlist\nscan 'mysqluser'\ndisable 'mysqluser'\ndrop 'mysqluser'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h3",{attrs:{id:"_3-2-mysql导入hbase-不同的列族"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-mysql导入hbase-不同的列族"}},[s._v("#")]),s._v(" 3.2 mysql导入hbase 不同的列族")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456  \\\n--columns id,salary,dept \\\n--table emp \\\n--hbase-table  mysqluser2 \\\n--column-family  f1 \\\n--hbase-create-table \\\n--hbase-row-key id  \\\n--m 1 \n\n\nsqoop import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456  \\\n--columns id,name,deg \\\n--table emp \\\n--hbase-table  mysqluser2 \\\n--column-family  f2 \\\n--hbase-create-table \\\n--hbase-row-key id  \\\n--m 1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("h2",{attrs:{id:"_4-数据导出"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-数据导出"}},[s._v("#")]),s._v(" 4. 数据导出")]),s._v(" "),n("p",[s._v("将数据从HDFS把文件导出到RDBMS数据库\\导出前，目标表必须存在于目标数据库中。")]),s._v(" "),n("ul",[n("li",[s._v("默认操作是从将文件中的数据使用INSERT语句插入到表中")]),s._v(" "),n("li",[s._v("更新模式下，是生成UPDATE语句更新表数据")])]),s._v(" "),n("h3",{attrs:{id:"_4-1-hdfs-mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-hdfs-mysql"}},[s._v("#")]),s._v(" 4.1 hdfs->mysql")]),s._v(" "),n("p",[s._v("数据是在HDFS当中的如下目录/user/hive/warehouse/hive_source，数据内容如下")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("1 zhangsan 20 hubei\n2 lisi 30 hunan\n3 wangwu 40 beijing\n4 xiaoming 50 shanghai\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("CREATE TABLE  userdb.fromhdfs (\n   id INT DEFAULT NULL,\n   name VARCHAR(100) DEFAULT NULL,\n   age int DEFAULT NULL,\n   address VARCHAR(100) DEFAULT NULL\n) ENGINE=INNODB DEFAULT CHARSET=utf8;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('sqoop export \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--table fromhdfs \\\n--export-dir /user/hive/warehouse/hive_source \\\n--input-fields-terminated-by " " \n\n##参数解释\n--table                       指定导出的mysql表名\n--export-dir                  指定hdfs数据文件目录\n--input-fields-terminated-by  指定文件数据字段的分隔符\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"_5-sqoop-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-sqoop-job"}},[s._v("#")]),s._v(" 5. Sqoop job")]),s._v(" "),n("p",[s._v("将事先定义好的数据导入导出任务按照指定流程运行")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop job (generic-args) (job-args)\n   [-- [subtool-name] (subtool-args)]\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_5-1-创建job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-创建job"}},[s._v("#")]),s._v(" 5.1 创建job")]),s._v(" "),n("p",[s._v('创建一个名为myjob,实现从mysql表数据导入到hdfs上的作业,在创建job时，命令"-- import" 中间有个空格。')]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop job --help\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"_5-2-创建一个sqoop-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-创建一个sqoop-job"}},[s._v("#")]),s._v(" 5.2 创建一个sqoop job")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop job \\\n--create myjob1 \\\n-- import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456 \\\n--table emp \\\n--target-dir /sqoop/myjob \\\n--delete-target-dir \\\n--m 1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h4",{attrs:{id:"_5-3-创建一个sqoop增量导入的job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-创建一个sqoop增量导入的job"}},[s._v("#")]),s._v(" 5.3 创建一个sqoop增量导入的job")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop  job  \\\n--create incrementJob1 \\\n-- import \\\n--connect jdbc:mysql://node03:3306/userdb \\\n--username root \\\n--password 123456  \\\n--table user \\\n--target-dir /sqoop/incrementJob \\\n--incremental append  \\\n--check-column createTime  \\\n--last-value '2019-11-19 16:40:21'  \\\n--m 1\n\n## incremental.last.value\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h3",{attrs:{id:"_5-4-查看job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-查看job"}},[s._v("#")]),s._v(" 5.4 查看job")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop job --list\n\n最后显示：\nAvailable jobs:\n  myjob\n## 展示job\nsqoop job --show myjob1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h4",{attrs:{id:"_5-5-执行job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-执行job"}},[s._v("#")]),s._v(" 5.5 执行job")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("  sqoop job --exec myjob1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"_5-6-解决sqoop需要输入密码的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-解决sqoop需要输入密码的问题"}},[s._v("#")]),s._v(" 5.6 解决sqoop需要输入密码的问题")]),s._v(" "),n("ul",[n("li",[s._v("vi sqoop-site.xml")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<property>\n    <name>sqoop.metastore.client.record.password</name>\n    <value>true</value>\n    <description>If true, allow saved passwords in the metastore.\n    </description>\n</property>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"_5-7-删除job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-删除job"}},[s._v("#")]),s._v(" 5.7 删除job")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sqoop job --delete myjob\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);