(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{544:function(s,a,t){"use strict";t.r(a);var n=t(19),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("https://www.elastic.co/guide/en/logstash/current/index.html")]),s._v(" "),t("h2",{attrs:{id:"_1-介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-介绍"}},[s._v("#")]),s._v(" 1 介绍")]),s._v(" "),t("blockquote",[t("p",[s._v("logstash就是一个具备实时数据传输能力的管道，负责将数据信息从管道的输入端传输到管道的输出端；与此同时这根管道还可以让你根据自己的需求在中间加上滤网，Logstash提供里很多功能强大的滤网以满足你的各种应用场景。是一个input | filter | output 的数据流。")])]),s._v(" "),t("h2",{attrs:{id:"_2-node01-机器-安装logstash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-node01-机器-安装logstash"}},[s._v("#")]),s._v(" 2 node01  机器  安装LogStash")]),s._v(" "),t("p",[s._v("下载logstache并上传到第一台服务器的/home/es路径下，然后进行解压")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/soft \nwget https://artifacts.elastic.co/downloads/logstash/logstash-6.7.0.tar.gz\n# 解压\ntar -zxf logstash-6.7.0.tar.gz -C /kkb/install/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_3-input插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-input插件"}},[s._v("#")]),s._v(" 3 Input插件")]),s._v(" "),t("h3",{attrs:{id:"_3-1-stdin标准输入和stdout标准输出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-stdin标准输入和stdout标准输出"}},[s._v("#")]),s._v(" 3.1 stdin标准输入和stdout标准输出")]),s._v(" "),t("p",[s._v("使用标准的输入与输出组件，实现将我们的数据从控制台输入，从控制台输出")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0/\nbin/logstash -e 'input{stdin{}}output{stdout{codec=>rubydebug}}'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/202111251019361.jpg",alt:"img"}})]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('{\n      "@version" => "1",\n          "host" => "node01",\n    "@timestamp" => 2018-10-13T08:33:13.126Z,\n       "message" => "hello"\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"_3-2-监控日志文件变化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-监控日志文件变化"}},[s._v("#")]),s._v(" 3.2 监控日志文件变化")]),s._v(" "),t("p",[s._v("​\t\tLogstash 使用一个名叫 "),t("em",[s._v("FileWatch")]),s._v(" 的 Ruby Gem 库来监听文件变化。这个库支持 glob 展开文件路径，而且会记录一个叫 "),t("em",[s._v(".sincedb")]),s._v(" 的数据库文件来跟踪被监听的日志文件的当前读取位置。所以，不要担心 logstash 会漏过你的数据。")]),s._v(" "),t("h5",{attrs:{id:"_3-2-1-编写脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-编写脚本"}},[s._v("#")]),s._v(" 3.2.1 编写脚本")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cd /kkb/install/logstash-6.7.0/config\n\nvim monitor_file.conf\n#输入一下信息 \n\ninput{\n    file{\n        path => "/kkb/install/datas/tomcat.log"\n        type => "log"\n        start_position => "beginning"\n    }\n}\noutput{\n        stdout{\n        codec=>rubydebug\n        }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h5",{attrs:{id:"_3-2-2-检查配置文件是否可用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-检查配置文件是否可用"}},[s._v("#")]),s._v(" 3.2.2 检查配置文件是否可用")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0/\n\nbin/logstash -f /kkb/install/logstash-6.7.0/config/monitor_file.conf -t\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("成功会出现一下信息：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Config Validation Result: OK. Exiting Logstash\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"_3-2-3-启动服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-启动服务"}},[s._v("#")]),s._v(" 3.2.3 启动服务")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0\nbin/logstash -f /kkb/install/logstash-6.7.0/config/monitor_file.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h5",{attrs:{id:"_3-2-4-发送数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-发送数据"}},[s._v("#")]),s._v(" 3.2.4 发送数据")]),s._v(" "),t("p",[s._v("新开xshell窗口通过以下命令发送数据")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('mkdir -p /kkb/install/datas\necho "hello logstash" >> /kkb/install/datas/tomcat.log\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h5",{attrs:{id:"_3-2-5-其它参数说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-5-其它参数说明"}},[s._v("#")]),s._v(" 3.2.5 其它参数说明")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Path=>表示监控的文件路径\nType=>给类型打标记，用来区分不同的文件类型。\nStart_postion=>从哪里开始记录文件，默认是从结尾开始标记，要是你从头导入一个文件就把改成”beginning”.\ndiscover_interval=>多久去监听path下是否有文件，默认是15s\nexclude=>排除什么文件\nclose_older=>一个已经监听中的文件，如果超过这个值的时间内没有更新内容，就关闭监听它的文件句柄。默认是3600秒，即一个小时。\nsincedb_path=>监控库存放位置(默认的读取文件信息记录在哪个文件中)。默认在：/data/plugins/inputs/file。\nsincedb_write_interval=> logstash 每隔多久写一次 sincedb 文件，默认是 15 秒。\nstat_interval=>logstash 每隔多久检查一次被监听文件状态（是否有更新），默认是 1 秒。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_3-3-jdbc插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-jdbc插件"}},[s._v("#")]),s._v(" 3.3 jdbc插件")]),s._v(" "),t("p",[s._v("jdbc插件允许我们采集某张数据库表当中的数据到我们的logstashe当中来")]),s._v(" "),t("h5",{attrs:{id:"_3-3-1-编写脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-编写脚本"}},[s._v("#")]),s._v(" 3.3.1 编写脚本")]),s._v(" "),t("p",[s._v("开发脚本配置文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cd /kkb/install/logstash-6.7.0/config\nvim jdbc.conf\n\ninput {\n  jdbc {\n    jdbc_driver_library => "/kkb/install/mysql-connector-java-5.1.38.jar"\n    jdbc_driver_class => "com.mysql.jdbc.Driver"\n    jdbc_connection_string => "jdbc:mysql://192.168.31.82:3306/mydb"\n    jdbc_user => "root"\n    jdbc_password => "123456"\n\n    use_column_value => true\n    tracking_column => "tno"\n  #  parameters => { "favorite_artist" => "Beethoven" }\n    schedule => "* * * * *"\n    statement => "SELECT * from courses where tno > :sql_last_value ;"\n  }\n}\n\noutput{\n        stdout{\n        codec=>rubydebug\n        }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("h5",{attrs:{id:"_3-3-2-上传-mysql连接驱动包到指定路劲"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-上传-mysql连接驱动包到指定路劲"}},[s._v("#")]),s._v(" 3.3.2 上传  mysql连接驱动包到指定路劲")]),s._v(" "),t("p",[s._v("将我们mysql的连接驱动包上传到我们指定的/kkb/install/路径下")]),s._v(" "),t("h5",{attrs:{id:"_3-3-3-检查配置文件是否可用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-检查配置文件是否可用"}},[s._v("#")]),s._v(" 3.3.3 检查配置文件是否可用")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0/\n\nbin/logstash -f /kkb/install/logstash-6.7.0/config/jdbc.conf  -t\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("通过之后")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Config Validation Result: OK. Exiting Logstash\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"_3-3-4-启动服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-4-启动服务"}},[s._v("#")]),s._v(" 3.3.4 启动服务")]),s._v(" "),t("p",[s._v("通过以下命令启动logstash")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0\n\nbin/logstash -f /kkb/install/logstash-6.7.0/config/jdbc.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h5",{attrs:{id:"_3-3-5-数据库当中添加数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-5-数据库当中添加数据"}},[s._v("#")]),s._v(" 3.3.5 数据库当中添加数据")]),s._v(" "),t("p",[s._v("在我们的数据库当中手动随便插入数据，发现我们的logstash可以进行收集")]),s._v(" "),t("h3",{attrs:{id:"_3-4-systlog插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-systlog插件"}},[s._v("#")]),s._v(" 3.4 systlog插件")]),s._v(" "),t("p",[t("strong",[s._v("syslog机制负责记录内核和应用程序产生的日志信息，管理员可以通过查看日志记录，来掌握系统状况")])]),s._v(" "),t("p",[s._v("默认系统已经安装了rsyslog.直接启动即可")]),s._v(" "),t("h5",{attrs:{id:"_3-4-1-编写脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-1-编写脚本"}},[s._v("#")]),s._v(" 3.4.1 编写脚本")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cd /kkb/install/logstash-6.7.0/config\nvim syslog.conf\n\ninput{\n    tcp{\n        port=> 6789\n        type=> syslog\n    }\n    udp{\n        port=> 6789\n        type=> syslog\n    }\n}\n\nfilter{\n    if [type] == "syslog" {\n        grok {\n                match => { "message" => "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\\[%{POSINT:syslog_pid}\\])?: %{GREEDYDATA:syslog_message}" }\n                add_field => [ "received_at", "%{@timestamp}" ]\n                add_field => [ "received_from", "%{host}" ]\n        }\n       date {\n             match => [ "syslog_timestamp", "MMM  d HH:mm:ss", "MMM dd HH:mm:ss" ]\n           }\n    }\n}\n\noutput{\n    stdout{\n        codec=> rubydebug\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br")])]),t("h5",{attrs:{id:"_3-4-2-检查配置文件是否可用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-2-检查配置文件是否可用"}},[s._v("#")]),s._v(" 3.4.2 检查配置文件是否可用")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0\nbin/logstash -f /kkb/install/logstash-6.7.0/config/syslog.conf -t\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h5",{attrs:{id:"_3-4-3-启动服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-3-启动服务"}},[s._v("#")]),s._v(" 3.4.3 启动服务")]),s._v(" "),t("p",[s._v("执行以下命令启动logstash服务")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0\nbin/logstash -f /kkb/install/logstash-6.7.0/config/syslog.conf\\\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h5",{attrs:{id:"_3-4-4-发送数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-4-发送数据"}},[s._v("#")]),s._v(" 3.4.4 发送数据")]),s._v(" "),t("p",[t("em",[s._v("修改**系统日志配置文件")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo vim /etc/rsyslog.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("添加一行以下配置")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("*.* @@node01:6789\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/202111241755080.jpg",alt:"img"}})]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 重启系统日志服务\n\nsudo systemctl restart rsyslog\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h5",{attrs:{id:"_3-4-5-其它参数说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-5-其它参数说明"}},[s._v("#")]),s._v(" 3.4.5 其它参数说明")]),s._v(" "),t("p",[s._v("在logstash中的grok是正则表达式，用来解析当前数据")]),s._v(" "),t("p",[s._v("原始数据其实是：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('Dec 23 12:11:43 louis postfix/smtpd[31499]: connect from unknown[95.75.93.154]\nJun 05 08:00:00 louis named[16000]: client 199.48.164.7#64817: query (cache) \'amsterdamboothuren.com/MX/IN\' denied\nJun 05 08:10:00 louis CRON[620]: (www-data) CMD (php /usr/share/cacti/site/poller.php >/dev/null 2>/var/log/cacti/poller-error.log)\nJun 05 08:05:06 louis rsyslogd: [origin software="rsyslogd" swVersion="4.2.0" x-pid="2253" x-info="http://www.rsyslog.com"] rsyslogd was HUPed, type \'lightweight\'.\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_4、filter插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、filter插件"}},[s._v("#")]),s._v(" 4、filter插件")]),s._v(" "),t("p",[s._v("Logstash之所以强悍的主要原因是filter插件；通过过滤器的各种组合可以得到我们想要的结构化数据。")]),s._v(" "),t("ul",[t("li",[s._v("grok正则表达式")])]),s._v(" "),t("p",[s._v("grok正则表达式是logstash非常重要的一个环节；可以通过grok非常方便的将数据拆分和索引")]),s._v(" "),t("p",[s._v("语法格式：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("(?<name>pattern)   \n？<name>表示要取出里面的值，pattern就是正则表达式 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_4-1-收集控制台输入数据-采集日期-时间-出来"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-收集控制台输入数据-采集日期-时间-出来"}},[s._v("#")]),s._v(" 4.1 收集控制台输入数据，采集日期  时间  出来")]),s._v(" "),t("h4",{attrs:{id:"_4-1-1-开发配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-开发配置文件"}},[s._v("#")]),s._v(" 4.1.1 开发配置文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cd /kkb/install/logstash-6.7.0/config/\nvim filter.conf\ninput {stdin{}} filter {\n        grok {\n                match => {\n"message" => "(?<date>\\d+\\.\\d+)\\s+"\n                }       \n        }       \n}       \noutput {stdout{codec => rubydebug}}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"_4-1-2-启动logstash服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-启动logstash服务"}},[s._v("#")]),s._v(" 4.1.2 启动logstash服务*")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0/\n\nbin/logstash -f /kkb/install/logstash-6.7.0/config/filter.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"_4-1-3-控制台输入文字"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-控制台输入文字"}},[s._v("#")]),s._v(" 4.1.3 控制台输入文字")]),s._v(" "),t("p",[s._v("5.20 今天天气还不错")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/202111251030121.jpg",alt:"img"}})]),s._v(" "),t("h3",{attrs:{id:"_4-2-使用grok收集nginx日志数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-使用grok收集nginx日志数据"}},[s._v("#")]),s._v(" 4.2 使用grok收集nginx日志数据")]),s._v(" "),t("p",[s._v("nginx一般打印出来的日志格式如下")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('36.157.150.1 - - [05/Nov/2018:12:59:28 +0800] "GET /phpmyadmin_8c1019c9c0de7a0f/js/get_scripts.js.php?scripts%5B%5D=jquery/jquery-1.11.1.min.js&scripts%5B%5D=sprintf.js&scripts%5B%5D=ajax.js&scripts%5B%5D=keyhandler.js&scripts%5B%5D=jquery/jquery-ui-1.11.2.min.js&scripts%5B%5D=jquery/jquery.cookie.js&scripts%5B%5D=jquery/jquery.mousewheel.js&scripts%5B%5D=jquery/jquery.event.drag-2.2.js&scripts%5B%5D=jquery/jquery-ui-timepicker-addon.js&scripts%5B%5D=jquery/jquery.ba-hashchange-1.3.js HTTP/1.1" 200 139613 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这种日志是非格式化的，通常，我们获取到日志后，还要使用mapreduce 或者spark 做一下清洗操作，")]),s._v(" "),t("p",[s._v("就是将非格式化日志编程格式化日志；")]),s._v(" "),t("p",[s._v("在清洗的时候，如果日志的数据量比较大，那么也是需要花费一定的时间的；")]),s._v(" "),t("p",[s._v("所以可以使用logstash 的grok 功能，将nginx 的非格式化数据采集成格式化数据：")]),s._v(" "),t("h4",{attrs:{id:"_4-2-1-安装grok插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-安装grok插件"}},[s._v("#")]),s._v(" 4.2.1 安装grok插件")]),s._v(" "),t("h6",{attrs:{id:"_1-第一种-在线安装-不推荐"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-第一种-在线安装-不推荐"}},[s._v("#")]),s._v(" 1. 第一种  在线安装  （不推荐  ）")]),s._v(" "),t("p",[s._v("在线安装grok插件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0/\nvim Gemfile\n\n#source 'https://rubygems.org'    # 将这个镜像源注释掉\nsource https://gems.ruby-china.com/  # 配置成中国的这个镜像源\n\n准备在线安装\ncd /kkb/install/logstash-6.7.0/\nbin/logstash-plugin  install logstash-filter-grok\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h6",{attrs:{id:"_2-第二种-安装方式-直接使用已经下载好的安装包进行本地安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-第二种-安装方式-直接使用已经下载好的安装包进行本地安装"}},[s._v("#")]),s._v(" 2. 第二种  安装方式，直接使用已经下载好的安装包进行本地安装")]),s._v(" "),t("p",[s._v("上传我们的压缩包logstash-filter-grok-4.0.4.zip上传到/kkb/install/logstash-6.7.0 这个路径下面")]),s._v(" "),t("p",[s._v("然后准备执行本地安装")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0/\nbin/logstash-plugin install file:///kkb/install/logstash-6.7.0/logstash-filter-grok-4.0.4.zip\n\n# 安装成功之后查看logstash的插件列表\n\ncd /kkb/install/logstash-6.7.0/\nbin/logstash-plugin list\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"_4-2-2-开发logstash的配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-开发logstash的配置文件"}},[s._v("#")]),s._v(" 4.2.2 开发logstash的配置文件")]),s._v(" "),t("p",[s._v("定义logstash的配置文件如下，我们从控制台输入nginx的日志数据，然后经过filter的过滤，将我们的日志文件转换成为标准的数据格式")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cd /kkb/install/logstash-6.7.0/config\nvim monitor_nginx.conf\n\ninput {stdin{}}\nfilter {\ngrok {\nmatch => {\n"message" => "%{IPORHOST:clientip} \\- \\- \\[%{HTTPDATE:time_local}\\] \\"(?:%{WORD:method} %{NOTSPACE:request}(?:HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})\\" %{NUMBER:status} %{NUMBER:body_bytes_sent} %{QS:http_referer} %{QS:agent}"\n         }\n     }\n}\noutput {stdout{codec => rubydebug}}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h4",{attrs:{id:"_4-2-3-启动logstash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-启动logstash"}},[s._v("#")]),s._v(" 4.2.3 启动logstash")]),s._v(" "),t("p",[s._v("执行以下命令启动logstash")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0\n\nbin/logstash -f /kkb/install/logstash-6.7.0/config/monitor_nginx.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"_4-2-4-从控制台输入-nginx-日志文件数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-从控制台输入-nginx-日志文件数据"}},[s._v("#")]),s._v(" 4.2.4 从控制台输入  nginx  日志文件数据")]),s._v(" "),t("ul",[t("li",[s._v("输入第一条数据")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('36.157.150.1 - - [05/Nov/2018:12:59:27 +0800] "GET /phpmyadmin_8c1019c9c0de7a0f/js/messages.php?lang=zh_CN&db=&collation_connection=utf8_unicode_ci&token=6a44d72481633c90bffcfd42f11e25a1 HTTP/1.1" 200 8131 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("输入第二条数据")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('36.157.150.1 - - [05/Nov/2018:12:59:28 +0800] "GET /phpmyadmin_8c1019c9c0de7a0f/js/get_scripts.js.php?scripts%5B%5D=jquery/jquery-1.11.1.min.js&scripts%5B%5D=sprintf.js&scripts%5B%5D=ajax.js&scripts%5B%5D=keyhandler.js&scripts%5B%5D=jquery/jquery-ui-1.11.2.min.js&scripts%5B%5D=jquery/jquery.cookie.js&scripts%5B%5D=jquery/jquery.mousewheel.js&scripts%5B%5D=jquery/jquery.event.drag-2.2.js&scripts%5B%5D=jquery/jquery-ui-timepicker-addon.js&scripts%5B%5D=jquery/jquery.ba-hashchange-1.3.js HTTP/1.1" 200 139613 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_5-output插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-output插件"}},[s._v("#")]),s._v(" 5  Output插件")]),s._v(" "),t("h3",{attrs:{id:"_5-1-标准输出到控制台"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-标准输出到控制台"}},[s._v("#")]),s._v(" 5.1 标准输出到控制台")]),s._v(" "),t("p",[s._v("将我们收集的数据直接打印到控制台")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("output {\n    stdout {\n        codec => rubydebug\n    }\n}\n\nbin/logstash -e 'input{stdin{}}output{stdout{codec=>rubydebug}}'\n[es@node01 logstash]$ bin/logstash -e 'input{stdin{}}output{stdout{codec=>rubydebug}}'\nhello\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_5-2-将采集数据保存到file文件中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-将采集数据保存到file文件中"}},[s._v("#")]),s._v(" 5.2 将采集数据保存到file文件中")]),s._v(" "),t("p",[s._v("logstash也可以将收集到的数据写入到文件当中去永久保存，接下来我们来看看logstash如何配置以实现将数据写入到文件当中")]),s._v(" "),t("h4",{attrs:{id:"_5-2-1-开发logstash的配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-1-开发logstash的配置文件"}},[s._v("#")]),s._v(" 5.2.1 开发logstash的配置文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cd /kkb/install/logstash-6.7.0/config\nvim output_file.conf\n\ninput {stdin{}}\noutput {\n    file {\n        path => "/kkb/install/datas/%{+YYYY-MM-dd}-%{host}.txt"\n        codec => line {\n            format => "%{message}"\n        }\n        flush_interval => 0\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h4",{attrs:{id:"_5-2-2-检测-配置-文件并启动logstash服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-2-检测-配置-文件并启动logstash服务"}},[s._v("#")]),s._v(" 5.2.2 检测  配置  文件并启动logstash服务")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /kkb/install/logstash-6.7.0\n\n# 检测配置文件是否正确\nbin/logstash -f config/output_file.conf -t\n\n# 启动服务，然后从控制台输入一些数据\nbin/logstash -f config/output_file.conf\n\n# 查看文件写入的内容\ncd /kkb/install/datas\nmore 2018-11-08-node01.hadoop.com.txt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/202111251036515.jpg",alt:"img"}})]),s._v(" "),t("h3",{attrs:{id:"_5-3-将采集数据保存到elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-将采集数据保存到elasticsearch"}},[s._v("#")]),s._v(" 5.3 将采集数据保存到elasticsearch")]),s._v(" "),t("h4",{attrs:{id:"_5-3-1-开发logstash的配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-开发logstash的配置文件"}},[s._v("#")]),s._v(" 5.3.1 开发logstash的配置文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cd /kkb/install/logstash-6.7.0/config\nvim output_es.conf\ninput {stdin{}}\noutput {\n    elasticsearch {\n        hosts => ["node01:9200"]\n        index => "logstash-%{+YYYY.MM.dd}"\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("​\t\t这个index是保存到elasticsearch上的索引名称，如何命名特别重要，因为我们很可能后续根据某些需求做查询，所以最好带时间，因为我们在中间加上type，就代表不同的业务，这样我们在查询当天数据的时候，就可以根据类型+时间做范围查询")]),s._v(" "),t("h4",{attrs:{id:"_5-3-2-检测配置文件并启动logstash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-检测配置文件并启动logstash"}},[s._v("#")]),s._v(" 5.3.2 检测配置文件并启动logstash")]),s._v(" "),t("p",[s._v("检测配置文件是否正确")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 检测配置文件是否正确\ncd /kkb/install/logstash-6.7.0\nbin/logstash -f config/output_es.conf -t \n\n# 启动logstash\nbin/logstash -f config/output_es.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("img",{staticStyle:{zoom:"150%"},attrs:{src:"C:\\Users\\kfly\\AppData\\Local\\Temp\\ksohtml\\wpsE6BC.tmp.jpg",alt:"img"}}),s._v(" "),t("h4",{attrs:{id:"_5-3-3-es-当中查看数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-3-es-当中查看数据"}},[s._v("#")]),s._v(" 5.3.3 es  当中查看数据")]),s._v(" "),t("p",[s._v("访问")]),s._v(" "),t("p",[s._v("http://node01:9100/")]),s._v(" "),t("p",[s._v("查看es当中的数据")]),s._v(" "),t("img",{staticStyle:{zoom:"150%"},attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/202111251039053.jpg",alt:"img"}}),s._v(" "),t("p",[s._v("注意：")]),s._v(" "),t("p",[s._v("更多的input，filter，output组件参见以下链接")]),s._v(" "),t("p",[s._v("https://www.elastic.co/guide/en/logstash/current/index.html")])])}),[],!1,null,null,null);a.default=e.exports}}]);