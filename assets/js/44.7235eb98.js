(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{531:function(s,a,e){"use strict";e.r(a);var n=e(19),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v('前面我们已经通过sparkStreaming的程序解析kafka当中业务库的数据，将数据全部都落地到了Hbase当中的四张表（order_info","renter_info","driver_info","opt_alliance_business\n）里面去了，针对以上订单表，司机表，用户表，司管方表等，我们可以针对以上存储在Hbase当中的数据进行统计分析，通过sparkSQL读取Hbase当中的数据，实现数据的统计分析，然后将统计分析的结果，通过sparkSQL自定义输出源，保存到Hbase里面去。这里涉及到通过自定义sparkSQL的Hbase数据源来实现读取Hbase的数据，以及自定义sparkSQL的数据保存，将统计的结果保存到Hbase里面去')]),s._v(" "),e("h2",{attrs:{id:"_1、sparksql自定义数据源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、sparksql自定义数据源"}},[s._v("#")]),s._v(" 1、sparkSQL自定义数据源")]),s._v(" "),e("h3",{attrs:{id:"_1、创建hbase数据源表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建hbase数据源表"}},[s._v("#")]),s._v(" 1、创建hbase数据源表")]),s._v(" "),e("p",[s._v("为了实现我们的sparkSQL自定义数据源获取Hbase当中的数据，我们可以开发测试用例，通过自定义数据源实现获取Hbase当中的数据，然后将查询的数据保存到Hbase里面去")]),s._v(" "),e("ul",[e("li",[s._v("node01执行以下命令创建Hbase表")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/hbase-1.2.0-cdh5.14.2/\nbin/hbase shell\n\ncreate 'spark_hbase_sql','cf'\n\nput 'spark_hbase_sql','0001','cf:name','zhangsan'\nput 'spark_hbase_sql','0001','cf:score','80'\nput 'spark_hbase_sql','0002','cf:name','lisi'\nput 'spark_hbase_sql','0002','cf:score','60'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h3",{attrs:{id:"_2、创建hbase的数据保存表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、创建hbase的数据保存表"}},[s._v("#")]),s._v(" 2、创建Hbase的数据保存表")]),s._v(" "),e("ul",[e("li",[s._v("node01执行以下命令创建Hbase表，用于将分析之后的结果数据保存到Hbase当中来")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/hbase-1.2.0-cdh5.14.2/\n\nbin/hbase shell\ncreate 'spark_hbase_write','cf'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_3、自定义sparksql的数据源读取hbase数据以及将分析结果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、自定义sparksql的数据源读取hbase数据以及将分析结果"}},[s._v("#")]),s._v(" 3、自定义SparkSQL的数据源读取Hbase数据以及将分析结果")]),s._v(" "),e("p",[s._v("关于sparkSQL自定义数据源，参见以下文章\n"),e("a",{attrs:{href:"https://blog.csdn.net/zjerryj/article/details/84922369",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/zjerryj/article/details/84922369"),e("OutboundLink")],1),s._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/niutao/p/10801259.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/niutao/p/10801259.html"),e("OutboundLink")],1),s._v("\n在我们的travel_spark这个项目模块下，创建package com.travel.programApp，然后在这个package下面创建scala的object文件HbaseSourceAndSink.scala")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('import java.util\nimport java.util.Optional\nimport com.travel.utils.HbaseTools\nimport org.apache.hadoop.hbase.TableName\nimport org.apache.hadoop.hbase.client._\nimport org.apache.hadoop.hbase.util.Bytes\nimport org.apache.spark.sql.sources.v2.reader._\nimport org.apache.spark.sql.sources.v2.writer.{DataSourceWriter, DataWriter, DataWriterFactory, WriterCommitMessage}\nimport org.apache.spark.sql.sources.v2.{DataSourceOptions, DataSourceV2, ReadSupport, WriteSupport}\nimport org.apache.spark.sql.types.StructType\nimport org.apache.spark.sql.{DataFrame, Row, SaveMode, SparkSession}\n\nobject HBaseSourceAndSink {\n  def main(args: Array[String]): Unit = {\n    val spark = SparkSession\n      .builder()\n      .master("local[2]")\n      .getOrCreate()\n\n    val df = spark.read\n      .format("com.travel.programApp.HBaseSource")\n      .option("hbase.table.name", "spark_hbase_sql")\n      .option("schema", "`name` STRING,`score` STRING")\n      .option("cf.cc","cf:name,cf:score")\n      .load()\n    df.explain(true)\n\n    df.createOrReplaceTempView("sparkHBaseSQL")\n\n    df.printSchema()\n\n    val frame: DataFrame = spark.sql("select * from sparkHBaseSQL where score > 60")\n\n    frame.write.format("com.travel.programApp.HBaseSource")\n      .mode(SaveMode.Overwrite)\n      .option("hbase.table.name","spark_hbase_write")\n      .save()\n\n  }\n}\n\nclass HBaseSource extends DataSourceV2 with ReadSupport with WriteSupport{\n  override def createReader(options: DataSourceOptions): DataSourceReader = {\n    new HBaseDataSourceReader(options.get("hbase.table.name").get(),options.get("schema").get(),options.get("cf.cc").get())\n  }\n\n  override def createWriter(jobId: String, schema: StructType, mode: SaveMode, options: DataSourceOptions): Optional[DataSourceWriter] = {\n    Optional.of(new HBaseDataSourceWrite)\n\n  }\n}\n\nclass HBaseDataSourceWrite extends DataSourceWriter{\n  override def createWriterFactory(): DataWriterFactory[Row] = {\n    new HBaseDataWriterFactory\n  }\n\n  override def commit(messages: Array[WriterCommitMessage]): Unit = {\n\n  }\n\n  override def abort(messages: Array[WriterCommitMessage]): Unit = {\n\n  }\n}\n\n\nclass HBaseDataWriterFactory extends DataWriterFactory[Row]{\n  override def createDataWriter(partitionId: Int, attemptNumber: Int): DataWriter[Row] = {\n    new HBaseDataWriter\n  }\n}\n\n\nclass HBaseDataWriter extends DataWriter[Row]{\n\n  private val conn: Connection = HbaseTools.getHbaseConn\n\n  private val table: Table = conn.getTable(TableName.valueOf("spark_hbase_write"))\n\n  override def write(record: Row): Unit = {\n    val name: String = record.getString(0)\n    val score: String = record.getString(1)\n\n    val put = new Put("0001".getBytes())\n    put.addColumn("cf".getBytes(),"name".getBytes(),name.getBytes())\n    put.addColumn("cf".getBytes(),"score".getBytes(),score.getBytes())\n\n    table.put(put)\n\n  }\n\n  override def commit(): WriterCommitMessage = {\n    table.close()\n    conn.close()\n    null\n\n  }\n\n  override def abort(): Unit = {\n    null\n\n  }\n}\n\nclass HBaseDataSourceReader(tableName:String,schema:String,cfcc:String) extends DataSourceReader  {\n  _//定义HBase的schema_\n  private val structType: StructType = StructType.fromDDL(schema)\n  override def readSchema(): StructType = {\n    structType\n  }\n  _//返回DataReaderFactory_\n  override def createDataReaderFactories(): util.List[DataReaderFactory[Row]] = {\n    import collection.JavaConverters._\n    Seq(\n    new HBaseReaderFactory(tableName,cfcc).asInstanceOf[DataReaderFactory[Row]]\n    ).asJava\n  }\n\n}\n\n\nclass HBaseReaderFactory(tableName:String,cfcc:String) extends  DataReaderFactory[Row] {\n  override def createDataReader(): DataReader[Row] = {\n    new HBaseReader(tableName,cfcc)\n  }\n}\n\nclass HBaseReader(tableName:String,cfcc:String) extends DataReader[Row] {\n\n  private var hbaseConnection:Connection = null\n  private var  resultScanner:ResultScanner = null\n\n  private var nextResult:Result  = null\n\n  _// 获取HBase当中的数_\n  val data: Iterator[Seq[AnyRef]] = getIterator\n\n  def getIterator: Iterator[Seq[AnyRef]] = {\n    import scala.collection.JavaConverters._\n    hbaseConnection = HbaseTools.getHbaseConn\n    val table: Table = hbaseConnection.getTable(TableName.valueOf(tableName))\n    resultScanner = table.getScanner(new Scan())\n    val iterator: Iterator[Seq[AnyRef]] = resultScanner.iterator().asScala.map(eachResult => {\n      val str: String = Bytes.toString(eachResult.getValue("cf".getBytes(), "name".getBytes()))\n      val score: String = Bytes.toString(eachResult.getValue("cf".getBytes(), "score".getBytes()))\n      Seq(str, score)\n    })\n    iterator\n  }\n  override def next(): Boolean = {\n    data.hasNext\n  }\n  override def get(): Row = {\n    val seq: Seq[Any] = data.next()\n    Row.fromSeq(seq)\n  }\n  override def close(): Unit = {\n    hbaseConnection.close()\n  }\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br"),e("span",{staticClass:"line-number"},[s._v("156")]),e("br"),e("span",{staticClass:"line-number"},[s._v("157")]),e("br"),e("span",{staticClass:"line-number"},[s._v("158")]),e("br"),e("span",{staticClass:"line-number"},[s._v("159")]),e("br"),e("span",{staticClass:"line-number"},[s._v("160")]),e("br"),e("span",{staticClass:"line-number"},[s._v("161")]),e("br"),e("span",{staticClass:"line-number"},[s._v("162")]),e("br")])]),e("p"),s._v(" "),e("h2",{attrs:{id:"_2、自定义sparksql数据源进行数据分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、自定义sparksql数据源进行数据分析"}},[s._v("#")]),s._v(" 2、自定义SparkSQL数据源进行数据分析")]),s._v(" "),e("p",[s._v("前面我们通过自定义sparkSQL数据源，可以获取Hbase当中的数据，以及将分析的结果保存到Hbase当中去，那么接下来我们就可以通过自定义SparkSQL数据源，实现分析Hbase当中的数据\n在travel_spark这个工程模块下的src/main/scala路径下创建package  com.travel.programApp 然后创建com.travel.programApp. SparkSQLHBaseSource.scala这个object文件，实现读取Hbase的数据")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('import com.travel.transaction._\nimport com.travel.utils.GlobalConfigUtils\nimport org.apache.spark.sql.{DataFrame, SparkSession}\n\nobject SparkSQLHBaseSource {\ndef main(args: Array[String]): Unit = {\n\n    val sparkSession: SparkSession = SparkSession.builder().master("local[1]").appName("sparkSQLHBase").getOrCreate()\n      sparkSession.sparkContext.setLogLevel("WARN")\n      val order: DataFrame = sparkSession.read\n        .format("com.travel.programApp.hbaseSource.HBaseSource")\n        .options(Map(\n          GlobalConfigUtils.getProp("sparksql_table_schema") -> GlobalConfigUtils.getProp("order.sparksql_table_schema"),\n        GlobalConfigUtils.getProp("hbase_table_name") -> GlobalConfigUtils.getProp("syn.table.order_info"),\n        GlobalConfigUtils.getProp("hbase_table_schema") -> GlobalConfigUtils.getProp("order.hbase_table_schema")\n        )).load()\n\n    val driver: DataFrame = sparkSession.read\n        .format("com.travel.programApp.hbaseSource.HBaseSource")\n        .options(Map(\n          GlobalConfigUtils.getProp("sparksql_table_schema") -> GlobalConfigUtils.getProp("drivers.spark_sql_table_schema"),\n        GlobalConfigUtils.getProp("hbase_table_name") -> GlobalConfigUtils.getProp("syn.table.driver_info"),\n        GlobalConfigUtils.getProp("hbase_table_schema") -> GlobalConfigUtils.getProp("driver.hbase_table_schema")\n        )).load()\n\n    val renter: DataFrame = sparkSession.read\n        .format("com.travel.programApp.hbaseSource.HBaseSource")\n        .options(Map(\n          GlobalConfigUtils.getProp("sparksql_table_schema") -> GlobalConfigUtils.getProp("registe.sparksql_table_schema"),\n        GlobalConfigUtils.getProp("hbase_table_name") -> GlobalConfigUtils.getProp("syn.table.renter_info"),\n        GlobalConfigUtils.getProp("hbase_table_schema") -> GlobalConfigUtils.getProp("registe.hbase_table_schema")\n        )).load()\n\n    //注册\n\n    order.createOrReplaceTempView("order")\n      driver.createOrReplaceTempView("driver")\n      renter.createOrReplaceTempView("renter")\n      //cache\n\n    sparkSession.sqlContext.cacheTable("order")\n      sparkSession.sqlContext.cacheTable("driver")\n      sparkSession.sqlContext.cacheTable("renter")\n\n  //  OrderTransation.init(sparkSession)\n\n   // RenterTransation.init(sparkSession)\n\n  //  DriverTransation.init(sparkSession)\n\n  //  HotOrderTransation.init(sparkSession)\n\n   //   HotAreaOrder.init(sparkSession)\n\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br")])]),e("h2",{attrs:{id:"_3、自定义sparksql数据源-将数据保存到hbase"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、自定义sparksql数据源-将数据保存到hbase"}},[s._v("#")]),s._v(" 3、自定义SparkSQL数据源，将数据保存到Hbase")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('import org.apache.spark.sql.{DataFrame, SaveMode}\n\nobject SparkSQLHBaseSink {\n\n  def saveToHBase(dataFrame: DataFrame,tableName:String,rowkey:String,fields:String):Unit={\n      dataFrame.write.format("com.travel.programApp.hbaseSink.HBaseSink")\n          .mode(SaveMode.Overwrite)\n          .option("hbase.table.name",tableName)\n          .option("hbase.rowkey",rowkey)\n          .option("hbase.fields",fields)\n          .save()\n      }\n  }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p"),s._v(" "),e("h2",{attrs:{id:"_4、订单监控页面大屏开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、订单监控页面大屏开发"}},[s._v("#")]),s._v(" 4、订单监控页面大屏开发")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1593619389433-b413ef05-6c20-4860-abf0-579debad9acb.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"_1、统计每个城市每日以及每月车辆的总数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、统计每个城市每日以及每月车辆的总数量"}},[s._v("#")]),s._v(" 1、统计每个城市每日以及每月车辆的总数量")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1593619389575-9d6b5bcf-c930-44b2-abd5-c9ec0860ed41.png",alt:""}})]),s._v(" "),e("h4",{attrs:{id:"_1-1、每个城市当日车辆总数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、每个城市当日车辆总数量"}},[s._v("#")]),s._v(" 1.1、每个城市当日车辆总数量")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    substr(tb.begin_address_code , 1 ,4) as begin_address_code ,\n    count(distinct vehicle_license) as dayVehicleCount\nfrom\n    (select\n         begin_address_code ,\n         vehicle_license\n     from\n     order\n     where\n             date_format(create_time , 'yyyy-MM-dd')  = '2019-07-15\n') tb\n    group by\nsubstr(tb.begin_address_code , 1 ,4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h4",{attrs:{id:"_1-2、每个城市当月车辆总数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、每个城市当月车辆总数量"}},[s._v("#")]),s._v(" 1.2、每个城市当月车辆总数量")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    substr(tb.begin_address_code , 1 ,4) as begin_address_code ,\n    count(distinct vehicle_license) as monthVehicleCount\nfrom\n    (select\n         begin_address_code ,\n         vehicle_license\n     from\n         order\n     where\n             date_format(create_time , 'yyyy-MM')  = '2019-07') tb\n    group by\nsubstr(tb.begin_address_code , 1 ,4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h4",{attrs:{id:"_1-3、汇总每个城市当日以及当月车辆总数量两个指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、汇总每个城市当日以及当月车辆总数量两个指标"}},[s._v("#")]),s._v(" 1.3、汇总每个城市当日以及当月车辆总数量两个指标")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    monthVehicle.begin_address_code ,\n    NVL(monthVehicle.monthVehicleCount ,0) as monthVehicleCount,\n    NVL(dayVehicle.dayVehicleCount , 0) as dayVehicleCount\nfrom\n    monthVehicle left join dayVehicle\n    on\nmonthVehicle.begin_address_code = dayVehicle.begin_address_code\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_2、统计每个城市当日-当周-当月订单数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、统计每个城市当日-当周-当月订单数量"}},[s._v("#")]),s._v(" 2、统计每个城市当日，当周，当月订单数量")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1593619389575-9d6b5bcf-c930-44b2-abd5-c9ec0860ed41-20211004100626647.png",alt:""}}),s._v("\n对城市进行分组，然后将每个城市的订单进行分组求和")]),s._v(" "),e("h4",{attrs:{id:"_2-1、每个城市当日订单总数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、每个城市当日订单总数量"}},[s._v("#")]),s._v(" 2.1、每个城市当日订单总数量")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    substr(tb.begin_address_code , 1 , 4)  as begin_address_code  ,\n    count(1) as dayOrderCount\nfrom\n    (select begin_address_code from order\n        where\ndate_format(create_time , 'yyyy-MM-dd') = '2019-07-15') tb\n    group by\nsubstr(tb.begin_address_code , 1 , 4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_2-2、每个城市本周订单总数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、每个城市本周订单总数量"}},[s._v("#")]),s._v(" 2.2、每个城市本周订单总数量")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    substr(tb.begin_address_code , 1 , 4)  as begin_address_code  ,\n    count(1) as weekOrderCount\nfrom\n    (select begin_address_code from order\n        where\nweekofyear(create_time) = '29') tb\n    group by\nsubstr(tb.begin_address_code , 1 , 4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_2-3、每个城市本月订单总数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、每个城市本月订单总数量"}},[s._v("#")]),s._v(" 2.3、每个城市本月订单总数量")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    substr(tb.begin_address_code , 1 , 4)  as begin_address_code  ,\n    count(1) as monthOrderCount\nfrom\n    (select begin_address_code from order\n        where\ndate_format(create_time , 'yyyy-MM') = '2019-07') tb\n    group by\nsubstr(tb.begin_address_code , 1 , 4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_2-4、汇总当日-当周-当月每个城市的订单总数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、汇总当日-当周-当月每个城市的订单总数量"}},[s._v("#")]),s._v(" 2.4、汇总当日，当周，当月每个城市的订单总数量")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    tb1.begin_address_code ,\n    tb1.monthOrderCount ,\n    tb1.weekOrderCount ,\n    dayOrder.dayOrderCount\nfrom\n    (select\n         monthOrder.begin_address_code ,\n         monthOrder.monthOrderCount ,\n         weekOrder.weekOrderCount\n     from\n         monthOrder left join weekOrder\n         on\nmonthOrder.begin_address_code  =  weekOrder.begin_address_code)  tb1 left join dayOrder\n    on\ntb1.begin_address_code = dayOrder.begin_address_code\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h3",{attrs:{id:"_3、汇总车辆以及订单指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、汇总车辆以及订单指标"}},[s._v("#")]),s._v(" 3、汇总车辆以及订单指标")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cast(\n                concat(\n                           if(v_begin_address_code is null ,o_begin_address_code , v_begin_address_code)\n        , '00')\n                as string) as rk,\n    cast(if(monthVehicleCount is null , 0 ,monthVehicleCount) as string) as monthVehicleCount ,\n    cast(if(dayVehicleCount is null , 0 , dayVehicleCount) as string) as dayVehicleCount ,\n    cast(\n                concat(\n                           if(o_begin_address_code is null ,v_begin_address_code , o_begin_address_code)\n        , '00')\n                as string) as o_begin_address_code,\n    cast(if(monthOrderCount is null , 0 , monthOrderCount) as string) as monthOrderCount ,\n    cast(if(weekOrderCount is null, 0 , weekOrderCount) as string) as weekOrderCount ,\n    cast(if(dayOrderCount is null ,0, dayOrderCount) as string) as dayOrderCount\nfrom\n    (select\n         vehcileCount.begin_address_code as v_begin_address_code,\n         vehcileCount.monthVehicleCount ,\n         vehcileCount.dayVehicleCount ,\n         _totalOrder.begin_address_code as o_begin_address_code ,\n         _totalOrder.monthOrderCount ,\n         _totalOrder.weekOrderCount ,\n         _totalOrder.dayOrderCount\n     from\n         vehcileCount full outer join _totalOrder\n         on\nvehcileCount.begin_address_code = _totalOrder.begin_address_code\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br")])]),e("h3",{attrs:{id:"_4、统计平台的总订单数-当月总订单数-出租车行驶总里程数-日均订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、统计平台的总订单数-当月总订单数-出租车行驶总里程数-日均订单"}},[s._v("#")]),s._v(" 4、统计平台的总订单数，当月总订单数，出租车行驶总里程数，日均订单")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1593619389722-f75ac41e-338c-436a-978d-b4fe7675a835.png",alt:""}})]),s._v(" "),e("h4",{attrs:{id:"_1、平台总订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、平台总订单"}},[s._v("#")]),s._v(" 1、平台总订单")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 myid ,\n    count(1) as totalOrderNum\nfrom\n    order\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_2、当月总订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、当月总订单"}},[s._v("#")]),s._v(" 2、当月总订单")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 myid ,\n    count(1) as monthOrderNum\nfrom\n    order\nwhere\n        date_format(create_time , 'yyyy-MM') = '2019-07'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_3、出租车行驶总里程数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、出租车行驶总里程数"}},[s._v("#")]),s._v(" 3、出租车行驶总里程数")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 as myid ,\n    sum(charge_mileage)  as charge_mileage\nfrom\n    order\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_4、日均订单数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、日均订单数量"}},[s._v("#")]),s._v(" 4、日均订单数量")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 as myid ,\n    round((tb.totalOrder /tb.num) , 2) as avgOrderNum\nfrom\n    (select\n             count(1) as totalOrder ,\n             (select\n                      DATEDIFF(\nmax(date_format(create_time , 'yyyy-MM-dd')) ,\nmin(date_format(create_time , 'yyyy-MM-dd'))\n) as dayNum\n              from\n                  order ) num\n         from order) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h4",{attrs:{id:"_5、汇总以上所有指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、汇总以上所有指标"}},[s._v("#")]),s._v(" 5、汇总以上所有指标")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cast(t2.myid as string) as rk,\n    cast(t2.totalOrderNum as string) as totalOrderNum,\n    cast(t2.monthOrderNum as  string) as monthOrderNum,\n    cast(t2.avgOrderNum as string) as avgOrderNum ,\n    cast(_totalCharge_mileage.charge_mileage as string)  as charge_mileage\nfrom\n    (select\n         t1.myid ,\n         t1.totalOrderNum ,\n         t1.monthOrderNum ,\n         avgOrder.avgOrderNum\n     from\n         (select\n              _total_order.myid ,\n              _total_order.totalOrderNum ,\n              month_totalOrder.monthOrderNum\n          from\n              _total_order left join month_totalOrder\n              on\n_total_order.myid = month_totalOrder.myid) t1 left join avgOrder\n         on\nt1.myid = avgOrder.myid) t2 left join _totalCharge_mileage\n    on\nt2.myid = _totalCharge_mileage.myid\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br")])]),e("h3",{attrs:{id:"_5、统计平台总订单数-平台注册用户数-平台订单总金额"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、统计平台总订单数-平台注册用户数-平台订单总金额"}},[s._v("#")]),s._v(" 5、统计平台总订单数，平台注册用户数，平台订单总金额")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1593619389875-fae0dce3-c8b5-4906-b5e1-834341770129.png",alt:""}})]),s._v(" "),e("h4",{attrs:{id:"_1、平台总订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、平台总订单数"}},[s._v("#")]),s._v(" 1、平台总订单数")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 myid ,\n    count(1) as totalOrderNum\nfrom\n    order\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_2、平台注册用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、平台注册用户数"}},[s._v("#")]),s._v(" 2、平台注册用户数")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select 1 as myid , count(1) as registerTotalCount from renter\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_3、平台总收入数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、平台总收入数"}},[s._v("#")]),s._v(" 3、平台总收入数")]),s._v(" "),e("p",[s._v("sql语句定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select 1 as myid ,  sum(pay_all) pay_all from order\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_4、汇总平台总订单数-平台注册用户数-平台订单总金额"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、汇总平台总订单数-平台注册用户数-平台订单总金额"}},[s._v("#")]),s._v(" 4、汇总平台总订单数，平台注册用户数，平台订单总金额")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    tb1.myid as myid,\n    cast(tb1.totalCount as string) as totalCount ,\n    cast(tb1.registerTotalCount as string) as registerTotalCount,\n    cast(pay_all.pay_all as string) as pay_all\nfrom\n    (select\n         totalOrders.myid ,\n         totalOrders.totalOrderNum as totalCount ,\n         rtc.registerTotalCount\n     from\n         totalOrders , rtc\n     where\n             totalOrders.myid = rtc.myid) tb1 , pay_all\nwhere\n        tb1.myid = pay_all.myid\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h2",{attrs:{id:"_5、用户统计功能模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、用户统计功能模块"}},[s._v("#")]),s._v(" 5、用户统计功能模块")]),s._v(" "),e("p",[s._v("统计用户留存率以及活跃用户\n"),e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1593619390009-37f4e09d-c033-43b8-926e-95b391aa6fa5.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"_1、统计各个城市当日新增和当日活跃用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、统计各个城市当日新增和当日活跃用户数"}},[s._v("#")]),s._v(" 1、统计各个城市当日新增和当日活跃用户数")]),s._v(" "),e("h4",{attrs:{id:"_1、当日新增用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日新增用户数"}},[s._v("#")]),s._v(" 1、当日新增用户数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    substr(last_login_city , 1 , 4) as last_login_city ,\n    count(1) as _day_new_user\nfrom\n    (select last_login_city from renter\n        where\ndate_format(create_time , 'yyyy-MM-dd') = '2019-07-15'\nand\nlast_login_city != '') tb\n    group by substr(last_login_city , 1 , 4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_2、当日活跃用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、当日活跃用户数"}},[s._v("#")]),s._v(" 2、当日活跃用户数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    substr(last_login_city,1,4) as last_login_city ,\n    count(distinct id) DAU\nfrom\n    (select\n         last_login_city ,\n         id\n             from renter\n         where date_format(last_logon_time , 'yyyy-MM-dd') = '2019-07-15'\n         and\n         last_login_city != '') tb\n    group by\nsubstr(last_login_city,1,4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h4",{attrs:{id:"_3、关联日新增和日活跃指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、关联日新增和日活跃指标"}},[s._v("#")]),s._v(" 3、关联日新增和日活跃指标")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cast(\n                concat(\n                           if(_dayRegister.last_login_city is null , _dayActive.last_login_city , _dayRegister.last_login_city)\n        , '00'\n        )\n                as string\n        ) as rk ,\n    cast(\n                concat(\n                           if(_dayRegister.last_login_city is null , _dayActive.last_login_city , _dayRegister.last_login_city)\n        , '00'\n        )\n                as string\n        ) as _city_code ,\n    cast(if(_dayRegister._day_new_user is null , 0 , _dayRegister._day_new_user) as string) as _day_new_user ,\n    cast(if(_dayActive.DAU is null , 0 , _dayActive.DAU) as  string) as DAU\nfrom\n    _dayRegister  full outer join _dayActive\n    on\n_dayRegister.last_login_city = _dayActive.last_login_city\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h3",{attrs:{id:"_2、统计平台当日-本周-当月新注册用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、统计平台当日-本周-当月新注册用户数"}},[s._v("#")]),s._v(" 2、统计平台当日，本周，当月新注册用户数")]),s._v(" "),e("h4",{attrs:{id:"_1、当日新增用户数-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日新增用户数-2"}},[s._v("#")]),s._v(" 1、当日新增用户数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 as myid ,\n    count(1) as dayNewUserCount\nfrom\n    (select id from renter\n        where\ndate_format(create_time , 'yyyy-MM-dd') = '2019-07-15') tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_2、本周新增用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、本周新增用户数"}},[s._v("#")]),s._v(" 2、本周新增用户数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select 1 as myid , count(1) as weekNewUserCount\nfrom\n(select id from renter\nwhere\nweekofyear(create_time) = '29') tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_3、当月新增用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、当月新增用户数"}},[s._v("#")]),s._v(" 3、当月新增用户数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select 1 as myid , count(1) as monthNewUserCount\nfrom\n(select id from renter\nwhere\ndate_format(create_time , 'yyyy-MM') = '2019-07') tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_4、日、周、月新增用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、日、周、月新增用户数"}},[s._v("#")]),s._v(" 4、日、周、月新增用户数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cast(tb.myid as string) as myid,\n    cast(tb.monthNewUserCount as string) as monthNewUserCount,\n    cast(tb.weekNewUserCount as string) as weekNewUserCount,\n    cast(dnuc.dayNewUserCount as string) as dayNewUserCount\nfrom\n    (select\n         mnuc.myid ,\n         mnuc.monthNewUserCount ,\n         wnuc.weekNewUserCount\n     from\n         mnuc , wnuc\n     where\n             mnuc.myid = wnuc.myid) tb , dnuc\nwhere\n        tb.myid = dnuc.myid\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h3",{attrs:{id:"_3、用户留存率统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、用户留存率统计"}},[s._v("#")]),s._v(" 3、用户留存率统计")]),s._v(" "),e("h4",{attrs:{id:"_1、统计次日留存率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、统计次日留存率"}},[s._v("#")]),s._v(" 1、统计次日留存率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 as myid ,\n    concat(cast(count(tb2.last_logon_time)*100/count(tb1.create_time) as string) , '%') as dayStateRate\nfrom\n    (select\n         id ,\n         date_format(create_time , 'yyyy-MM-dd') create_time\n     from\n         renter\n     where\n             date_format(create_time , 'yyyy-MM-dd') = '2019-07-14') tb1\n    left outer join\n(select\n     id ,\n     date_format(last_logon_time , 'yyyy-MM-dd') last_logon_time\n from\n     renter\n where\n         date_format(last_logon_time , 'yyyy-MM-dd') = '2019-07-15') tb2\non\ntb1.id = tb2.id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h4",{attrs:{id:"_2、计算本周留存率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、计算本周留存率"}},[s._v("#")]),s._v(" 2、计算本周留存率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 as myid ,\n    concat(cast(count(tb2.last_logon_time)*100/count(tb1.create_time) as string) , '%') as weekStateRate\nfrom\n    (select\n         id ,\n         date_format(create_time , 'yyyy-MM-dd') create_time\n     from\n         renter\n     where\n             date_format(create_time , 'yyyy-MM-dd') = '2019-07-15') tb1\n    left outer join\n(select\n     id ,\n     date_format(last_logon_time , 'yyyy-MM-dd') last_logon_time\n from\n     renter\n where\n         date_format(last_logon_time , 'yyyy-MM-dd') = '2019-07-07') tb2\non\ntb1.id = tb2.id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h4",{attrs:{id:"_3、计算本月留存率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、计算本月留存率"}},[s._v("#")]),s._v(" 3、计算本月留存率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 as myid ,\n    concat(cast(count(tb2.last_logon_time)*100/count(tb1.create_time) as string) , '%') as monthStateRate\nfrom\n    (select\n         id ,\n         date_format(create_time , 'yyyy-MM-dd') create_time\n     from\n         renter\n     where\n             date_format(create_time , 'yyyy-MM-dd') = '2019-07-30') tb1\n    left outer join\n(select\n     id ,\n     date_format(last_logon_time , 'yyyy-MM-dd') last_logon_time\n from\n     renter\n where\n         date_format(last_logon_time , 'yyyy-MM-dd') = '2019-07-01') tb2\non\ntb1.id = tb2.id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h4",{attrs:{id:"_4、汇总次日-本周-本月留存率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、汇总次日-本周-本月留存率"}},[s._v("#")]),s._v(" 4、汇总次日，本周，本月留存率")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cast(NVL(tb1.myid,1) as string) as myid ,\n    cast(NVL(tb1.monthStateRate , '0.0%') as string) as monthStateRate,\n    cast(NVL(tb1.weekStateRate, '0.0%') as string) as weekStateRate,\n    cast(NVL(dayStateRate.dayStateRate, '0.0%') as string) as dayStateRate\nfrom\n    (select\n         NVL(monthStateRate.myid , 1) as  myid,\n         NVL(monthStateRate.monthStateRate , '0.0%') as monthStateRate,\n         NVL(weekStateRate.weekStateRate , '0.0%') as weekStateRate\n     from\n         monthStateRate full outer join weekStateRate\n         on\nmonthStateRate.myid = weekStateRate.myid) tb1 full outer join dayStateRate\n    on\ntb1.myid = dayStateRate.myid\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h3",{attrs:{id:"_4、活跃用户统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、活跃用户统计"}},[s._v("#")]),s._v(" 4、活跃用户统计")]),s._v(" "),e("p",[s._v("统计日活，周活，月活跃用户数量")]),s._v(" "),e("h4",{attrs:{id:"_1、日活跃用户统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、日活跃用户统计"}},[s._v("#")]),s._v(" 1、日活跃用户统计")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 tmpID ,\n    count(distinct id) DAU\nfrom \n\t\trenter\nwhere \n\t\tdate_format(last_logon_time , 'yyyy-MM-dd') = '2019-07-15'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_2、周活跃用户统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、周活跃用户统计"}},[s._v("#")]),s._v(" 2、周活跃用户统计")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 tmpID ,\n    count(distinct id) WAU\n    from renter\n    where weekofyear(date_format(last_logon_time , 'yyyy-MM-dd')) = '29'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p"),s._v(" "),e("h4",{attrs:{id:"_3、月活跃用户统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、月活跃用户统计"}},[s._v("#")]),s._v(" 3、月活跃用户统计")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    1 tmpID ,\n    count(distinct id) MAU\n    from renter\nwhere\n        date_format(last_logon_time , 'yyyy-MM') = '2019-07'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"_6、司机统计功能模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6、司机统计功能模块"}},[s._v("#")]),s._v(" 6、司机统计功能模块")]),s._v(" "),e("h3",{attrs:{id:"_1、平台有效订单统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、平台有效订单统计"}},[s._v("#")]),s._v(" 1、平台有效订单统计")]),s._v(" "),e("p",[s._v("统计当日，本周，本月，本季度，本年平台的有效订单")]),s._v(" "),e("h4",{attrs:{id:"_1、当日平台有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日平台有效订单数"}},[s._v("#")]),s._v(" 1、当日平台有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _effective_num_day\n    from order\nwhere\n        date_format(create_time , 'yyyy-MM-dd') = '2019-07-15'\n  and\n        cancel = 0\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_2、平台本周有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、平台本周有效订单数"}},[s._v("#")]),s._v(" 2、平台本周有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _effective_num_week\n    from order\nwhere\n        weekofyear(create_time) = '29'\n  and\n        cancel = 0\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_3、平添本月有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、平添本月有效订单数"}},[s._v("#")]),s._v(" 3、平添本月有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _effective_num_month\n    from order\nwhere\n        date_format(create_time , 'yyyy-MM') = '2019-07'\n  and\n        cancel = 0\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_4、平添本季度有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、平添本季度有效订单数"}},[s._v("#")]),s._v(" 4、平添本季度有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _effective_num_quarter\nfrom order\nwhere\n        quarter(create_time) = '3'\n  and\n        date_format(create_time , 'yyyy') = '2019'\n  and\n        cancel = 0\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_5、平台本年有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、平台本年有效订单数"}},[s._v("#")]),s._v(" 5、平台本年有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _effective_num_year\n    from order\nwhere\n        date_format(create_time , 'yyyy') = '2019'\n  and\n        cancel = 0\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_2、平台全部订单统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、平台全部订单统计"}},[s._v("#")]),s._v(" 2、平台全部订单统计")]),s._v(" "),e("p",[s._v("统计当日，本周，本月，本季度，本年的平台全部订单数")]),s._v(" "),e("h4",{attrs:{id:"_1、当日平台全部订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日平台全部订单"}},[s._v("#")]),s._v(" 1、当日平台全部订单")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _total_num_day\n    from order\nwhere\n        date_format(create_time , 'yyyy-MM-dd') = '2019-07-15'\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_2、本周平台全部订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、本周平台全部订单"}},[s._v("#")]),s._v(" 2、本周平台全部订单")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _total_num_week\n    from order\nwhere\n        weekofyear(create_time) = '29'\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_3、本月平台全部订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、本月平台全部订单"}},[s._v("#")]),s._v(" 3、本月平台全部订单")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _total_num_month\n    from order\nwhere\n        date_format(create_time , 'yyyy-MM') = '2019-07'\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_4、本季度平台全部订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、本季度平台全部订单"}},[s._v("#")]),s._v(" 4、本季度平台全部订单")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _total_num_quarter\nfrom order\nwhere\n        quarter(create_time) = '3'\n  and\n        date_format(create_time , 'yyyy') = '2019'\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_5、本年平台全部订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、本年平台全部订单"}},[s._v("#")]),s._v(" 5、本年平台全部订单")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    count(1) as _total_num_year\nfrom order\nwhere\n        date_format(create_time , 'yyyy') = '2019'\n    group by\ncity_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_3、平台订单完成率统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、平台订单完成率统计"}},[s._v("#")]),s._v(" 3、平台订单完成率统计")]),s._v(" "),e("p",[s._v("统计当日，本周，本月，本季度，本年度订单的完成率")]),s._v(" "),e("h4",{attrs:{id:"_1、当日订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日订单完成率"}},[s._v("#")]),s._v(" 1、当日订单完成率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    case when _effective_num_day=0 then '0.0%' else CONCAT(cast(round(_effective_num_day*100/_total_num_day, 2) as string),'%') end as _day_comple_rate\nfrom\n    (select\n         _effective_order_day.city_name ,\n         _effective_order_day._effective_num_day ,\n         _total_order_day._total_num_day\n     from\n         _effective_order_day left join _total_order_day\n         on\n_effective_order_day.city_name = _total_order_day.city_name\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h4",{attrs:{id:"_2、本周订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、本周订单完成率"}},[s._v("#")]),s._v(" 2、本周订单完成率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    case when _effective_num_week=0 then '0.0%' else CONCAT(cast(round(_effective_num_week*100/_total_num_week, 2) as string),'%') end as _week_comple_rate\nfrom\n    (select\n         _effective_order_week.city_name ,\n         _effective_order_week._effective_num_week ,\n         _total_order_week._total_num_week\n     from\n         _effective_order_week left join _total_order_week\n         on\n_effective_order_week.city_name = _total_order_week.city_name\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h4",{attrs:{id:"_3、本月订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、本月订单完成率"}},[s._v("#")]),s._v(" 3、本月订单完成率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    case when _effective_num_month=0 then '0.0%' else CONCAT(cast(round(_effective_num_month*100/_total_num_month, 2) as string),'%') end as _month_comple_rate\nfrom\n    (select\n         _effective_order_month.city_name ,\n         _effective_order_month._effective_num_month ,\n         _total_order_month._total_num_month\n     from\n         _effective_order_month left join _total_order_month\n         on\n_effective_order_month.city_name = _total_order_month.city_name\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h4",{attrs:{id:"_4、本季度订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、本季度订单完成率"}},[s._v("#")]),s._v(" 4、本季度订单完成率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    case when _effective_num_quarter=0 then '0.0%' else CONCAT(cast(round(_effective_num_quarter*100/_total_num_quarter, 2) as string),'%') end as _quarter_comple_rate\nfrom\n    (select\n         _effective_order_quarter.city_name ,\n         _effective_order_quarter._effective_num_quarter ,\n         _total_order_quarter._total_num_quarter\n     from\n         _effective_order_quarter left join _total_order_quarter\n         on\n_effective_order_quarter.city_name = _total_order_quarter.city_name\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h4",{attrs:{id:"_5、本年度订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、本年度订单完成率"}},[s._v("#")]),s._v(" 5、本年度订单完成率")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    city_name ,\n    case when _effective_num_year=0 then '0.0%' else CONCAT(cast(round(_effective_num_year*100/_total_num_year, 2) as string),'%') end as _year_comple_rate\nfrom\n    (select\n         _effective_order_year.city_name ,\n         _effective_order_year._effective_num_year ,\n         _total_order_year._total_num_year\n     from\n         _effective_order_year left join _total_order_year\n         on\n_effective_order_year.city_name = _total_order_year.city_name\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"_4、汇总平台有效订单-平台全部订单以及平台订单完成率指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、汇总平台有效订单-平台全部订单以及平台订单完成率指标"}},[s._v("#")]),s._v(" 4、汇总平台有效订单，平台全部订单以及平台订单完成率指标")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cast(1 as string) as rk ,\n    cast(year_quarter_month_week_tb.city_name as  string) as city_name ,\n    cast(year_quarter_month_week_tb._year_comple_rate as string) as _year_comple_rate  ,\n    cast(if(year_quarter_month_week_tb._quarter_comple_rate is null , '0.0%' , year_quarter_month_week_tb._quarter_comple_rate) as string) as _quarter_comple_rate,\n    cast(if(year_quarter_month_week_tb._month_comple_rate is null , '0.0%' , year_quarter_month_week_tb._month_comple_rate) as string) as _month_comple_rate,\n    cast(if(year_quarter_month_week_tb._week_comple_rate is null , '0.0%' , year_quarter_month_week_tb._week_comple_rate) as string) as _week_comple_rate,\n    cast(if(_plat_order_day_status._day_comple_rate is null , '0.0%' , _plat_order_day_status._day_comple_rate) as string) as _day_comple_rate\nfrom\n    (select\n         year_quarter_month_tb.city_name ,\n         year_quarter_month_tb._year_comple_rate ,\n         year_quarter_month_tb._quarter_comple_rate ,\n         year_quarter_month_tb._month_comple_rate ,\n         _plat_order_week_status._week_comple_rate\n     from\n         (select\n              year_quarter_tb.city_name ,\n              year_quarter_tb._year_comple_rate ,\n              year_quarter_tb._quarter_comple_rate ,\n              _plat_order_month_status._month_comple_rate\n          from\n              (select\n                   _plat_order_year_status.city_name ,\n                   _plat_order_year_status._year_comple_rate ,\n                   _plat_order_quarter_status._quarter_comple_rate\n               from\n                   _plat_order_year_status left join _plat_order_quarter_status\n                   on\n_plat_order_year_status.city_name = _plat_order_quarter_status.city_name\n              ) year_quarter_tb left join _plat_order_month_status\n              on\nyear_quarter_tb.city_name = _plat_order_month_status.city_name\n         ) year_quarter_month_tb left join _plat_order_week_status\n         on\nyear_quarter_month_tb.city_name = _plat_order_week_status.city_name\n    ) year_quarter_month_week_tb left join _plat_order_day_status\n    on\nyear_quarter_month_week_tb.city_name = _plat_order_day_status.city_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br")])]),e("h3",{attrs:{id:"_5、统计司机有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、统计司机有效订单数"}},[s._v("#")]),s._v(" 5、统计司机有效订单数")]),s._v(" "),e("h4",{attrs:{id:"_1、当日司机有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日司机有效订单数"}},[s._v("#")]),s._v(" 1、当日司机有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name,\n    count(1) as _effective_num_day\nfrom order\nwhere\n        date_format(create_time , 'yyyy-MM-dd') = '2019-07-15'\n  and\n        cancel = 0\n    group by\ndriver_id ,\ndriver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_2、当周司机有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、当周司机有效订单数"}},[s._v("#")]),s._v(" 2、当周司机有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _effective_num_week\nfrom order\nwhere\n        weekofyear(create_time) = '29'\n  and\n        cancel = 0\n    group by\ndriver_id ,\ndriver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_3、当月司机有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、当月司机有效订单数"}},[s._v("#")]),s._v(" 3、当月司机有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _effective_num_month\nfrom order\nwhere\n        date_format(create_time , 'yyyy-MM') = '2019-07'\n  and\n        cancel = 0\n    group by\ndriver_id ,\ndriver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_4、当季度司机有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、当季度司机有效订单数"}},[s._v("#")]),s._v(" 4、当季度司机有效订单数")]),s._v(" "),e("p",[s._v("当季度司机有效订单数")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _effective_num_quarter\nfrom order\nwhere\n        quarter(create_time) = '3'\n  and\n        date_format(create_time , 'yyyy') = date_format(NOW() , 'yyyy')\n  and\n        cancel = 0\n    group by\ndriver_id , driver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h4",{attrs:{id:"_5、当年司机有效订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、当年司机有效订单数"}},[s._v("#")]),s._v(" 5、当年司机有效订单数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _effective_num_year\nfrom order\nwhere\n        date_format(create_time , 'yyyy') = '2019'\n  and\n        cancel = 0\n    group by\ndriver_id ,\ndriver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h3",{attrs:{id:"_6、统计司机订单总数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6、统计司机订单总数"}},[s._v("#")]),s._v(" 6、统计司机订单总数")]),s._v(" "),e("p",[s._v("统计司机当日，当周，当月，当季度，当年订单总数")]),s._v(" "),e("h4",{attrs:{id:"_1、当日订单总数统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日订单总数统计"}},[s._v("#")]),s._v(" 1、当日订单总数统计")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _total_num_day\nfrom order\nwhere\n        date_format(create_time , 'yyyy-MM-dd') = '2019-07-15'\n    group by\ndriver_id , driver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_2、当周订单总数统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、当周订单总数统计"}},[s._v("#")]),s._v(" 2、当周订单总数统计")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _total_num_week\nfrom order\nwhere\n        weekofyear(create_time) = '29'\n    group by\ndriver_id , driver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_3、当月订单总数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、当月订单总数"}},[s._v("#")]),s._v(" 3、当月订单总数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _total_num_month\nfrom order\nwhere\n        date_format(create_time , 'yyyy-MM') = '2019-07'\n    group by\ndriver_id , driver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_4、当季度订单总数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、当季度订单总数"}},[s._v("#")]),s._v(" 4、当季度订单总数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _total_num_quarter\nfrom order\nwhere\n        quarter(create_time) = '3'\n  and\n        date_format(create_time , 'yyyy') = date_format(NOW() , 'yyyy')\n    group by\ndriver_id , driver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_5、当年订单总数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、当年订单总数"}},[s._v("#")]),s._v(" 5、当年订单总数")]),s._v(" "),e("p",[s._v("sql定义")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    count(1) as _total_num_year\nfrom order\nwhere\n        date_format(create_time , 'yyyy') = '2019'\n    group by\ndriver_id , driver_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h3",{attrs:{id:"_7、基于司机有效订单数以及订单总数统计司机订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7、基于司机有效订单数以及订单总数统计司机订单完成率"}},[s._v("#")]),s._v(" 7、基于司机有效订单数以及订单总数统计司机订单完成率")]),s._v(" "),e("p",[s._v("基于司机有效订单数，以及司机总订单数，统计每个司机的当日，本周，本月，本季度，本年订单完成率")]),s._v(" "),e("h4",{attrs:{id:"_1、司机当日订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、司机当日订单完成率"}},[s._v("#")]),s._v(" 1、司机当日订单完成率")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    case when _effective_num_day=0 then '0.0%' else CONCAT(cast(round(_effective_num_day*100/_total_num_day, 2) as string),'%') end as _day_comple_rate\nfrom\n    (select\n         _effective_driver_order_day.driver_id ,\n         _effective_driver_order_day.driver_name ,\n         _effective_driver_order_day._effective_num_day ,\n         _total_driver_order_day._total_num_day\n     from\n         _effective_driver_order_day left join _total_driver_order_day\n         on\n_effective_driver_order_day.driver_id = _total_driver_order_day.driver_id\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_2、司机当周订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、司机当周订单完成率"}},[s._v("#")]),s._v(" 2、司机当周订单完成率")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    case when _effective_num_week=0 then '0.0%' else CONCAT(cast(round(_effective_num_week*100/_total_num_week, 2) as string),'%') end as _week_comple_rate\nfrom\n    (select\n         _effective_driver_order_week.driver_id ,\n         _effective_driver_order_week.driver_name ,\n         _effective_driver_order_week._effective_num_week ,\n         _total_driver_order_week._total_num_week\n     from\n         _effective_driver_order_week left join _total_driver_order_week\n         on\n_effective_driver_order_week.driver_id = _total_driver_order_week.driver_id\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_3、司机当月订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、司机当月订单完成率"}},[s._v("#")]),s._v(" 3、司机当月订单完成率")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    case when _effective_num_month=0 then '0.0%' else CONCAT(cast(round(_effective_num_month*100/_total_num_month, 2) as string),'%') end as _month_comple_rate\nfrom\n    (select\n         _effective_driver_order_month.driver_id ,\n         _effective_driver_order_month.driver_name ,\n         _effective_driver_order_month._effective_num_month ,\n         _total_driver_order_month._total_num_month\n     from\n         _effective_driver_order_month left join _total_driver_order_month\n         on\n_effective_driver_order_month.driver_id = _total_driver_order_month.driver_id\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_4、司机当季度订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、司机当季度订单完成率"}},[s._v("#")]),s._v(" 4、司机当季度订单完成率")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    case when _effective_num_quarter=0 then '0.0%' else CONCAT(cast(round(_effective_num_quarter*100/_total_num_quarter, 2) as string),'%') end as _quarter_comple_rate\nfrom\n    (select\n         _effective_driver_order_quarter.driver_id ,\n         _effective_driver_order_quarter.driver_name ,\n         _effective_driver_order_quarter._effective_num_quarter ,\n         _total_driver_order_quarter._total_num_quarter\n     from\n         _effective_driver_order_quarter left join _total_driver_order_quarter\n         on\n_effective_driver_order_quarter.driver_id = _total_driver_order_quarter.driver_id\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_5、司机当年订单完成率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、司机当年订单完成率"}},[s._v("#")]),s._v(" 5、司机当年订单完成率")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    driver_id ,\n    driver_name ,\n    case when _effective_num_year=0 then '0.0%' else CONCAT(cast(round(_effective_num_year*100/_total_num_year, 2) as string),'%') end as _year_comple_rate\nfrom\n    (select\n         _effective_driver_order_year.driver_id ,\n         _effective_driver_order_year.driver_name ,\n         _effective_driver_order_year._effective_num_year ,\n         _total_driver_order_year._total_num_year\n     from\n         _effective_driver_order_year left join _total_driver_order_year\n         on\n_effective_driver_order_year.driver_id = _total_driver_order_year.driver_id\n    ) tb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_6、汇总司机当日-当周-当月当季度-当年完成率指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6、汇总司机当日-当周-当月当季度-当年完成率指标"}},[s._v("#")]),s._v(" 6、汇总司机当日，当周，当月当季度，当年完成率指标")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cast(year_quarter_month_week_tb.driver_id as string) as rk ,\n    cast(year_quarter_month_week_tb.driver_id as string) as driver_id,\n    cast(year_quarter_month_week_tb.driver_name as string) as driver_name,\n    cast(year_quarter_month_week_tb._year_comple_rate as string) as _year_comple_rate,\n    cast(if(year_quarter_month_week_tb._quarter_comple_rate is null , '0.0%' , year_quarter_month_week_tb._quarter_comple_rate) as string) as _quarter_comple_rate,\n    cast(if(year_quarter_month_week_tb._month_comple_rate is null , '0.0%' , year_quarter_month_week_tb._month_comple_rate) as string) as _month_comple_rate,\n    cast(if(year_quarter_month_week_tb._week_comple_rate is null , '0.0%' , year_quarter_month_week_tb._week_comple_rate) as string) as _week_comple_rate,\n    cast(if(_driver_order_day_status._day_comple_rate is null , '0.0%' , _driver_order_day_status._day_comple_rate) as string) as _day_comple_rate\nfrom\n    (select\n         year_quarter_month_tb.driver_id ,\n         year_quarter_month_tb.driver_name ,\n         year_quarter_month_tb._year_comple_rate ,\n         year_quarter_month_tb._quarter_comple_rate ,\n         year_quarter_month_tb._month_comple_rate ,\n         _driver_order_week_status._week_comple_rate\n     from\n         (select\n              year_quarter_tb.driver_id ,\n              year_quarter_tb.driver_name ,\n              year_quarter_tb._year_comple_rate ,\n              year_quarter_tb._quarter_comple_rate ,\n              _driver_order_month_status._month_comple_rate\n          from\n              (select\n                   _driver_order_year_status.driver_id ,\n                   _driver_order_year_status.driver_name ,\n                   _driver_order_year_status._year_comple_rate ,\n                   _driver_order_quarter_status._quarter_comple_rate\n               from\n                   _driver_order_year_status left join _driver_order_quarter_status\n                   on\n_driver_order_year_status.driver_id = _driver_order_quarter_status.driver_id\n              ) year_quarter_tb left join _driver_order_month_status\n              on\nyear_quarter_tb.driver_id = _driver_order_month_status.driver_id\n         ) year_quarter_month_tb left join _driver_order_week_status\n         on\nyear_quarter_month_tb.driver_id = _driver_order_week_status.driver_id\n    ) year_quarter_month_week_tb left join _driver_order_day_status\n    on\nyear_quarter_month_week_tb.driver_id = _driver_order_day_status.driver_id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br")])]),e("h3",{attrs:{id:"_8、各城市新增注册司机数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8、各城市新增注册司机数"}},[s._v("#")]),s._v(" 8、各城市新增注册司机数")]),s._v(" "),e("p",[s._v("统计各个城市当日，当周，当月，当季度，当年新增注册司机数")]),s._v(" "),e("h4",{attrs:{id:"_1、当日新增注册司机数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、当日新增注册司机数"}},[s._v("#")]),s._v(" 1、当日新增注册司机数")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    register_city ,\n    count(distinct id) _register_day_num\nfrom\n    driver\nwhere\n        date_format(create_time , 'yyyy-MM-dd') = '2019-07-15'\n    group by\nregister_city\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_2、当周新增注册司机数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、当周新增注册司机数"}},[s._v("#")]),s._v(" 2、当周新增注册司机数")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    register_city ,\n    count(distinct id) _register_week_num\nfrom\n    driver\nwhere\n        weekofyear(create_time) = '29'\n    group by\nregister_city\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_3、当月新增注册司机数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、当月新增注册司机数"}},[s._v("#")]),s._v(" 3、当月新增注册司机数")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    register_city ,\n    count(distinct id) _register_month_num\nfrom\n    driver\nwhere\n        date_format(create_time , 'yyyy-MM') = '2019-07'\n    group by\nregister_city\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_4、当季度新增注册司机数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、当季度新增注册司机数"}},[s._v("#")]),s._v(" 4、当季度新增注册司机数")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    register_city ,\n    count(distinct id) _register_quarter_num\nfrom\n    driver\nwhere\n        quarter(create_time) = '3'\n  and\n        date_format(create_time , 'yyyy') = date_format(NOW() , 'yyyy')\n    group by\nregister_city\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_5、当年新增注册司机数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、当年新增注册司机数"}},[s._v("#")]),s._v(" 5、当年新增注册司机数")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    register_city ,\n    count(distinct id) _register_year_num\nfrom\n    driver\nwhere\n        date_format(create_time , 'yyyy') = '2019'\n    group by\nregister_city\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h2",{attrs:{id:"_7、热门订单以及热门地区统计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7、热门订单以及热门地区统计"}},[s._v("#")]),s._v(" 7、热门订单以及热门地区统计")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1593619390251-e0e4c9fc-9590-489f-9bfb-58d7f9a1fd39.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"_1、统计每个六边形区域订单个数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、统计每个六边形区域订单个数"}},[s._v("#")]),s._v(" 1、统计每个六边形区域订单个数")]),s._v(" "),e("p",[s._v("通过uber的H3算法，我们知道，为了完整的覆盖所有的地区，我们可以将地区划分成一个个的六边形，而且六边形的半径范围我们也可以自定义，我们需要统计每个六边形的订单数量\n在我们的travel_spark工程模块下的src/main/scala路径下创建package  com.travel.transaction 然后创建scala  object文件  HotOrderTransation.scala")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('import java.util\nimport com.travel.programApp.SparkSQLHBaseSink\nimport com.travel.tools.GetCenterPointFromListOfCoordinates\nimport com.uber.h3core.H3Core\nimport com.uber.h3core.util.GeoCoord\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.{Row, SparkSession}\nimport redis.clients.jedis.GeoCoordinate\n\nimport scala.collection.JavaConverters\n\n_/**_\n_  * Created by laowang_\n_  */_\nobject HotOrderTransation {\n  val h3 = H3Core.newInstance()\n  def init(sparkSession: SparkSession): Unit ={\n    sparkSession.udf.register("locationToH3" , locationToH3 _)\n\n    lazy val orderHotTmp =(time:Int) =>\n      s"""\n         |select\n         |open_lng ,\n         |open_lat ,\n         |create_time ,\n         |begin_address_code ,\n         |locationToH3(open_lng , open_lat , 7) as h3Code\n         |from\n         |order\n         |where ${time} <= cast(date_format(create_time , \'yyyyMMdd\') as int)\n    """.stripMargin\n\n    _//经纬度  转成h3_\n    sparkSession.sql(orderHotTmp(20190715)).createOrReplaceTempView("orderHotTmp")\n\n    lazy  val getHotArea =\n      """\n        |select tb2.h3Code ,\n        |tb2.num as count ,\n        |tb2.create_time ,\n        |tb2.begin_address_code\n        |from\n        |(select * ,\n        |row_number()  over(partition by h3Code order by rank desc) num\n        |from\n        |(select * ,\n        |row_number() over(partition by h3Code order by create_time) rank\n        |from\n        |orderHotTmp) tb) tb2\n        |where  tb2.num = 1\n      """.stripMargin\n\n    val rdd:RDD[Row] = sparkSession.sql(getHotArea).rdd\n    val reultHot: RDD[(String, String, String, Int)] = rdd.map { line =>\n      val h3Code = line.getAs[Long]("h3Code")\n      val count = line.getAs[Int]("count")\n      val create_time = line.getAs[String]("create_time")\n      val begin_address_code = line.getAs[String]("begin_address_code")\n\n      val geoCood: List[GeoCoord] = h3To6(h3Code)\n\n      val list = new util.ArrayList[GeoCoordinate]()\n      for (in <- geoCood) {\n        list.add(new GeoCoordinate(in.lng, in.lat))\n      }\n\n      val toList = JavaConverters.asScalaIteratorConverter(list.iterator()).asScala.toList\n      val centerPoint: GeoCoordinate = GetCenterPointFromListOfCoordinates.getCenterPoint(toList)\n\n      val rk = h3Code.toString\n      (rk, begin_address_code, centerPoint.getLongitude + "," + centerPoint.getLatitude, count)\n    }\n    import sparkSession.sqlContext.implicits._\n    val hotOrder = reultHot.toDF("rk" , "begin_address_code" , "centerPoint" , "count")\n    SparkSQLHBaseSink.saveToHBase(hotOrder,"hotOrder","rk","rk,begin_address_code,centerPoint,count")\n\n  }\n\n  _//UDF   经纬度  ---\x3eh3编码_\n  private def locationToH3(lat:Double , lon:Double , res:Int):Long = {\n    h3.geoToH3(lat , lon , res)\n  }\n  _//h3 --\x3e热区的那个点---\x3e六边形_\n  private def h3To6(geoCode:Long): List[GeoCoord] ={\n    val boundary: util.List[GeoCoord] = h3.h3ToGeoBoundary(geoCode)\n    JavaConverters.asScalaIteratorConverter(boundary.iterator()).asScala.toList\n  }\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br")])]),e("h3",{attrs:{id:"_2、统计每个热门区域的订单数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、统计每个热门区域的订单数量"}},[s._v("#")]),s._v(" 2、统计每个热门区域的订单数量")]),s._v(" "),e("p",[s._v("求取每个街道的订单数量总和，以及每个街道的订单增长情况")]),s._v(" "),e("h4",{attrs:{id:"第一步-sql文件定义"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第一步-sql文件定义"}},[s._v("#")]),s._v(" 第一步：sql文件定义")]),s._v(" "),e("p",[s._v("在travel_spark项目模块下，创建package  com.travel.sql  ，然后再该pakcage下面创建scala的object文件 HotAreaOrderSQL.scala用于存放我们的sql语句")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('package com.travel.sql\n\n_/**_\n_  * Created by laowang_\n_  */_\nobject HotAreaOrderSQL {\n  _//计算当日热区订单数--精度7，大概半径为1200米_\n  lazy val orderHotTable_day =(time:String)=> s"""\n                                 |select\n                                 |open_lat ,\n                                 |open_lng ,\n                                 |create_time ,\n                                 |begin_address_code ,\n                                 |locationToH3(open_lat , open_lng , 7) as h3Code\n                                 | from order\n                                 | where date_format(create_time , \'yyyy-MM-dd\') = \'${time}\'\n                               """.stripMargin_//date_format(NOW() , \'yyyy-MM-dd\')_\n  lazy val _today_hot_area  = """\n                                |select\n                                |table2.begin_address_code ,\n                                |h3ToCoordinate(table2.h3Code) coordinate,\n                                |table2.h3Code ,\n                                |1200 radius ,\n                                |table2.rank as count\n                                | from\n                                |(select * ,\n                                |row_number() over(partition by h3Code order by rank desc) num\n                                |from\n                                |(select * ,\n                                |row_number() over(partition by h3Code order by create_time desc) rank\n                                |from orderHotTable_day\n                                |) table\n                                |)table2\n                                |where table2.num = 1\n                              """.stripMargin\n\n  _//求昨日热力订单情况 2019-07-14_\n  lazy val yestdayOrderStatusTMP =(time:String)=> s"""\n                                       |select\n                                       |open_lat ,\n                                       |open_lng ,\n                                       |create_time ,\n                                       |begin_address_code ,\n                                       |locationToH3(open_lat , open_lng , 7) as h3Code\n                                       | from order\n                                       | where\n                                       | date_format(create_time , \'yyyy-MM-dd\') = \'${time}\'\n                                     """.stripMargin_//DATE_SUB(date_format(NOW() , \'yyyy-MM-dd\'), 1)_\n\n lazy val yestdayOrderStatus =  """\n                                  |select\n                                  |table2.begin_address_code ,\n                                  |h3ToCoordinate(table2.h3Code) coordinate ,\n                                  |table2.h3Code ,\n                                  |1200 radius ,\n                                  |table2.rank as count\n                                  | from\n                                  |(select * ,\n                                  |row_number() over(partition by h3Code order by rank desc) num\n                                  |from\n                                  |(select * ,\n                                  |row_number() over(partition by h3Code order by create_time desc) rank\n                                  |from yestdayOrderStatusTMP\n                                  |) table\n                                  |)table2\n                                  |where table2.num = 1\n                                """.stripMargin\n  lazy val newHotOrderTmp =\n    """\n    |select\n    |if(t_begin_address_code is null,y_begin_address_code , t_begin_address_code) as city_code,\n    |if(t_coordinate is null,y_coordinate , t_coordinate) as coordinate,\n    |if(t_radius is null , y_radius , t_radius) as radius ,\n    |if(t_count is null,0-if(y_count is null , 0 , y_count) , t_count-if(y_count is null,0,y_count)) as count\n    |from\n    |(\n    |select\n    |today_hot_area.begin_address_code as t_begin_address_code,\n    |today_hot_area.coordinate as t_coordinate ,\n    |today_hot_area.radius as t_radius ,\n    |today_hot_area.count as t_count ,\n    |yestdayOrderStatus.begin_address_code as y_begin_address_code ,\n    |yestdayOrderStatus.coordinate as y_coordinate ,\n    |yestdayOrderStatus.radius as y_radius ,\n    |yestdayOrderStatus.count as y_count\n    |from\n    |today_hot_area full outer join yestdayOrderStatus\n    |on\n    |today_hot_area.h3Code = yestdayOrderStatus.h3Code\n    |) tb\n    """.stripMargin\n\n  lazy val _hot_order ="""\n                       |select\n                       |cast(_today_hot_df.city_code as string) as rk ,\n                       |cast(_today_hot_df.city_code as string) as _city_code ,\n                       |cast(_today_hot_df.city_num as string) as _day_order_num ,\n                       |cast(_new_hot_df.city_num as string) as _new_orders_num\n                       |from\n                       |_today_hot_df left join _new_hot_df\n                       |on\n                       |_today_hot_df.city_code = _new_hot_df.city_code\n                     """.stripMargin\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br")])]),e("h4",{attrs:{id:"第二步-定义方法调用入口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第二步-定义方法调用入口"}},[s._v("#")]),s._v(" 第二步：定义方法调用入口")]),s._v(" "),e("p",[s._v("在travel_spark项目的src/main/scala路径下，创建package com.travel.transaction，然后在该package下面创建com.travel.transaction.HotAreaOrder.scala的object文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('import com.travel.programApp.SparkSQLHBaseSink\nimport com.travel.sql.HotAreaOrderSQL\nimport com.uber.h3core.H3Core\nimport com.uber.h3core.util.GeoCoord\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.{Row, SparkSession}\n_/**_\n_  * Created by angel_\n_  */_\nobject  HotAreaOrder {\n    val h3 = H3Core.newInstance\n\n    def init(sparkSession:SparkSession): Unit ={\n        _thrid_hotArea_order(sparkSession)\n      }\n\n   //========================当日热区订单、当日新增热区订单=================_\n    def _thrid_hotArea_order(sparkSession:SparkSession): Unit ={\n        sparkSession.udf.register("locationToH3" , locationToH3 _)\n        sparkSession.udf.register("h3ToCoordinate" , h3ToCoordinate _)\n       //计算当日热区订单数--精度7，大概半径为1200米_\n       //1）：将经纬度转换成H3编码_\n        sparkSession.sql(HotAreaOrderSQL.orderHotTable_day("2019-07-15")).createOrReplaceTempView("orderHotTable_day")\n\n       //2）：得到当日的热区订单 ，生成dataframe用来处理每个街道的热区_\n        val today_hot_area = sparkSession.sql(HotAreaOrderSQL._today_hot_area)\n          .toDF("begin_address_code" , "coordinate","h3Code" , "radius" , "count")\n\n       //注册临时表，用来做后面的当日新增热区_\n        today_hot_area.createOrReplaceTempView("today_hot_area")\n\n       //根据当日热区情况，获取每个街道的热区_\n        val today_hot_area_rdd: RDD[Row] = today_hot_area.rdd\n       //(街道编码 , (街道编码 ， 当日热区经纬度 ，当日热区半径，当日热区数量 ))_\n        val data: RDD[(String, Iterable[(String, String, Int, Int)])] = today_hot_area_rdd.map {\n            line =>\n             //当日下单的街道经纬度编码_\n              val begin_address_code = line.getAs[String]("begin_address_code")\n             //当日热区经纬度坐标_\n              val coordinate = line.getAs[String]("coordinate")\n             //当日热区半径_\n              val radius = line.getAs[Int]("radius")\n             //当日热区数量_\n              val count = line.getAs[Int]("count")\n              (begin_address_code, coordinate, radius, count)\n          }.groupBy(line => line._1)\n\n       //返回当日对每个街道热区情况计数(街道编码，数量，详情)(begin_address_code, coordinate, radius, count)_\n        val parseData: RDD[(String, Int, List[(String, String, Int, Int)])] = data.map {\n            line =>\n              var count = 0\n              for (dat <- line._2) {\n                  count = count + dat._4\n                }\n             //(街道编码，数量，详情) (begin_address_code, coordinate, radius, count)_\n              (line._1, count, line._2.toList)\n          }\n\n        import sparkSession.sqlContext.implicits._\n       //city_code | city_hot_num | [[coordinate , radius , count] ,[coordinate , radius , count] .... ]_\n        val _today_hot_df = parseData.toDF("city_code" , "city_num" , "today_hot_arr")\n\n       //当提新增热区订单数_\n       //求昨日热力订单情况_\n        sparkSession.sql(HotAreaOrderSQL.yestdayOrderStatusTMP("2019-07-14")).createOrReplaceTempView("yestdayOrderStatusTMP")\n\n        sparkSession.sql(HotAreaOrderSQL.yestdayOrderStatus).createOrReplaceTempView("yestdayOrderStatus")\n\n       //根据昨日的热区订单，与今日热区订单做对比，得到日新增订单_\n        val yest_hot_new_status = sparkSession.sql(HotAreaOrderSQL.newHotOrderTmp)\n          .toDF("city_code" , "coordinate" , "radius" , "count")\n\n       //得到当日热区和昨日热区对比后的每个街道的热区情况_\n        val yest_hot_new_status_rdd = yest_hot_new_status.rdd\n\n       //依然对街道编码做分组，只不过这次是新增后的热区情况_\n        val _new_hot = yest_hot_new_status_rdd.map {\n            line =>\n             //昨日下单的街道经纬度编码_\n              val city_code = line.getAs[String]("city_code")\n             //昨日热区经纬度坐标_\n              val coordinate = line.getAs[String]("coordinate")\n             //昨日热区半径_\n              val radius = line.getAs[Int]("radius")\n             //昨日热区数量_\n              val count = line.getAs[Int]("count")\n              (city_code, coordinate, radius, count)\n          }.groupBy(line => line._1)\n\n       //对每个街道热区情况计数_\n        val _new_hot_parse = _new_hot.map {\n            line =>\n              var count = 0\n              for (dat <- line._2) {\n                  count = count + dat._4\n                }\n              (line._1, count, line._2.toList)\n          }\n\n        import sparkSession.sqlContext.implicits._\n\n       //新增热区的dataframe_\n        val _new_hot_df = _new_hot_parse.toDF("city_code" , "city_num" , "yest_hot_arr")\n\n       //新增热区临时表_\n        _new_hot_df.createOrReplaceTempView("_new_hot_df")\n\n       //当日热区临时表_\n        _today_hot_df.createOrReplaceTempView("_today_hot_df")\n\n       //当日热区订单、当日新增热区订单_\n        val _hot_order = sparkSession.sql(HotAreaOrderSQL._hot_order)\n\n        _hot_order.show()\n\n        SparkSQLHBaseSink.saveToHBase(_hot_order,"_hot_order","rk","rk,_city_code,_day_order_num,_new_orders_num")\n\n    _//    DataFrameToHbase.save(_hot_order , "_hot_order" , "rk" , 1 , false)_\n      }\n\n   //经纬度转h3Code_\n    def locationToH3(lat:Double ,lon:Double , res:Int ): Long ={\n        h3.geoToH3(lat, lon, res)\n      }\n   //根据h3编码，转成经纬度_\n    def h3ToCoordinate(line:String):String = {\n        val geo: GeoCoord = h3.h3ToGeo(line.toLong)\n        geo.lat+","+geo.lng\n      }\n}\n\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br")])]),e("p")])}),[],!1,null,null,null);a.default=t.exports}}]);