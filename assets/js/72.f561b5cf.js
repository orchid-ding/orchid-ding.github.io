(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{558:function(s,a,e){"use strict";e.r(a);var t=e(19),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"rowkey设计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rowkey设计"}},[s._v("#")]),s._v(" rowkey设计")]),s._v(" "),e("ul",[e("li",[s._v("长度原则\n"),e("ul",[e("li",[s._v("rowkey是一个二进制码流，可以是任意字符串，最大长度64kb，实际应用中一般为10-100bytes，以byte[]形式保存，一般设计成定长。")]),s._v(" "),e("li",[s._v("建议尽可能短；但是也不能太短，否则rowkey前缀重复的概率增大")]),s._v(" "),e("li",[s._v("设计过长会降低memstore内存的利用率和HFile存储数据的效率。")])])]),s._v(" "),e("li",[s._v("散列原则\n"),e("ul",[e("li",[s._v("建议将rowkey的高位作为散列字段，这样将提高数据均衡分布在每个RegionServer，以实现负载均衡的几率。")]),s._v(" "),e("li",[s._v("如果没有散列字段，首字段直接是时间信息。所有的数据都会集中在一个RegionServer上，这样在数据检索的时候负载会集中在个别的RegionServer上，造成热点问题，会降低查询效率。")])])]),s._v(" "),e("li",[s._v("唯一原则\n"),e("ul",[e("li",[s._v("必须在设计上保证其唯一性，rowkey是按照字典顺序排序存储的")]),s._v(" "),e("li",[s._v("因此，设计rowkey的时候，要充分利用这个排序的特点，可以将经常读取的数据存储到一块，将最近可能会被访问的数据放到一块")]),s._v(" "),e("li",[s._v("电信上网详单数据，就是保存在HBase中的")])])])]),s._v(" "),e("p",[e("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/04/01/uPic/hbase/assets/2019-10-16_112336.png#height=869&id=YlFql&originHeight=869&originWidth=1543&originalType=binary&ratio=1&status=done&style=none&width=1543",alt:""}})]),s._v(" "),e("h2",{attrs:{id:"hbase表的热点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hbase表的热点"}},[s._v("#")]),s._v(" HBase表的热点")]),s._v(" "),e("div",{staticClass:"language-markdown line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-markdown"}},[e("code",[e("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 检索habse的记录首先要通过row key来定位数据行。\n"),e("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 当大量的client访问hbase集群的一个或少数几个节点，造成少数region server的读/写请求过多、负载过大，而其他region server负载却很小，就造成了“热点”现象。\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[e("strong",[s._v("热点的解决方案")])]),s._v(" "),e("li",[s._v("预分区\n"),e("ul",[e("li",[s._v("预分区的目的让表的数据可以均衡的分散在集群中，而不是默认只有一个region分布在集群的一个节点上。")])])]),s._v(" "),e("li",[s._v("加盐")]),s._v(" "),e("li",[s._v("这里所说的加盐不是密码学中的加盐，而是在rowkey的前面增加随机数，具体就是给rowkey分配一个随机前缀以使得它和之前的rowkey的开头不同")]),s._v(" "),e("li",[s._v("哈希\n"),e("ul",[e("li",[s._v("哈希会使同一行永远用一个前缀加盐。哈希也可以使负载分散到整个集群，但是读却是可以预测的。使用确定的哈希可以让客户端重构完整的rowkey，可以使用get操作准确获取某一个行数据。")])])])]),s._v(" "),e("p",[s._v("rowkey=MD5(username).subString(0,10)+时间戳")]),s._v(" "),e("div",{staticClass:"language-markdown line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-markdown"}},[e("code",[e("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 反转固定长度或者数字格式的rowkey。这样可以使得rowkey中经常改变的部分（最没有意义的部分）放在前面。\n"),e("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 这样可以有效的随机rowkey，但是牺牲了rowkey的有序性。\n"),e("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" eg: 手机号码的反转： 0120xxxx751\n"),e("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" eg: rowkey= address + age + 随机数\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"hbase的数据备份"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hbase的数据备份"}},[s._v("#")]),s._v(" HBase的数据备份")]),s._v(" "),e("ul",[e("li",[s._v("基于HBase提供的类对表进行备份")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用HBase提供的类把HBase中某张表的数据导出到HDFS，之后再导出到测试hbase表中。")]),s._v("\nhbase org.apache.hadoop.hbase.mapreduce.Export myuser /hbase_data/myuser_bak\n  \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hbase shell中创建备份目标表")]),s._v("\ncreate "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'myuser_bak'")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'f1'")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'f2'")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将HDFS上的数据导入到备份目标表中")]),s._v("\nhbase org.apache.hadoop.hbase.mapreduce.Driver "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" myuser_bak /hbase_data/myuser_bak/*\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增量备份")]),s._v("\nhbase org.apache.hadoop.hbase.mapreduce.Export "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" /hbase_data/test_bak_increment 开始时间戳  结束时间戳\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"基于snapshot快照对表进行备份"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于snapshot快照对表进行备份"}},[s._v("#")]),s._v(" 基于snapshot快照对表进行备份")]),s._v(" "),e("ul",[e("li",[s._v("通过snapshot快照的方式实现HBase数据的迁移和拷贝。这种方式比较常用，效率高，也是最为推荐的数据迁移方式。")]),s._v(" "),e("li",[s._v("HBase的snapshot其实就是一组metadata信息的集合（文件列表），通过这些metadata信息的集合，就能将表的数据回滚到snapshot那个时刻的数据。\n"),e("ul",[e("li",[s._v("首先我们要了解一下所谓的HBase的LSM类型的系统结构，我们知道在HBase中，数据是先写入到Memstore中，当Memstore中的数据达到一定条件，就会flush到HDFS中，形成HFile，后面就不允许原地修改或者删除了。")]),s._v(" "),e("li",[s._v("如果要更新或者删除的话，只能追加写入新文件。既然数据写入以后就不会在发生原地修改或者删除，这就是snapshot做文章的地方。做snapshot的时候，只需要给快照表对应的所有文件创建好指针（元数据集合），恢复的时候只需要根据这些指针找到对应的文件进行恢复就Ok。这是原理的最简单的描述，下图是描述快照时候的简单流程：")])])])]),s._v(" "),e("p",[e("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/04/01/uPic/hbase/assets/snapshot.png#height=1128&id=P4Fcu&originHeight=1128&originWidth=1670&originalType=binary&ratio=1&status=done&style=none&width=1670",alt:""}})]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建表的snapshot")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("snapshot")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tableName'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'snapshotName'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看快照")]),s._v("\nlist_snapshots  \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看以test开头的快照")]),s._v("\nlist_snapshots "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test.*'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 恢复快照")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("disable")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tableName'")]),s._v("\nrestore_snapshot "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'snapshotName'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("enable")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tableName'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除快照")]),s._v("\ndelete_snapshot "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'snapshotName'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 迁移 snapshot")]),s._v("\nhbase org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hbase"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("snapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ExportSnapshot \\\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("snapshot")]),s._v(" snapshotName  \\\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("copy"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" hdfs:"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//src-hbase-root-dir/hbase \\")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("copy"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" hdfs:"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//dst-hbase-root-dir/hbase \\")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mappers "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \\\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bandwidth "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("\n  \n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 用于将快照迁移到另外一个集群")]),s._v("\n  hbase org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hbase"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("snapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ExportSnapshot \\\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("snapshot")]),s._v(" test  \\\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("copy"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" hdfs:"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//node01:8020/hbase \\")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("copy"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" hdfs:"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//kfly01:8020/hbase1 \\")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mappers "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \\\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bandwidth "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 使用的时候记得设置好bandwidth参数，以免由于网络打满导致的线上业务故障。")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("ul",[e("li",[s._v("将snapshot使用bulkload的方式导入")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("hbase org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nhdfs://dst-hbase-root-dir/hbase/archive/datapath/tablename/filename "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ntablename\n\n-- 创建一个新表\ncreate "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'newTest'")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'f1'")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'f2'")]),s._v("\nhbase org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles hdfs://node1:9000/hbase1/archive/data/default/test/6325fabb429bf45c5dcbbe672225f1fb newTest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h2",{attrs:{id:"hbase二级索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hbase二级索引"}},[s._v("#")]),s._v(" HBase二级索引")]),s._v(" "),e("p",[e("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/04/01/uPic/hbase/assets/hbase%E5%AF%BB%E5%9D%80.png#height=726&id=tXdB6&originHeight=726&originWidth=1290&originalType=binary&ratio=1&status=done&style=none&width=1290",alt:""}})]),s._v(" "),e("ul",[e("li",[s._v("HBase表后期按照rowkey查询性能是最高的。rowkey就相当于hbase表的一级索引")]),s._v(" "),e("li",[s._v("但是在实际的工作中，我们做的查询基本上都是按照一定的条件进行查找，无法事先知道满足这些条件的rowkey是什么，正常是可以通过hbase过滤器去实现。但是效率非常低，这是由于查询的过程中需要在底层进行大量的文件扫描。")]),s._v(" "),e("li",[s._v("HBase的二级索引")]),s._v(" "),e("li",[s._v("为了HBase的数据查询更高效、适应更多的场景，诸如使用非rowkey字段检索也能做到秒级响应，或者支持各个字段进行模糊查询和多字段组合查询等， 因此需要在HBase上面构建二级索引， 以满足现实中更复杂多样的业务需求。\n"),e("ul",[e("li",[s._v("hbase的二级索引其本质就是建立HBase表中列与行键之间的映射关系。")])])])]),s._v(" "),e("p",[e("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/04/01/uPic/hbase/assets/%E4%BA%8C%E7%BA%A7%E7%B4%A2%E5%BC%95%E6%80%9D%E6%83%B3.png#height=685&id=ERpyw&originHeight=685&originWidth=1132&originalType=binary&ratio=1&status=done&style=none&width=1132",alt:""}})]),s._v(" "),e("ul",[e("li",[s._v("构建hbase二级索引方案\n"),e("ul",[e("li",[s._v("MapReduce方案")]),s._v(" "),e("li",[s._v("Hbase Coprocessor(协处理器)方案")]),s._v(" "),e("li",[s._v("Solr+hbase方案")]),s._v(" "),e("li",[s._v("ES+hbase方案")]),s._v(" "),e("li",[s._v("Phoenix+hbase方案\n"),e("ul",[e("li",[e("a",{attrs:{href:"https://kfly.top/2019/11/17/phoenix/Phoenix%E6%9E%84%E5%BB%BA%E4%BA%8C%E7%BA%A7%E7%B4%A2%E5%BC%95/",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击查看"),e("OutboundLink")],1)])])])])])]),s._v(" "),e("h2",{attrs:{id:"hbase的namespace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hbase的namespace"}},[s._v("#")]),s._v(" HBase的namespace")]),s._v(" "),e("ul",[e("li",[s._v("namespace基本介绍\n"),e("ul",[e("li",[s._v("在HBase中，namespace命名空间指对一组表的逻辑分组，类似RDBMS中的database，方便对表在业务上划分。")]),s._v(" "),e("li",[s._v("Apache HBase从0.98.0, 0.95.2两个版本号开始支持namespace级别的授权操作，HBase"),e("strong",[s._v("全局管理员")]),s._v("能够创建、改动和回收namespace的授权。")])])]),s._v(" "),e("li",[s._v("namespace的作用\n"),e("ul",[e("li",[s._v("配额管理：限制一个namespace可以使用的资源，包括region和table")]),s._v(" "),e("li",[s._v("命名空间安全管理：提供了另一个层面的多租户安全管理")]),s._v(" "),e("li",[s._v("Region服务器组：一个命名或一张表，可以被固定到一组RegionServers上，从而保证了数据隔离性")])])]),s._v(" "),e("li",[s._v("namespace的基本操作")])]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[s._v("创建namespace\nhbase"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("create_namespace "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nametest'")]),s._v("  \n\n查看namespace\nhbase"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("describe_namespace "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nametest'")]),s._v("  \n\n列出所有namespace\nhbase"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("list_namespace  \n\n在namespace下创建表\nhbase"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nametest:testtable'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fm1'")]),s._v(" \n\n查看namespace下的表\nhbase"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("list_namespace_tables "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nametest'")]),s._v("  \n\n删除namespace\nhbase"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("drop_namespace "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nametest'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h2",{attrs:{id:"数据版本的确界以及ttl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据版本的确界以及ttl"}},[s._v("#")]),s._v(" 数据版本的确界以及TTL")]),s._v(" "),e("h3",{attrs:{id:"数据的确界"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据的确界"}},[s._v("#")]),s._v(" 数据的确界")]),s._v(" "),e("ul",[e("li",[s._v("在HBase当中，我们可以为数据设置上界和下界，其实就是定义数据的历史版本保留多少个，通过自定义历史版本保存的数量，我们可以实现数据多个历史版本的数据查询")]),s._v(" "),e("li",[s._v("版本的下界\n"),e("ul",[e("li",[s._v("默认的版本下界是0，即禁用。row版本使用的最小数目是与生存时间（TTL Time To Live）相结合的，并且我们根据实际需求可以有0或更多的版本，使用0，即只有1个版本的值写入cell。")])])]),s._v(" "),e("li",[s._v("版本的上界\n"),e("ul",[e("li",[s._v("之前默认的版本上界是3，也就是一个row保留3个副本（基于时间戳的插入）。")]),s._v(" "),e("li",[s._v("该值不要设计的过大，一般的业务不会超过100。如果cell中存储的数据版本号超过了3个，再次插入数据时，最新的值会将最老的值覆盖。（现版本已默认为1）")])])])]),s._v(" "),e("h3",{attrs:{id:"数据的ttl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据的ttl"}},[s._v("#")]),s._v(" 数据的TTL")]),s._v(" "),e("ul",[e("li",[s._v("在实际工作当中经常会遇到有些数据过了一段时间我们可能就不需要了，那么这时候我们可以使用定时任务去定时的删除这些数据")]),s._v(" "),e("li",[s._v("或者我们也可以使用Hbase的TTL（Time  To  Live）功能，让我们的数据定期的会进行清除")]),s._v(" "),e("li",[s._v("使用代码来设置数据的确界以及设置数据的TTL如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n  <groupId>org.apache.hadoop</groupId>\n  <artifactId>hadoop-client</artifactId>\n  <version>2.6.0-mr1-cdh5.14.2</version>\n</dependency>\n<dependency>\n  <groupId>org.apache.hbase</groupId>\n  <artifactId>hbase-client</artifactId>\n  <version>1.2.0-cdh5.14.2</version>\n</dependency>\n<dependency>\n  <groupId>org.apache.hbase</groupId>\n  <artifactId>hbase-server</artifactId>\n  <version>1.2.0-cdh5.14.2</version>\n</dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('// columa family\nHColumnDescriptor column = new HColumnDescriptor("f1");\n// version\ncolumn.setMaxVersions(5);\ncolumn.setMinVersions(3);\n// ttl unit s\ncolumn.setTimeToLive(30);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);