(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{501:function(a,s,t){"use strict";t.r(s);var e=t(19),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h3",{attrs:{id:"_1-为什么需要工作流调度系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么需要工作流调度系统"}},[a._v("#")]),a._v(" 1. 为什么需要工作流调度系统")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("一个完整的数据分析系统通常都是由大量任务单元组成；")]),a._v(" "),t("ul",[t("li",[a._v("shell脚本程序、java程序、mapreduce程序、hive脚本等")])])]),a._v(" "),t("li",[t("p",[a._v("各任务单元之间存在时间先后及前后依赖关系")])]),a._v(" "),t("li",[t("p",[a._v("为了==很好地组织起这样的复杂执行计划，需要一个工作流调度系统来调度执行==")])])]),a._v(" "),t("h3",{attrs:{id:"_2-azkaban是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-azkaban是什么"}},[a._v("#")]),a._v(" 2. Azkaban是什么")]),a._v(" "),t("ul",[t("li",[a._v("Azkaban是由Linkedin开源的一个==批量工作流任务调度器==。用于在一个工作流内以一个特定的顺序运行一组工作和流程。")]),a._v(" "),t("li",[a._v("Azkaban定义了一种==KV文件(properties)格式==来建立任务之间的依赖关系，并提供一个易于使用的web用户界面维护和跟踪你的工作流。\n"),t("ul",[t("li",[t("a",{attrs:{href:"https://azkaban.github.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://azkaban.github.io/"),t("OutboundLink")],1)])])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/azkaban.github.png",alt:"azkaban.github"}})]),a._v(" "),t("ul",[t("li",[a._v("功能特点\n"),t("ul",[t("li",[a._v("提供功能清晰、简单易用的web UI界面")]),a._v(" "),t("li",[a._v("提供job配置文件快速建立任务和任务之间的关系")]),a._v(" "),t("li",[a._v("提供模块化的可插拔机制，原生支持command、java、hive、hadoop")]),a._v(" "),t("li",[a._v("基于java开发，代码结构清晰，易于二次开发")])])])]),a._v(" "),t("h3",{attrs:{id:"_3-azkaban基本架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-azkaban基本架构"}},[a._v("#")]),a._v(" 3. Azkaban基本架构")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/azkaban.png",alt:"azkaban"}})]),a._v(" "),t("ul",[t("li",[t("p",[a._v("Azkaban由三部分构成")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("1、==Azkaban Web Server==")]),a._v(" "),t("ul",[t("li",[a._v("提供了Web UI，是azkaban的主要管理者，包括 project 的管理，认证，调度，对工作流执行过程的监控等。")])])]),a._v(" "),t("li",[t("p",[a._v("2、==Azkaban Executor Server==")]),a._v(" "),t("ul",[t("li",[a._v("负责具体的工作流和任务的调度提交")])])]),a._v(" "),t("li",[t("p",[a._v("3、==Mysql==")]),a._v(" "),t("ul",[t("li",[a._v("用于保存项目、日志或者执行计划之类的信息")])])])])])]),a._v(" "),t("h3",{attrs:{id:"_4-azkaban架构的三种运行模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-azkaban架构的三种运行模式"}},[a._v("#")]),a._v(" 4. Azkaban架构的三种运行模式")]),a._v(" "),t("ul",[t("li",[a._v("1、solo server mode(单机模式）")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("H2\nweb server 和 executor server运行在一个进程里\n最简单的模式，数据库内置的H2数据库，管理服务器和执行服务器都在一个进程中运行，任务量不大项目可以采用此模式。\n\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("ul",[t("li",[a._v("2、two server mode")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("web server 和 executor server运行在不同的进程\n数据库为mysql，管理服务器和执行服务器在不同进程，这种模式下，管理服务器和执行服务器互不影响。\n\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("ul",[t("li",[a._v("3、multiple executor mode")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("web server 和 executor server运行在不同的进程，executor server有多个\n该模式下，执行服务器和管理服务器在不同主机上，且执行服务器可以有多个。\n\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h3",{attrs:{id:"_5-azkaban安装部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-azkaban安装部署"}},[a._v("#")]),a._v(" 5. Azkaban安装部署")]),a._v(" "),t("ul",[t("li",[a._v("见学习笔记->环境搭建->azkaban")])]),a._v(" "),t("h3",{attrs:{id:"_6-azkaban启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-azkaban启动"}},[a._v("#")]),a._v(" 6. Azkaban启动")]),a._v(" "),t("h4",{attrs:{id:"_6-1-启动web-server服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-启动web-server服务"}},[a._v("#")]),a._v(" 6.1 启动web server服务")]),a._v(" "),t("ul",[t("li",[a._v("在azkaban web server服务器目录下执行启动命令")])]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("bin/azkaban-web-start.sh\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("ul",[t("li",[a._v("ps:在web server服务器根目录运行")])]),a._v(" "),t("h4",{attrs:{id:"_6-2-启动executor执行服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-启动executor执行服务"}},[a._v("#")]),a._v(" 6.2 启动executor执行服务")]),a._v(" "),t("ul",[t("li",[a._v("在azkaban executor服务器目录下执行启动命令")])]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("bin/azkaban-executor-start.sh\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("ul",[t("li",[a._v("ps:在executor服务器根目录运行")])]),a._v(" "),t("ul",[t("li",[a._v("启动完成后,在浏览器(建议使用谷歌浏览器)中输入==https://服务器IP地址:8443== ,即可访问azkaban服务了.在登录中输入刚才新的户用名及密码,点击 login.\n"),t("ul",[t("li",[a._v("输入“IP地址:8443”无法访问 web 页面, 且后台报错，原因是浏览器安全证书限制\n"),t("ul",[t("li",[a._v("解决办法：使用“https://ip:8443”访问, 发现已经可以访问了, 后台会报证数问题的错误, 忽略即可, 不影响使用, 选择高级 ------\x3e 继续访问该网站")])])])])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/azkaban-web.png",alt:"azkaban-web"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/azkaban%E7%95%8C%E9%9D%A2.png",alt:"azkaban界面"}})]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("（1）、projects：azkaban最重要的一部分，创建一个工程，将所有的工作流放在工程中执行\n（2）、scheduling：定时调度任务用的\n（3）、executing:  显示当前运行的任务\n（4）、History : 显示历史运行任务\n\n一个project由3个按钮：\n（1）、Flows：一个工作流，由多个job组成\n（2）、Permissions:权限管理\n（3）、Project Logs：工程日志信息\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br")])]),t("h3",{attrs:{id:"_7-azkaban实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-azkaban实战"}},[a._v("#")]),a._v(" 7. Azkaban实战")]),a._v(" "),t("h4",{attrs:{id:"_7-1-command类型单一job"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-command类型单一job"}},[a._v("#")]),a._v(" 7.1 command类型单一job")]),a._v(" "),t("ul",[t("li",[a._v("1、==创建job描述文件  以.job后缀结尾==\n"),t("ul",[t("li",[a._v("创建 command.job 文件")])])])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("#command.job\ntype=command\ncommand=echo 'hello azkaban......'\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("ul",[t("li",[t("p",[a._v("2、将job资源文件打包成zip文件")])]),a._v(" "),t("li",[t("p",[a._v("例如")]),a._v(" "),t("ul",[t("li",[a._v("command.zip")])])]),a._v(" "),t("li",[t("p",[a._v("3、通过azkaban的web管理平台创建project并上传job压缩包")])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/create_project.png",alt:"create_project"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/upload_zip.png",alt:"upload_zip"}})]),a._v(" "),t("ul",[t("li",[a._v("3、点击运行")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/execute-flow.png",alt:"execute-flow"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/execute.png",alt:"execute"}})]),a._v(" "),t("ul",[t("li",[a._v("4、运行完成")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/success.png",alt:"success"}})]),a._v(" "),t("h4",{attrs:{id:"_7-2-command类型多job工作流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-command类型多job工作流"}},[a._v("#")]),a._v(" 7.2 command类型多job工作流")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("1、创建有依赖关系的多个job描述")]),a._v(" "),t("ul",[t("li",[a._v("第一个job：start1.job")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("#start1.job\ntype=command\ncommand= echo 'start1...start1...'\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("ul",[t("li",[a._v("第二个job：start2.job    它依赖start1.job")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("#start2.job\ntype=command\ndependencies=start1\ncommand= echo 'start2...start2...'\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])])]),a._v(" "),t("li",[t("p",[a._v("2、将job资源文件打包成zip文件")]),a._v(" "),t("ul",[t("li",[a._v("start12.zip")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/start12job.png",alt:"start12job"}})])]),a._v(" "),t("li",[t("p",[a._v("3、创建工程，上传zip包，最后启动工作流")])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/execute-start12.png",alt:"execute-start12"}})]),a._v(" "),t("ul",[t("li",[a._v("==补充==\n"),t("ul",[t("li",[a._v("如果一个job有多个依赖的job，可以使用逗号隔开")])])])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('例如： \n#start1.job\ntype=command\ncommand= echo "start1 job"\n\n#start2.job\ntype=command\ncommand= echo "start2 job"\n\n#stop.job\ntype=command\ndenpendencies=start1,start2\ncommand=echo "stop job"\n\n注意：有多个依赖的job，用逗号隔开\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br")])]),t("h4",{attrs:{id:"_7-3-hdfs操作任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-hdfs操作任务"}},[a._v("#")]),a._v(" 7.3 HDFS操作任务")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("1、创建job描述文件")]),a._v(" "),t("ul",[t("li",[a._v("vim fs.job")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('#fs.job\ntype=command\ncommand=echo "start execute"\ncommand.1=/kkb/install/hadoop-2.6.0-cdh5.14.2/bin/hdfs dfs -mkdir /azkaban\ncommand.2=/kkb/install/hadoop-2.6.0-cdh5.14.2/bin/hdfs dfs -put /home/hadoop/source.txt /azkaban\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])])]),a._v(" "),t("li",[t("p",[a._v("2、将job资源文件打包成zip文件")]),a._v(" "),t("ul",[t("li",[a._v("fs.zip")])])]),a._v(" "),t("li",[t("p",[a._v("3、创建工程，上传zip包，最后启动工作流")])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/fs.png",alt:"fs"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/fs-hdfs.png",alt:"fs-hdfs"}})]),a._v(" "),t("h4",{attrs:{id:"_7-4-mapreduce任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-mapreduce任务"}},[a._v("#")]),a._v(" 7.4 MAPREDUCE任务")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("MR任务依然可以使用command的job类型来执行")])]),a._v(" "),t("li",[t("p",[a._v("1、创建job描述文件，及mr程序jar包")]),a._v(" "),t("ul",[t("li",[a._v("示例中直接使用hadoop自带的example jar")]),a._v(" "),t("li",[a._v("hdfs dfs -mkdir -p  /wordcount/in")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("#mr.job\ntype=command\ncommand=/kkb/install/hadoop-2.6.0-cdh5.14.2/bin/hadoop  jar hadoop-mapreduce-examples-2.6.0-cdh5.14.2.jar wordcount /wordcount/in /wordcount/out\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])])]),a._v(" "),t("li",[t("p",[a._v("2、将job资源文件打包成zip文件")]),a._v(" "),t("ul",[t("li",[a._v("mr.zip")])])]),a._v(" "),t("li",[t("p",[a._v("3、创建工程，上传zip包，最后启动工作流")])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/mr.png",alt:"mr"}})]),a._v(" "),t("h4",{attrs:{id:"_7-5-hive脚本任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-hive脚本任务"}},[a._v("#")]),a._v(" 7.5 HIVE脚本任务")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("1、 创建job描述文件和hive脚本")]),a._v(" "),t("ul",[t("li",[a._v("Hive脚本： test.sql")])]),a._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("default")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exists")]),a._v(" test_azkaban"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("name string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("address string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("row")]),a._v(" format delimited "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fields")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("terminated")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("','")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("load")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("data")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("local")]),a._v(" inpath "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'/home/hadoop/azkaban/test.txt'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" test_azkaban"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("exists")]),a._v(" countaddress "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" address"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" num "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" test_azkaban "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("group")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v(" address "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" overwrite "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("local")]),a._v(" directory "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'/home/hadoop/azkaban/out'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" countaddress"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" \n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("ul",[t("li",[t("p",[a._v("准备数据")]),a._v(" "),t("ul",[t("li",[a._v("vim /home/hadoop/azkaban/test.txt")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1,zhangsan,shanghai\n2,lisi,beijing\n3,xiaoming,shanghai\n4,xiaozhang,shanghai\n5,xiaogang,beijing\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])])])])]),a._v(" "),t("li",[t("p",[a._v("2、创建job描述文件")]),a._v(" "),t("ul",[t("li",[a._v("hive.job")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("# hive.job\ntype=command\ncommand=/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive -f 'test.sql'\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])])]),a._v(" "),t("li",[t("p",[a._v("3、将job资源文件打包成zip文件")]),a._v(" "),t("ul",[t("li",[a._v("hive.zip")])]),a._v(" "),t("ul",[t("li",[a._v("4、创建工程，上传zip包，最后启动工作流")])])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/hive_success.png",alt:"hive_success"}})]),a._v(" "),t("h3",{attrs:{id:"_8-任务定时调度"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-任务定时调度"}},[a._v("#")]),a._v(" 8. 任务定时调度")]),a._v(" "),t("ul",[t("li",[a._v("在启动工作流的时候，可以点击==Schedule==，实现定时调度一个工作流")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/schedule1.png",alt:"schedule1"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/schedule2.png",alt:"schedule2"}})]),a._v(" "),t("h3",{attrs:{id:"_9-webui-传递参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-webui-传递参数"}},[a._v("#")]),a._v(" 9. webUI 传递参数")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("可以通过webUI动态给job传递参数")])]),a._v(" "),t("li",[t("p",[a._v("1、创建一个job的描述文件")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("parameter.job")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("#parameter.job\ntype=command\nparameter=${param}\ncommand= echo ${parameter}\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])])]),a._v(" "),t("li",[t("p",[a._v("其中")]),a._v(" "),t("ul",[t("li",[a._v("==${param}== 表示解析页面传递的参数param的值，通过声明一个变量parameter去接受")]),a._v(" "),t("li",[a._v("==${parameter}==表示获取该parameter变量的值")])])])])]),a._v(" "),t("li",[t("p",[a._v("2、将job资源文件打包成zip文件")]),a._v(" "),t("ul",[t("li",[a._v("parameter.zip")])])]),a._v(" "),t("li",[t("p",[a._v("3、创建工程，上传zip包，最后启动工作流，并且设置参数")])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1572232468448.png",alt:"1572232468448"}})]),a._v(" "),t("ul",[t("li",[t("p",[a._v("4、运行完成后的结果")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1572232525618.png",alt:"1572232525618"}})])])])])}),[],!1,null,null,null);s.default=r.exports}}]);