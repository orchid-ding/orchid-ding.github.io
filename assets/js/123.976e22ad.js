(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{608:function(t,s,a){"use strict";a.r(s);var n=a(19),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_3-6-集成学习方法之随机森林"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-集成学习方法之随机森林"}},[t._v("#")]),t._v(" 3.6 集成学习方法之随机森林")]),t._v(" "),a("h2",{attrs:{id:"学习目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学习目标"}},[t._v("#")]),t._v(" 学习目标")]),t._v(" "),a("ul",[a("li",[t._v("目标\n"),a("ul",[a("li",[t._v("说名随机森林每棵决策树的建立过程")]),t._v(" "),a("li",[t._v("知道为什么需要随机有放回(Bootstrap)的抽样")]),t._v(" "),a("li",[t._v("说明随机森林的超参数")])])])]),t._v(" "),a("ul",[a("li",[t._v("应用\n"),a("ul",[a("li",[t._v("泰坦尼克号乘客生存预测")])])]),t._v(" "),a("li",[t._v("内容预览\n"),a("ul",[a("li",[t._v("3.6.1 什么是集成学习方法")]),t._v(" "),a("li",[t._v("3.6.2 什么是随机森林")]),t._v(" "),a("li",[t._v("3.6.3 随机森林原理过程")]),t._v(" "),a("li",[t._v("3.6.4 API")]),t._v(" "),a("li",[t._v("3.6.5 随机森林预测案例")]),t._v(" "),a("li",[t._v("3.6.6 总结")])])])]),t._v(" "),a("h2",{attrs:{id:"_3-6-1-什么是集成学习方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-1-什么是集成学习方法"}},[t._v("#")]),t._v(" 3.6.1 什么是集成学习方法")]),t._v(" "),a("p",[t._v("集成学习通过建立几个模型组合的来解决单一预测问题。它的工作原理是"),a("strong",[t._v("生成多个分类器/模型")]),t._v("，各自独立地学习和作出预测。"),a("strong",[t._v("这些预测最后结合成组合预测，因此优于任何一个单分类的做出预测。")])]),t._v(" "),a("h2",{attrs:{id:"_3-6-2-什么是随机森林"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-2-什么是随机森林"}},[t._v("#")]),t._v(" 3.6.2 什么是随机森林")]),t._v(" "),a("p",[t._v("在机器学习中，"),a("strong",[t._v("随机森林是一个包含多个决策树的分类器")]),t._v("，并且其输出的类别是由个别树输出的类别的众数而定。")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/03/22/uPic/mlib/images/%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97.png",alt:"随机森林"}})]),t._v(" "),a("p",[t._v("例如, 如果你训练了5个树, 其中有4个树的结果是True, 1个数的结果是False, 那么最终投票结果就是True")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/03/22/uPic/mlib/images/%E6%8A%95%E7%A5%A8.png",alt:"投票"}})]),t._v(" "),a("h2",{attrs:{id:"_3-6-3-随机森林原理过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-3-随机森林原理过程"}},[t._v("#")]),t._v(" 3.6.3 随机森林原理过程")]),t._v(" "),a("p",[t._v("学习算法根据下列算法而建造每棵树：")]),t._v(" "),a("ul",[a("li",[t._v("用N来表示训练用例（样本）的个数，M表示特征数目。\n"),a("ul",[a("li",[t._v("1 一次随机选出一个样本，重复N次， （有可能出现重复的样本）")]),t._v(" "),a("li",[t._v("2 随机去选出m个特征, m <<M，建立决策树")])])]),t._v(" "),a("li",[t._v("采取bootstrap抽样")])]),t._v(" "),a("h3",{attrs:{id:"为什么采用bootstrap抽样"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么采用bootstrap抽样"}},[t._v("#")]),t._v(" 为什么采用BootStrap抽样")]),t._v(" "),a("ul",[a("li",[t._v("为什么要随机抽样训练集？\n"),a("ul",[a("li",[t._v("如果不进行随机抽样，每棵树的训练集都一样，那么最终训练出的树分类结果也是完全一样的")])])]),t._v(" "),a("li",[t._v("为什么要有放回地抽样？\n"),a("ul",[a("li",[t._v("如果不是有放回的抽样，那么每棵树的训练样本都是不同的，都是没有交集的，这样每棵树都是“有偏的”，都是绝对“片面的”（当然这样说可能不对），也就是说每棵树训练出来都是有很大的差异的；而随机森林最后分类取决于多棵树（弱分类器）的投票表决。")])])])]),t._v(" "),a("h2",{attrs:{id:"_3-6-4-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-4-api"}},[t._v("#")]),t._v(" 3.6.4 API")]),t._v(" "),a("ul",[a("li",[t._v("class sklearn.ensemble.RandomForestClassifier(n_estimators=10, criterion=’gini’, max_depth=None, bootstrap=True, random_state=None, min_samples_split=2)\n"),a("ul",[a("li",[t._v("随机森林分类器")]),t._v(" "),a("li",[t._v("n_estimators：integer，optional（default = 10）森林里的树木数量120,200,300,500,800,1200")]),t._v(" "),a("li",[t._v("criteria：string，可选（default =“gini”）分割特征的测量方法")]),t._v(" "),a("li",[t._v("max_depth：integer或None，可选（默认=无）树的最大深度 5,8,15,25,30")]),t._v(" "),a("li",[t._v('max_features="auto”,每个决策树的最大特征数量\n'),a("ul",[a("li",[t._v('If "auto", then '),a("code",[t._v("max_features=sqrt(n_features)")]),t._v(".")]),t._v(" "),a("li",[t._v('If "sqrt", then '),a("code",[t._v("max_features=sqrt(n_features)")]),t._v(' (same as "auto").')]),t._v(" "),a("li",[t._v('If "log2", then '),a("code",[t._v("max_features=log2(n_features)")]),t._v(".")]),t._v(" "),a("li",[t._v("If None, then "),a("code",[t._v("max_features=n_features")]),t._v(".")])])]),t._v(" "),a("li",[t._v("bootstrap：boolean，optional（default = True）是否在构建树时使用放回抽样")]),t._v(" "),a("li",[t._v("min_samples_split:节点划分最少样本数")]),t._v(" "),a("li",[t._v("min_samples_leaf:叶子节点的最小样本数")])])]),t._v(" "),a("li",[t._v("超参数：n_estimator, max_depth, min_samples_split,min_samples_leaf")])]),t._v(" "),a("h2",{attrs:{id:"_3-6-5-随机森林预测案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-5-随机森林预测案例"}},[t._v("#")]),t._v(" 3.6.5 随机森林预测案例")]),t._v(" "),a("ul",[a("li",[t._v("实例化随机森林")])]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 随机森林去进行预测")]),t._v("\nrf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" RandomForestClassifier"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[t._v("定义超参数的选择列表")])]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("param "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n_estimators"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("120")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("800")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"max_depth"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[t._v("使用GridSearchCV进行网格搜索")])]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 超参数调优")]),t._v("\ngc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GridSearchCV"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" param_grid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("param"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cv"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ngc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x_train"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y_train"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"随机森林预测的准确率为："')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" gc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("score"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x_test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y_test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("blockquote",[a("p",[t._v("注意")]),t._v(" "),a("ul",[a("li",[t._v("随机森林的建立过程")]),t._v(" "),a("li",[t._v("树的深度、树的个数等需要进行超参数调优")])])]),t._v(" "),a("h2",{attrs:{id:"_3-6-6-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-6-总结"}},[t._v("#")]),t._v(" 3.6.6 总结")]),t._v(" "),a("ul",[a("li",[t._v("在当前所有算法中，具有极好的准确率")]),t._v(" "),a("li",[t._v("能够有效地运行在大数据集上，处理具有高维特征的输入样本，而且不需要降维")]),t._v(" "),a("li",[t._v("能够评估各个特征在分类问题上的重要性")])])])}),[],!1,null,null,null);s.default=e.exports}}]);