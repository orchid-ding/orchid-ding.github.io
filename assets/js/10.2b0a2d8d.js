(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{496:function(s,a,e){"use strict";e.r(a);var n=e(19),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"_1-oozie的介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-oozie的介绍"}},[s._v("#")]),s._v(" 1. oozie的介绍")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\tOozie是运行在hadoop平台上的一种工作流调度引擎，它可以用来调度与管理hadoop任务，如，MapReduce、Pig等。那么，对于\t\tOozieWorkflow中的一个个的action（可以理解成一个个MapReduce任务）Oozie是根据什么来对action的执行时间与执行顺序进行管理调度的呢？答案就是我们在数据结构中常见的有向无环图(DAGDirect Acyclic Graph)的模式来进行管理调度的，我们可以利用HPDL语言（一种xml语言）来定义整个workflow，实现工作流的调度oozie的架构以及执行流程\n")])])]),e("h2",{attrs:{id:"_2-oozie的架构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-oozie的架构"}},[s._v("#")]),s._v(" 2. oozie的架构")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613804112187-481cb7c7-4600-4ce2-b26e-fef6e025ba90.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"_2-1-oozie的执行流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-oozie的执行流程"}},[s._v("#")]),s._v(" 2.1 oozie的执行流程")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613804112647-79169071-30e4-489d-85df-19cea217a245.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"_2-2-oozie的组件介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-oozie的组件介绍"}},[s._v("#")]),s._v(" 2.2 oozie的组件介绍")]),s._v(" "),e("ul",[e("li",[s._v("workFlow\n"),e("ul",[e("li",[s._v("工作流，定义我们的工作流的任务的执行，主要由一个个的action，在xml中进行配置即可")])])]),s._v(" "),e("li",[s._v("Coordinator\n"),e("ul",[e("li",[s._v("协作器，说白了就是oozie当中的定时任务调度的模块")])])]),s._v(" "),e("li",[s._v("Bundle\n"),e("ul",[e("li",[s._v("多个Coordinator 的抽象，可以通过bundle将多个Coordinator 进行组装集合起来，形成一个bundle")])])])]),s._v(" "),e("h2",{attrs:{id:"_3-oozie的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-oozie的使用"}},[s._v("#")]),s._v(" 3. oozie的使用")]),s._v(" "),e("h3",{attrs:{id:"_3-1-使用oozie调度shell脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-使用oozie调度shell脚本"}},[s._v("#")]),s._v(" 3.1 使用oozie调度shell脚本")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\toozie安装好了之后，我们需要测试oozie的功能是否完整好使，官方已经给我们带了各种测试案例，我们可以通过官方提供的各种案例来对我们的oozie进行调度\n")])])]),e("h4",{attrs:{id:"_3-1-1-解压官方提供的调度案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-解压官方提供的调度案例"}},[s._v("#")]),s._v(" 3.1.1 解压官方提供的调度案例")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\toozie自带了各种案例，我们可以使用oozie自带的各种案例来作为模板，所以我们这里先把官方提供的各种案例给解压出来\n")])])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\n\ntar -zxf oozie-examples.tar.gz\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-1-2-创建我们的工作目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-创建我们的工作目录"}},[s._v("#")]),s._v(" 3.1.2 创建我们的工作目录")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t在任意地方创建一个oozie的工作目录，以后我们的调度任务的配置文件全部放到oozie的工作目录当中去\n")])])]),e("p",[s._v("我这里直接在oozie的安装目录下面创建工作目录")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\n\nmkdir oozie_works\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-1-3-拷贝任务模板到工作目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-拷贝任务模板到工作目录"}},[s._v("#")]),s._v(" 3.1.3 拷贝任务模板到工作目录")]),s._v(" "),e("p",[s._v("我们的任务模板以及工作目录都准备好了之后，我们把我们的shell的任务模板拷贝到我们oozie的工作目录当中去")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\n\ncp -r examples/apps/shell/ oozie_works/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-1-4-准备一个shell脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-4-准备一个shell脚本"}},[s._v("#")]),s._v(" 3.1.4 准备一个shell脚本")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('cd /kfly/install/oozie-4.1.0-cdh5.14.2\nvim oozie_works/shell/hello.sh\n# 注意：这个脚本一定要是在我们oozie工作路径下的shell路径下的位置\n\n#!/bin/bash\necho "hello world" >> /kfly/install/hello_oozie.txt\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"_3-1-5-job-properties"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-5-job-properties"}},[s._v("#")]),s._v(" 3.1.5 job.properties")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/shell\n\nvim job.properties\n\nnameNode=hdfs://node01:8020\njobTracker=node01:8032\nqueueName=default\nexamplesRoot=oozie_works\noozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/shell\nEXEC=hello.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_3-1-6-workflow-xml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-6-workflow-xml"}},[s._v("#")]),s._v(" 3.1.6 workflow.xml")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("vim workflow.xml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<workflow-app xmlns="uri:oozie:workflow:0.4" name="shell-wf">\n<start to="shell-node"/>\n<action name="shell-node">\n    <shell xmlns="uri:oozie:shell-action:0.2">\n        <job-tracker>${jobTracker}</job-tracker>\n        <name-node>${nameNode}</name-node>\n        <configuration>\n            <property>\n                <name>mapred.job.queue.name</name>\n                <value>${queueName}</value>\n            </property>\n        </configuration>\n        <exec>${EXEC}</exec>\n        \x3c!-- <argument>my_output=Hello Oozie</argument> --\x3e\n        <file>/user/hadoop/oozie_works/shell/${EXEC}#${EXEC}</file>\n\n        <capture-output/>\n    </shell>\n    <ok to="end"/>\n    <error to="fail"/>\n</action>\n<decision name="check-output">\n    <switch>\n        <case to="end">\n            ${wf:actionData(\'shell-node\')[\'my_output\'] eq \'Hello Oozie\'}\n        </case>\n        <default to="fail-output"/>\n    </switch>\n</decision>\n<kill name="fail">\n    <message>Shell action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>\n</kill>\n<kill name="fail-output">\n    <message>Incorrect output, expected [Hello Oozie] but was [${wf:actionData(\'shell-node\')[\'my_output\']}]</message>\n</kill>\n<end name="end"/>\n</workflow-app>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br")])]),e("h4",{attrs:{id:"_3-1-7-调度任务到hdfs上面去"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-7-调度任务到hdfs上面去"}},[s._v("#")]),s._v(" 3.1.7 调度任务到hdfs上面去")]),s._v(" "),e("p",[s._v("注意：上传的hdfs目录为/user/root，因为我们hadoop启动的时候使用的是root用户，如果hadoop启动的是其他用户，那么就上传到\n/user/其他用户")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\nhdfs dfs -put oozie_works/ /user/hadoop\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_3-1-8-执行调度任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-8-执行调度任务"}},[s._v("#")]),s._v(" 3.1.8 执行调度任务")]),s._v(" "),e("p",[s._v("通过oozie的命令来执行我们的调度任务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\nbin/oozie job -oozie http://node03:11000/oozie -config oozie_works/shell/job.properties  -run\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("从监控界面可以看到我们的任务执行成功了\n![](https://cdn.nlark.com/yuque/0/2021/png/434900/1613804113941-860e5912-99cc-46ca-b206-727cdf640751.png#align=left&display=inline&height=66&margin=[object Object]&originHeight=260&originWidth=1640&status=done&style=none&width=415)")]),s._v(" "),e("p",[s._v("查看hadoop的19888端口，我们会发现，oozie启动了一个MR的任务去执行我们的shell脚本\n"),e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613804114379-c4407ce5-86ee-469a-881d-522a81ec1cad.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"_3-2-oozie调度hive"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-oozie调度hive"}},[s._v("#")]),s._v(" 3.2 oozie调度hive")]),s._v(" "),e("h4",{attrs:{id:"_3-2-1-拷贝hive的案例模板"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-拷贝hive的案例模板"}},[s._v("#")]),s._v(" 3.2.1 拷贝hive的案例模板")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\ncp -ra examples/apps/hive2/ oozie_works/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_3-2-2-编辑hive模板"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-编辑hive模板"}},[s._v("#")]),s._v(" 3.2.2 编辑hive模板")]),s._v(" "),e("p",[s._v("这里使用的是hiveserver2来进行提交任务，需要注意我们要将hiveserver2的服务给启动起来")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/hive2\nvim job.properties\n\nnameNode=hdfs://node01:8020\njobTracker=node01:8032\nqueueName=default\njdbcURL=jdbc:hive2://node03:10000/default\nexamplesRoot=oozie_works\n\noozie.use.system.libpath=true\n\n# 配置我们文件上传到hdfs的保存路径 实际上就是在hdfs 的/user/root/oozie_works/hive2这个路径下\n\noozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/hive2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h4",{attrs:{id:"_3-2-3-workflow-xml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-workflow-xml"}},[s._v("#")]),s._v(" 3.2.3 workflow.xml")]),s._v(" "),e("p",[s._v("vim workflow.xml")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<?xml version="1.0" encoding="UTF-8"?>\n<workflow-app xmlns="uri:oozie:workflow:0.5" name="hive2-wf">\n    <start to="hive2-node"/>\n\n    <action name="hive2-node">\n        <hive2 xmlns="uri:oozie:hive2-action:0.1">\n            <job-tracker>${jobTracker}</job-tracker>\n            <name-node>${nameNode}</name-node>\n            <prepare>\n                <delete path="${nameNode}/user/${wf:user()}/${examplesRoot}/output-data/hive2"/>\n                <mkdir path="${nameNode}/user/${wf:user()}/${examplesRoot}/output-data"/>\n            </prepare>\n            <configuration>\n                <property>\n                    <name>mapred.job.queue.name</name>\n                    <value>${queueName}</value>\n                </property>\n            </configuration>\n            <jdbc-url>${jdbcURL}</jdbc-url>\n\n            <script>script.q<\/script>\n\n            <param>INPUT=/user/${wf:user()}/${examplesRoot}/input-data/table</param>\n            <param>OUTPUT=/user/${wf:user()}/${examplesRoot}/output-data/hive2</param>\n        </hive2>\n        <ok to="end"/>\n        <error to="fail"/>\n    </action>\n\n    <kill name="fail">\n        <message>Hive2 (Beeline) action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>\n    </kill>\n    <end name="end"/>\n</workflow-app>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("h4",{attrs:{id:"_3-2-4-编辑script-q文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-编辑script-q文件"}},[s._v("#")]),s._v(" 3.2.4 编辑script.q文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("vim script.q\n\nDROP TABLE IF EXISTS test;\n\nCREATE EXTERNAL TABLE test (a INT) STORED AS TEXTFILE LOCATION '${INPUT}';\ninsert into test values(10);\ninsert into test values(20);\ninsert into test values(30);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_3-2-5-工作文件上传到hdfs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-5-工作文件上传到hdfs"}},[s._v("#")]),s._v(" 3.2.5 工作文件上传到hdfs")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works\nhdfs dfs -put hive2/ /user/hadoop/oozie_works/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_3-2-6-执行oozie的调度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-6-执行oozie的调度"}},[s._v("#")]),s._v(" 3.2.6 执行oozie的调度")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\nbin/oozie job -oozie http://node03:11000/oozie -config oozie_works/hive2/job.properties  -run\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_3-2-7-查看调度结果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-7-查看调度结果"}},[s._v("#")]),s._v(" 3.2.7 查看调度结果")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613804114712-f8cbca21-978c-45e1-b925-c972e23c34ff.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"_3-3-oozie调度mr任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-oozie调度mr任务"}},[s._v("#")]),s._v(" 3.3 oozie调度MR任务")]),s._v(" "),e("h4",{attrs:{id:"_3-3-1-准备mr执行的数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-准备mr执行的数据"}},[s._v("#")]),s._v(" 3.3.1 准备MR执行的数据")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t我们这里通过oozie调度一个MR的程序的执行，MR的程序可以是自己写的，也可以是hadoop工程自带的，我们这里就选用hadoop工程自带的MR程序来运行wordcount的示例\n")])])]),e("p",[s._v("准备以下数据上传到HDFS的/oozie/input路径下去")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("hdfs dfs -mkdir -p /oozie/input\n\nvim wordcount.txt\n\nhello   world   hadoop\nspark   hive    hadoop\n将我们的数据上传到hdfs对应目录\n\nhdfs dfs -put wordcount.txt /oozie/input\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_3-3-2-执行官方测试案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-执行官方测试案例"}},[s._v("#")]),s._v(" 3.3.2 执行官方测试案例")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yarn jar /kfly/install/hadoop-2.6.2-cdh5.14.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.6.0-cdh5.14.2.jar wordcount /oozie/input/ /oozie/output\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_3-3-3-准备我们调度的资源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-准备我们调度的资源"}},[s._v("#")]),s._v(" 3.3.3 准备我们调度的资源")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t将我们需要调度的资源都准备好放到一个文件夹下面去，包括我们的jar包，我们的job.properties，以及我们的workflow.xml。\n")])])]),e("p",[s._v("拷贝MR的任务模板。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\n\ncp -ra examples/apps/map-reduce/ oozie_works/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t删掉MR任务模板lib目录下自带的jar包\n")])])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce/lib\n\nrm -rf oozie-examples-4.1.0-cdh5.14.2.jar\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-2-4-拷贝我们自己的jar包到对应目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-拷贝我们自己的jar包到对应目录"}},[s._v("#")]),s._v(" 3.2.4 拷贝我们自己的jar包到对应目录")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t从上一步的删除当中，我们可以看到我们需要调度的jar包存放在了\n")])])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 这个目录下，所以我们把我们需要调度的jar包也放到这个路径下即可\n/kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce/lib \n\ncp /kfly/install/hadoop-2.6.2-cdh5.14.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.6.0-cdh5.14.2.jar /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce/lib/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_3-2-5-修改配置文件job-properties"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-5-修改配置文件job-properties"}},[s._v("#")]),s._v(" 3.2.5 修改配置文件job.properties")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\ncd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce\nvim job.properties\nnameNode=hdfs://node01:8020\njobTracker=node01:8032\nqueueName=default\nexamplesRoot=oozie_works\n\noozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/map-reduce/workflow.xml\noutputDir=/oozie/output\ninputdir=/oozie/input\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("ul",[e("li",[s._v("workflow.xml")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/map-reduce\n\nvim workflow.xml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n  Licensed to the Apache Software Foundation (ASF) under one\n  or more contributor license agreements.  See the NOTICE file\n  distributed with this work for additional information\n  regarding copyright ownership.  The ASF licenses this file\n  to you under the Apache License, Version 2.0 (the\n  "License"); you may not use this file except in compliance\n  with the License.  You may obtain a copy of the License at\n\n       [http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0)\n\n  Unless required by applicable law or agreed to in writing, software\n  distributed under the License is distributed on an "AS IS" BASIS,\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  See the License for the specific language governing permissions and\n  limitations under the License.\n--\x3e\n<workflow-app xmlns="uri:oozie:workflow:0.5" name="map-reduce-wf">\n    <start to="mr-node"/>\n    <action name="mr-node">\n        <map-reduce>\n            <job-tracker>${jobTracker}</job-tracker>\n            <name-node>${nameNode}</name-node>\n            <prepare>\n                <delete path="${nameNode}/${outputDir}"/>\n            </prepare>\n            <configuration>\n                <property>\n                    <name>mapred.job.queue.name</name>\n                    <value>${queueName}</value>\n                </property>\n              \x3c!-- \n                <property>\n                    <name>mapred.mapper.class</name>\n                    <value>org.apache.oozie.example.SampleMapper</value>\n                </property>\n                <property>\n                    <name>mapred.reducer.class</name>\n                    <value>org.apache.oozie.example.SampleReducer</value>\n                </property>\n                <property>\n                    <name>mapred.map.tasks</name>\n                    <value>1</value>\n                </property>\n                <property>\n                    <name>mapred.input.dir</name>\n                    <value>/user/${wf:user()}/${examplesRoot}/input-data/text</value>\n                </property>\n                <property>\n                    <name>mapred.output.dir</name>\n                    <value>/user/${wf:user()}/${examplesRoot}/output-data/${outputDir}</value>\n                </property>\n              --\x3e\n             \n                 \x3c!-- 开启使用新的API来进行配置 --\x3e\n                <property>\n                    <name>mapred.mapper.new-api</name>\n                    <value>true</value>\n                </property>\n\n                <property>\n                    <name>mapred.reducer.new-api</name>\n                    <value>true</value>\n                </property>\n\n                \x3c!-- 指定MR的输出key的类型 --\x3e\n                <property>\n                    <name>mapreduce.job.output.key.class</name>\n                    <value>org.apache.hadoop.io.Text</value>\n                </property>\n\n                \x3c!-- 指定MR的输出的value的类型--\x3e\n                <property>\n                    <name>mapreduce.job.output.value.class</name>\n                    <value>org.apache.hadoop.io.IntWritable</value>\n                </property>\n\n                \x3c!-- 指定输入路径 --\x3e\n                <property>\n                    <name>mapred.input.dir</name>\n                    <value>${nameNode}/${inputdir}</value>\n                </property>\n\n                \x3c!-- 指定输出路径 --\x3e\n                <property>\n                    <name>mapred.output.dir</name>\n                    <value>${nameNode}/${outputDir}</value>\n                </property>\n\n                \x3c!-- 指定执行的map类 --\x3e\n                <property>\n                    <name>mapreduce.job.map.class</name>\n                    <value>org.apache.hadoop.examples.WordCount$TokenizerMapper</value>\n                </property>\n\n                \x3c!-- 指定执行的reduce类 --\x3e\n                <property>\n                    <name>mapreduce.job.reduce.class</name>\n                    <value>org.apache.hadoop.examples.WordCount$IntSumReducer</value>\n                </property>\n              \x3c!--  配置map task的个数 --\x3e\n                <property>\n                    <name>mapred.map.tasks</name>\n                    <value>1</value>\n                </property>\n\n            </configuration>\n        </map-reduce>\n        <ok to="end"/>\n        <error to="fail"/>\n    </action>\n    <kill name="fail">\n        <message>Map/Reduce failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>\n    </kill>\n    <end name="end"/>\n</workflow-app>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br")])]),e("h4",{attrs:{id:"_3-2-6-上传调度任务到hdfs对应目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-6-上传调度任务到hdfs对应目录"}},[s._v("#")]),s._v(" 3.2.6 上传调度任务到hdfs对应目录")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works\n\nhdfs dfs -put map-reduce/ /user/hadoop/oozie_works/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-2-7-执行调度任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-7-执行调度任务"}},[s._v("#")]),s._v(" 3.2.7 执行调度任务")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t执行我们的调度任务，然后通过oozie的11000端口进行查看任务结果\n")])])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\n\nbin/oozie job -oozie http://node03:11000/oozie -config oozie_works/map-reduce/job.properties -run\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_3-4、oozie的任务串联"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4、oozie的任务串联"}},[s._v("#")]),s._v(" 3.4、oozie的任务串联")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t在实际工作当中，肯定会存在多个任务需要执行，并且存在上一个任务的输出结果作为下一个任务的输入数据这样的情况，所以我们需要在workflow.xml配置文件当中配置多个action，实现多个任务之间的相互依赖关系\n")])])]),e("p",[s._v("需求：首先执行一个shell脚本，执行完了之后再执行一个MR的程序，最后再执行一个hive的程序")]),s._v(" "),e("h4",{attrs:{id:"_3-4-1-准备我们的工作目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-1-准备我们的工作目录"}},[s._v("#")]),s._v(" 3.4.1 准备我们的工作目录")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works\n\nmkdir -p sereval-actions\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-4-2-准备我们的调度文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-2-准备我们的调度文件"}},[s._v("#")]),s._v(" 3.4.2 准备我们的调度文件")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t将我们之前的hive，shell，以及MR的执行，进行串联成到一个workflow当中去，准备我们的资源文件\n")])])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works\ncp hive2/script.q sereval-actions/\ncp shell/hello.sh sereval-actions/\ncp -ra map-reduce/lib sereval-actions/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_3-4-3-开发调度的配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-3-开发调度的配置文件"}},[s._v("#")]),s._v(" 3.4.3 开发调度的配置文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/sereval-actions\n\n# 创建配置文件workflow.xml并编辑\nvim workflow.xml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<workflow-app xmlns="uri:oozie:workflow:0.4" name="shell-wf">\n<start to="shell-node"/>\n<action name="shell-node">\n    <shell xmlns="uri:oozie:shell-action:0.2">\n        <job-tracker>${jobTracker}</job-tracker>\n        <name-node>${nameNode}</name-node>\n        <configuration>\n            <property>\n                <name>mapred.job.queue.name</name>\n                <value>${queueName}</value>\n            </property>\n        </configuration>\n        <exec>${EXEC}</exec>\n        \x3c!-- <argument>my_output=Hello Oozie</argument> --\x3e\n        <file>/user/hadoop/oozie_works/sereval-actions/${EXEC}#${EXEC}</file>\n\n        <capture-output/>\n    </shell>\n    <ok to="mr-node"/>\n    <error to="mr-node"/>\n</action>\n\n \n\n\n<action name="mr-node">\n        <map-reduce>\n            <job-tracker>${jobTracker}</job-tracker>\n            <name-node>${nameNode}</name-node>\n            <prepare>\n                <delete path="${nameNode}/${outputDir}"/>\n            </prepare>\n            <configuration>\n                <property>\n                    <name>mapred.job.queue.name</name>\n                    <value>${queueName}</value>\n                </property>\n              \x3c!-- \n                <property>\n                    <name>mapred.mapper.class</name>\n                    <value>org.apache.oozie.example.SampleMapper</value>\n                </property>\n                <property>\n                    <name>mapred.reducer.class</name>\n                    <value>org.apache.oozie.example.SampleReducer</value>\n                </property>\n                <property>\n                    <name>mapred.map.tasks</name>\n                    <value>1</value>\n                </property>\n                <property>\n                    <name>mapred.input.dir</name>\n                    <value>/user/${wf:user()}/${examplesRoot}/input-data/text</value>\n                </property>\n                <property>\n                    <name>mapred.output.dir</name>\n                    <value>/user/${wf:user()}/${examplesRoot}/output-data/${outputDir}</value>\n                </property>\n              --\x3e\n             \n                 \x3c!-- 开启使用新的API来进行配置 --\x3e\n                <property>\n                    <name>mapred.mapper.new-api</name>\n                    <value>true</value>\n                </property>\n\n                <property>\n                    <name>mapred.reducer.new-api</name>\n                    <value>true</value>\n                </property>\n\n                \x3c!-- 指定MR的输出key的类型 --\x3e\n                <property>\n                    <name>mapreduce.job.output.key.class</name>\n                    <value>org.apache.hadoop.io.Text</value>\n                </property>\n\n                \x3c!-- 指定MR的输出的value的类型--\x3e\n                <property>\n                    <name>mapreduce.job.output.value.class</name>\n                    <value>org.apache.hadoop.io.IntWritable</value>\n                </property>\n\n                \x3c!-- 指定输入路径 --\x3e\n                <property>\n                    <name>mapred.input.dir</name>\n                    <value>${nameNode}/${inputdir}</value>\n                </property>\n\n                \x3c!-- 指定输出路径 --\x3e\n                <property>\n                    <name>mapred.output.dir</name>\n                    <value>${nameNode}/${outputDir}</value>\n                </property>\n\n                \x3c!-- 指定执行的map类 --\x3e\n                <property>\n                    <name>mapreduce.job.map.class</name>\n                    <value>org.apache.hadoop.examples.WordCount$TokenizerMapper</value>\n                </property>\n\n                \x3c!-- 指定执行的reduce类 --\x3e\n                <property>\n                    <name>mapreduce.job.reduce.class</name>\n                    <value>org.apache.hadoop.examples.WordCount$IntSumReducer</value>\n                </property>\n              \x3c!--  配置map task的个数 --\x3e\n                <property>\n                    <name>mapred.map.tasks</name>\n                    <value>1</value>\n                </property>\n\n            </configuration>\n        </map-reduce>\n        <ok to="hive2-node"/>\n        <error to="fail"/>\n    </action>\n\n <action name="hive2-node">\n        <hive2 xmlns="uri:oozie:hive2-action:0.1">\n            <job-tracker>${jobTracker}</job-tracker>\n            <name-node>${nameNode}</name-node>\n            <prepare>\n                <delete path="${nameNode}/user/${wf:user()}/${examplesRoot}/output-data/hive2"/>\n                <mkdir path="${nameNode}/user/${wf:user()}/${examplesRoot}/output-data"/>\n            </prepare>\n            <configuration>\n                <property>\n                    <name>mapred.job.queue.name</name>\n                    <value>${queueName}</value>\n                </property>\n            </configuration>\n            <jdbc-url>${jdbcURL}</jdbc-url>\n\n            <script>script.q<\/script>\n\n            <param>INPUT=/user/${wf:user()}/${examplesRoot}/input-data/table</param>\n            <param>OUTPUT=/user/${wf:user()}/${examplesRoot}/output-data/hive2</param>\n        </hive2>\n        <ok to="end"/>\n        <error to="fail"/>\n    </action>\n<decision name="check-output">\n    <switch>\n        <case to="end">\n            ${wf:actionData(\'shell-node\')[\'my_output\'] eq \'Hello Oozie\'}\n        </case>\n        <default to="fail-output"/>\n    </switch>\n</decision>\n<kill name="fail">\n    <message>Shell action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>\n</kill>\n<kill name="fail-output">\n    <message>Incorrect output, expected [Hello Oozie] but was [${wf:actionData(\'shell-node\')[\'my_output\']}]</message>\n</kill>\n<end name="end"/>\n</workflow-app>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br"),e("span",{staticClass:"line-number"},[s._v("156")]),e("br"),e("span",{staticClass:"line-number"},[s._v("157")]),e("br"),e("span",{staticClass:"line-number"},[s._v("158")]),e("br")])]),e("h4",{attrs:{id:"_3-4-4-job-properties配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-4-job-properties配置文件"}},[s._v("#")]),s._v(" 3.4.4 job.properties配置文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/sereval-actions\nvim  job.properties\nnameNode=hdfs://node01:8020\njobTracker=node01:8032\nqueueName=default\nexamplesRoot=oozie_works\nEXEC=hello.sh\noutputDir=/oozie/output\ninputdir=/oozie/input\njdbcURL=jdbc:hive2://node03:10000/default\noozie.use.system.libpath=true\n\n# 配置我们文件上传到hdfs的保存路径 实际上就是在hdfs 的/user/root/oozie_works/sereval-actions这个路径下\noozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/sereval-actions/workflow.xml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h4",{attrs:{id:"_3-4-5-上传资源文件夹到hdfs对应路径"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-5-上传资源文件夹到hdfs对应路径"}},[s._v("#")]),s._v(" 3.4.5 上传资源文件夹到hdfs对应路径")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/\n\nhdfs dfs -put sereval-actions/ /user/hadoop/oozie_works/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-4-6-执行调度任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-6-执行调度任务"}},[s._v("#")]),s._v(" 3.4.6 执行调度任务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/\n\nbin/oozie job -oozie http://node03:11000/oozie -config oozie_works/serveral-actions/job.properties -run\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_3-5、oozie的任务调度-定时任务执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5、oozie的任务调度-定时任务执行"}},[s._v("#")]),s._v(" 3.5、oozie的任务调度,定时任务执行")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t在oozie当中，主要是通过Coordinator 来实现任务的定时调度，与我们的workflow类似的，Coordinator 这个模块也是主要通过xml来进行配置即可，接下来我们就来看看如何配置Coordinator 来实现任务的定时调度\n")])])]),e("ul",[e("li",[s._v("Coordinator 的调度主要可以有两种实现方式\n"),e("ul",[e("li",[s._v("第一种：基于时间的定时任务调度，\noozie基于时间的调度主要需要指定三个参数，第一个起始时间，第二个结束时间，第三个调度频率")]),s._v(" "),e("li",[s._v("第二种：基于数据的任务调度，只有在有了数据才会去出发执行\n这种是基于数据的调度，只要在有了数据才会触发调度任务")])])])]),s._v(" "),e("h4",{attrs:{id:"_3-5-1-拷贝定时任务的调度模板"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-1-拷贝定时任务的调度模板"}},[s._v("#")]),s._v(" 3.5.1 拷贝定时任务的调度模板")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\ncp -r examples/apps/cron oozie_works/cron-job\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_3-5-2-第二步-拷贝我们的hello-sh脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-2-第二步-拷贝我们的hello-sh脚本"}},[s._v("#")]),s._v(" 3.5.2 第二步：拷贝我们的hello.sh脚本")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works\ncp shell/hello.sh  cron-job/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_3-5-3-第三步-修改配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-3-第三步-修改配置文件"}},[s._v("#")]),s._v(" 3.5.3 第三步：修改配置文件")]),s._v(" "),e("ul",[e("li",[s._v("job.properties")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works/cron-job\nvim job.properties\n\nnameNode=hdfs://node01:8020\njobTracker=node01:8032\nqueueName=default\nexamplesRoot=oozie_works\n\noozie.coord.application.path=${nameNode}/user/${user.name}/${examplesRoot}/cron-job/coordinator.xml\nstart=2018-08-22T19:20+0800\nend=2019-08-22T19:20+0800\nEXEC=hello.sh\nworkflowAppUri=${nameNode}/user/${user.name}/${examplesRoot}/cron-job/workflow.xml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("ul",[e("li",[s._v("coordinator.xml")])]),s._v(" "),e("div",{staticClass:"language-\\ line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\n\x3c!--\n    oozie的frequency 可以支持很多表达式，其中可以通过定时每分，或者每小时，或者每天，或者每月进行执行，也支持可以通过与linux的crontab表达式类似的写法来进行定时任务的执行\n    例如frequency 也可以写成以下方式\n    frequency="10 9 * * *"  每天上午的09:10:00开始执行任务\n    frequency="0 1 * * *"  每天凌晨的01:00开始执行任务\n --\x3e\n<coordinator-app name="cron-job" frequency="${coord:minutes(1)}" start="${start}" end="${end}" timezone="GMT+0800"\n                 xmlns="uri:oozie:coordinator:0.4">\n        <action>\n        <workflow>\n            <app-path>${workflowAppUri}</app-path>\n            <configuration>\n                <property>\n                    <name>jobTracker</name>\n                    <value>${jobTracker}</value>\n                </property>\n                <property>\n                    <name>nameNode</name>\n                    <value>${nameNode}</value>\n                </property>\n                <property>\n                    <name>queueName</name>\n                    <value>${queueName}</value>\n                </property>\n            </configuration>\n        </workflow>\n    </action>\n</coordinator-app>\n\n修改workflow.xml\nvim workflow.xml\n<workflow-app xmlns="uri:oozie:workflow:0.5" name="one-op-wf">\n    <start to="action1"/>\n    <action name="action1">\n    <shell xmlns="uri:oozie:shell-action:0.2">\n        <job-tracker>${jobTracker}</job-tracker>\n        <name-node>${nameNode}</name-node>\n        <configuration>\n            <property>\n                <name>mapred.job.queue.name</name>\n                <value>${queueName}</value>\n            </property>\n        </configuration>\n        <exec>${EXEC}</exec>\n        \x3c!-- <argument>my_output=Hello Oozie</argument> --\x3e\n        <file>/user/hadoop/oozie_works/cron-job/${EXEC}#${EXEC}</file>\n\n        <capture-output/>\n    </shell>\n    <ok to="end"/>\n    <error to="end"/>\n</action>\n    <end name="end"/>\n</workflow-app>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br")])]),e("h4",{attrs:{id:"_3-5-4-上传到hdfs对应路径"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-4-上传到hdfs对应路径"}},[s._v("#")]),s._v(" 3.5.4 上传到hdfs对应路径")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2/oozie_works\nhdfs dfs -put cron-job/ /user/hadoop/oozie_works/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_3-5-5-运行定时任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-5-运行定时任务"}},[s._v("#")]),s._v(" 3.5.5 运行定时任务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\n\nbin/oozie job -oozie http://node03:11000/oozie -config oozie_works/cron-job/job.properties -run\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_3-5-6-oozie当中任务的查看以及杀死"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-6-oozie当中任务的查看以及杀死"}},[s._v("#")]),s._v(" 3.5.6 oozie当中任务的查看以及杀死")]),s._v(" "),e("ul",[e("li",[s._v("查看所有普通任务")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("oozie  jobs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("查看定时任务")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("oozie jobs -jobtype coordinator\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613804115012-926d518d-9bd4-444f-9144-05696eb3dd4a.png",alt:""}})]),s._v(" "),e("ul",[e("li",[s._v("杀死某个任务")])]),s._v(" "),e("p",[s._v("oozie可以通过jobid来杀死某个定时任务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("oozie job -kill [id]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("例如我们可以使用命令")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("oozie job -kill 0000085-180628150519513-oozie-root-C\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("来杀死我们定时任务\n"),e("img",{attrs:{src:"https://gitee.com/kflys/uPic/raw/master/uPic/1613804115348-57e8e57e-cb6b-4be3-9919-d34556bfe377.png",alt:""}})]),s._v(" "),e("h2",{attrs:{id:"_4-hue整合oozie"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-hue整合oozie"}},[s._v("#")]),s._v(" 4. hue整合oozie")]),s._v(" "),e("h3",{attrs:{id:"_4-1-停止oozie与hue的进程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-停止oozie与hue的进程"}},[s._v("#")]),s._v(" 4.1 停止oozie与hue的进程")]),s._v(" "),e("p",[s._v("通过命令停止oozie与hue的进程，准备修改oozie与hue的配置文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("bin/oozied.sh stop\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_4-2-修改oozie的配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-修改oozie的配置文件"}},[s._v("#")]),s._v(" 4.2 修改oozie的配置文件")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("（老版本的bug，新版本已经不需要了）这一步我们都不需要做了\n")])])]),e("p",[s._v("修改oozie的配置文件oozie-site.xml")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<property>   \n\t<name>oozie.service.WorkflowAppService.system.libpath</name>\n\t<value>/user/oozie/share/lib</value>\n</property>\n<property>\n\t<name>oozie.use.system.libpath</name>\n\t<value>true</value>\n</property>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t重新上传所有的jar包到hdfs的/user/oozie/share/lib路径下去\n")])])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\nbin/oozie-setup.sh  sharelib create -fs hdfs://node01:8020 -locallib oozie-sharelib-4.1.0-cdh5.14.2-yarn.tar.gz\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"_4-3-修改hue的配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-修改hue的配置文件"}},[s._v("#")]),s._v(" 4.3 修改hue的配置文件")]),s._v(" "),e("p",[s._v("修改hue的配置文件hue.ini")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[liboozie]\n  remote_deployement_dir=/user/hadoop/oozie_works\n\n# 修改oozie的配置文件大概在1151行左右的样子\n[oozie]\n  oozie_jobs_count=100\n\n  enable_cron_scheduling=true\n\n  enable_document_action=true\n\n  enable_oozie_backend_filtering=true\n\n  enable_impala_action=true\n\n[filebrowser]\n  archive_upload_tempdir=/tmp\n\n  show_download_button=true\n\n  show_upload_button=true\n\n  enable_extract_uploaded_archive=true\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("h3",{attrs:{id:"_4-4-启动hue与oozie的进程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-启动hue与oozie的进程"}},[s._v("#")]),s._v(" 4.4 启动hue与oozie的进程")]),s._v(" "),e("ul",[e("li",[s._v("启动hue进程")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/hue-3.9.0-cdh5.14.2\nbuild/env/bin/supervisor\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("启动oozie进程")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /kfly/install/oozie-4.1.0-cdh5.14.2\nbin/oozied.sh start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("页面访问hue")]),s._v(" "),e("p",[e("a",{attrs:{href:"http://node03.hadoop.com:8888/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://node03.hadoop.com:8888/"),e("OutboundLink")],1)])])]),s._v(" "),e("h2",{attrs:{id:"_5-oozie使用过程当中可能遇到的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-oozie使用过程当中可能遇到的问题"}},[s._v("#")]),s._v(" 5. oozie使用过程当中可能遇到的问题")]),s._v(" "),e("h3",{attrs:{id:"_5-1-mysql权限配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-mysql权限配置"}},[s._v("#")]),s._v(" 5.1 Mysql权限配置")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("\t授权所有主机可以使用root用户操作所有数据库和数据表\n")])])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" grant all on *.* to root@'%' identified by '123456' with grant option;\n \n flush privileges;\n  \n exit; \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("workflow.xml配置的时候不要忽略file属性\n\njps查看进程时，注意有没有bootstrap\n\n关闭oozie\n \t\t如果bin/oozied.sh stop无法关闭，则可以使用kill -9 [pid]，之后oozie根目录下的oozie-server/temp/xxx.pid文件一定要删除。\n\nOozie重新打包时，一定要注意先关闭进程，删除对应文件夹下面的pid文件。（可以参考第4条目）\n\n配置文件一定要生效\n  \t起始标签和结束标签无对应则不生效，配置文件的属性写错了，那么则执行默认的属性。\n\nlibext下边的jar存放于某个文件夹中，导致share/lib创建不成功。\n\n修改Hadoop配置文件，需要重启集群。一定要记得scp到其他节点\n\nJobHistoryServer必须开启，集群要重启的。\n\nMysql配置如果没有生效的话，默认使用derby数据库。\n\n在本地修改完成的job配置，必须重新上传到HDFS。\n\n将HDFS中上传的oozie配置文件下载下来查看是否有错误。\n\nLinux用户名和Hadoop的用户名不一致。\n\nsharelib找不到，包括重新初始化oozie\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("h3",{attrs:{id:"_5-2-部署oozie出错"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-部署oozie出错"}},[s._v("#")]),s._v(" 5.2 部署oozie出错")]),s._v(" "),e("ul",[e("li",[s._v("修复执行，初始化oozie，需要执行以下操作。\n"),e("ul",[e("li",[s._v("停止oozie（要通过jps检查bootstrap进程是否已经不存在）")]),s._v(" "),e("li",[s._v("删除oozie-server/temp/")]),s._v(" "),e("li",[s._v("删除HDFS上的sharelib文件夹")]),s._v(" "),e("li",[s._v("删除oozie.sql文件，删除Mysql中删除oozie库，重新创建")]),s._v(" "),e("li",[s._v("重新按照顺序执行文档中oozie的安装重新再来一遍")])])])])])}),[],!1,null,null,null);a.default=r.exports}}]);