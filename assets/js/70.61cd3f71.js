(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{554:function(s,a,e){"use strict";e.r(a);var t=e(19),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("hr"),s._v(" "),e("h2",{attrs:{id:"hbase集成mapreduce"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hbase集成mapreduce"}},[s._v("#")]),s._v(" HBase集成MapReduce")]),s._v(" "),e("ul",[e("li",[s._v("HBase表中的数据最终都是存储在HDFS上，HBase天生的支持MR的操作，我们可以通过MR直接处理HBase表中的数据，并且MR可以将处理后的结果直接存储到HBase表中。\n"),e("ul",[e("li",[s._v("参考地址：<"),e("a",{attrs:{href:"http://hbase.apache.org/book.html#mapreduce",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://hbase.apache.org/book.html#mapreduce"),e("OutboundLink")],1)])])]),s._v(" "),e("li",[s._v("需求：读取HBase当中myuser这张表的数据，将数据写入到另外一张myuser2表里面去")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" <dependency>\n   <groupId>org.apache.hadoop</groupId>\n   <artifactId>hadoop-client</artifactId>\n   <version>2.6.0-mr1-cdh5.14.2</version>\n</dependency>\n<dependency>\n  <groupId>org.apache.hbase</groupId>\n  <artifactId>hbase-client</artifactId>\n  <version>1.2.0-cdh5.14.2</version>\n</dependency>\n<dependency>\n  <groupId>org.apache.hbase</groupId>\n  <artifactId>hbase-server</artifactId>\n  <version>1.2.0-cdh5.14.2</version>\n</dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class HBaseMapper extends TableMapper<Text,Put>{\n  protected void map(ImmutableBytesWritable key, Result value, Context context){\n    // key get rowKey\n    // result -> put\n    context.write(new Text(rowkey),put);\n  }\n}\nclass HbaseReducer extends TableReducer<Text,Put,ImmutableBytesWritable>{\n  protected void reduce(Text key, Iterable<Put> values, Context context){\n    for (Put put : values) {\n      context.write(null,put);\n    }\n  }\n}\npublic static void main(String[] args){\n        Configuration conf = new Configuration();\n        Scan scan = new Scan();\n        Job job = Job.getInstance(conf);\n        job.setJarByClass(HBaseMR.class);\n        //使用TableMapReduceUtil 工具类来初始化我们的mapper\n      TableMapReduceUtil.initTableMapperJob(\n                                            TableName.valueOf(args[0]),\n                                            scan,\n                                            HBaseMapper.class,\n                                            Text.class,\n                                            Put.class,\n                                            job\n      \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n        //使用TableMapReduceUtil 工具类来初始化我们的reducer\n        TableMapReduceUtil.initTableReducerJob(\n          \t\t\t\t\t\t\t\t\t\t\t\t\t\t\targs[1],\n          \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tHbaseReducer.class,\n          \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjob);\n        //设置reduce task个数\n        job.setNumReduceTasks(1);\n        System.exit(job.waitForCompletion(true) ? 0 : 1);\n    }\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打成jar包提交到集群中运行")]),s._v("\nhadoop jar hbase_java_api-1.0-SNAPSHOT.jar com.kfly.HBaseMR t1 t2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("需求\n"),e("ul",[e("li",[s._v("通过bulkload的方式批量加载数据到HBase表中")]),s._v(" "),e("li",[s._v("将我们hdfs上面的这个路径/hbase/input/user.txt的数据文件，转换成HFile格式，然后load到myuser2这张表里面去")])])]),s._v(" "),e("li",[s._v("知识点描述\n"),e("ul",[e("li",[s._v("加载数据到HBase当中去的方式多种多样，我们可以使用HBase的javaAPI或者使用sqoop将我们的数据写入或者导入到HBase当中去，但是这些方式不是慢就是在导入的过程的占用Region资源导致效率低下")]),s._v(" "),e("li",[s._v("我们也可以通过MR的程序，将我们的数据直接转换成HBase的最终存储格式HFile，然后直接load数据到HBase当中去即可")])])]),s._v(" "),e("li",[s._v("HBase数据正常写流程回顾\n"),e("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/04/01/uPic/hbase/assets/hbase-write.png#height=404&id=zSDVJ&originHeight=404&originWidth=1007&originalType=binary&ratio=1&status=done&style=none&width=1007",alt:""}})]),s._v(" "),e("li",[s._v("bulkload方式的处理示意图")])]),s._v(" "),e("p",[e("img",{attrs:{src:"http://kflys.gitee.io/upic/2020/04/01/uPic/hbase/assets/bulkload.png#height=671&id=Zxcrg&originHeight=671&originWidth=1627&originalType=binary&ratio=1&status=done&style=none&width=1627",alt:""}})]),s._v(" "),e("ul",[e("li",[s._v("好处\n"),e("ul",[e("li",[s._v("导入过程不占用Region资源")]),s._v(" "),e("li",[s._v("能快速导入海量的数据")]),s._v(" "),e("li",[s._v("节省内存")])])]),s._v(" "),e("li",[s._v("1、开发生成HFile文件的代码")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('// 1. map阶段\ncontext.write(new ImmutableBytesWritable(Bytes.toBytes(split[0])),put);\n\n// 2. main job\nConfiguration conf = HBaseConfiguration.create();\nConnection connection = ConnectionFactory.createConnection(conf);\njob.setMapOutputKeyClass(ImmutableBytesWritable.class);\njob.setMapOutputValueClass(Put.class);\n//指定输出的类型HFileOutputFormat2\njob.setOutputFormatClass(HFileOutputFormat2.class);\nHFileOutputFormat2\n  .configureIncrementalLoad(\n                            job,\n                            table,                                       \t\t   \t \n                            conn.getRegionLocator(TableName.valueOf("t4"))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n// 3. 加载数据使用java Api\nTable table = connection.getTable(tableName);\n//构建LoadIncrementalHFiles加载HFile文件\nLoadIncrementalHFiles load = new LoadIncrementalHFiles(configuration);\nload.doBulkLoad(new Path("hdfs://node01:8020/hbase/output_file");\n                \n// 加载数据命令加载,先将hbase的jar包添加到hadoop的classpath路径下\nexport HBASE_HOME=/kfly/install/hbase-1.2.0-cdh5.14.2/\nexport HADOOP_HOME=/kfly/install/hadoop-2.6.0/\nexport HADOOP_CLASSPATH=`${HBASE_HOME}/bin/hbase mapredcp`\n                \nyarn jar /kfly/install/hbase-1.2.0-cdh5.14.2/lib/hbase-server-1.2.0-cdh5.14.2.jar   completebulkload /hbase/output_hfile myuser2\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("hadoop jar hbase_java_api-1.0-SNAPSHOT.jar com.kaikeba.HBaseLoad\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"hbase集成hive"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hbase集成hive"}},[s._v("#")]),s._v(" HBase集成Hive")]),s._v(" "),e("ul",[e("li",[s._v("Hive提供了与HBase的集成，使得能够在HBase表上使用hive sql 语句进行查询、插入操作以及进行Join和Union等复杂查询，同时也可以将hive表中的数据映射到Hbase中")])]),s._v(" "),e("h3",{attrs:{id:"对比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#对比"}},[s._v("#")]),s._v(" 对比")]),s._v(" "),e("ul",[e("li",[s._v("Hive\n"),e("ul",[e("li",[s._v("数据仓库\n"),e("ul",[e("li",[e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("Hive的本质其实就相当于将HDFS中已经存储的文件在Mysql中做了一个双射关系，以方便使用HQL去管理查询。\n")])])])])])]),s._v(" "),e("li",[s._v("用于数据分析、清洗\n"),e("ul",[e("li",[e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("Hive适用于离线的数据分析和清洗，延迟较高\n")])])])])])]),s._v(" "),e("li",[s._v("基于HDFS、MapReduce\n"),e("ul",[e("li",[e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("Hive存储的数据依旧在DataNode上，编写的HQL语句终将是转换为MapReduce代码执行。（不要钻不需要执行MapReduce代码的情况的牛角尖）\n")])])])])])])])]),s._v(" "),e("li",[s._v("HBase\n"),e("ul",[e("li",[s._v("数据库\n"),e("ul",[e("li",[s._v("是一种面向列存储的非关系型数据库。")])])]),s._v(" "),e("li",[s._v("用于存储结构化和非结构话的数据\n"),e("ul",[e("li",[s._v("适用于单表非关系型数据的存储，不适合做关联查询，类似JOIN等操作。")])])]),s._v(" "),e("li",[s._v("基于HDFS\n"),e("ul",[e("li",[s._v("数据持久化存储的体现形式是Hfile，存放于DataNode中，被ResionServer以region的形式进行管理。")])])]),s._v(" "),e("li",[s._v("延迟较低，接入在线业务使用\n"),e("ul",[e("li",[s._v("面对大量的企业数据，HBase可以直线单表大量数据的存储，同时提供了高效的数据访问速度。")])])])])]),s._v(" "),e("li",[s._v("Hive和Hbase是两种基于Hadoop的不同技术，Hive是一种类SQL的引擎，并且运行MapReduce任务，Hbase是一种在Hadoop之上的NoSQL 的Key/vale数据库。这两种工具是可以同时使用的。就像用Google来搜索，用FaceBook进行社交一样，Hive可以用来进行统计查询，HBase可以用来进行实时查询，数据也可以从Hive写到HBase，或者从HBase写回Hive。")])]),s._v(" "),e("h4",{attrs:{id:"拷贝jar包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#拷贝jar包"}},[s._v("#")]),s._v(" 拷贝jar包")]),s._v(" "),e("ul",[e("li",[s._v("将我们HBase的五个jar包拷贝到hive的lib目录下")]),s._v(" "),e("li",[s._v("hbase的jar包都在/kfly/install/hbase-1.2.0-cdh5.14.2/lib")]),s._v(" "),e("li",[s._v("我们需要拷贝五个jar包名字如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("hbase-client-1.2.0-cdh5.14.2.jar                  \nhbase-hadoop2-compat-1.2.0-cdh5.14.2.jar \nhbase-hadoop-compat-1.2.0-cdh5.14.2.jar  \nhbase-it-1.2.0-cdh5.14.2.jar    \nhbase-server-1.2.0-cdh5.14.2.jar\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[s._v("我们直接在node03执行以下命令，通过创建软连接的方式来进行jar包的依赖")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /kfly/install/hbase-1.2.0-cdh5.14.2/lib/hbase-client-1.2.0-cdh5.14.2.jar              /kfly/install/hive-1.1.0-cdh5.14.2/lib/hbase-client-1.2.0-cdh5.14.2.jar\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"修改hive-site-xml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改hive-site-xml"}},[s._v("#")]),s._v(" 修改hive-site.xml")]),s._v(" "),e("ul",[e("li",[s._v("添加以下两个属性的配置")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<property>\n\t\t<name>hive.zookeeper.quorum</name>\n\t\t<value>node01,node02,node03</value>\n</property>\n <property>\n\t\t<name>hbase.zookeeper.quorum</name>\n\t\t<value>node01,node02,node03</value>\n</property>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"修改hive-env-sh"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改hive-env-sh"}},[s._v("#")]),s._v(" 修改hive-env.sh")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("export HADOOP_HOME=/export/servers/hadoop-2.6.0\nexport HBASE_HOME=/export/servers/hbase-1.2.0-cdh5.14.2\nexport HIVE_CONF_DIR=/export/servers/hive-1.1.0-cdh5.14.2/conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"hive建表同步到hbase"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hive建表同步到hbase"}},[s._v("#")]),s._v(" hive建表同步到hbase")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('-- hive当中建表\ncreate external table if not exists course.score(id int,cname string,score int) row format delimited fields terminated by \'\\t\' stored as textfile ;\n-- 加载数据到hive\nload data local inpath \'/kfly/doc/hive-hbase.txt\' into table score;\n-- 创建hive管理表与HBase映射\ncreate table course.hbase_score(id int,cname string,score int) stored by \'org.apache.hadoop.hive.hbase.HBaseStorageHandler\'  with serdeproperties("hbase.columns.mapping" = "cf:name,cf:score") tblproperties("hbase.table.name" = "hbase_score");\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"hive外部表映射hbase表模型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hive外部表映射hbase表模型"}},[s._v("#")]),s._v(" hive外部表映射HBase表模型")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建一张hbase表")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hbase_hive_score'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("{ NAME "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cf'")]),s._v("}\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 建立hive的外部表，映射HBase当中的表以及字段")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" external "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" course"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hbase2hive"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" score "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" STORED "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'org.apache.hadoop.hive.hbase.HBaseStorageHandler'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" SERDEPROPERTIES "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hbase.columns.mapping"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('":key,cf:name,cf:score"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" TBLPROPERTIES"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hbase.table.name"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hbase_hive_score"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);